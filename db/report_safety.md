# Rapport de sécurité des migrations

## Motifs interdits
OK, aucun motif destructif détecté dans db/00_admin_preflight.sql, db/00_admin_only.sql et db/01_app_safe.sql.

## Objets créés ou altérés
### Fonctions
- public.current_user_mama_id
- public.current_user_is_admin_or_manager
- public.current_user_is_admin
- public.create_utilisateur
- public.can_access_zone
- public.log_action

### Tables
- public.achats
- public.alertes
- public.alertes_rupture
- public.api_keys
- public.auth_double_facteur
- public.bons_livraison
- public.catalogue_updates
- public.centres_de_cout
- public.commande_lignes
- public.commandes
- public.compta_mapping
- public.consentements_utilisateur
- public.documentation
- public.documents
- public.emails_envoyes
- public.etapes_onboarding
- public.facture_lignes
- public.factures
- public.familles
- public.feedback
- public.fiche_cout_history
- public.fiche_lignes
- public.fiches
- public.fiches_techniques
- public.fournisseur_contacts
- public.fournisseur_notes
- public.fournisseur_produits
- public.fournisseurs
- public.fournisseurs_api_config
- public.gadgets
- public.groupes
- public.guides_seen
- public.help_articles
- public.inventaire_zones
- public.inventaires
- public.journaux_utilisateur
- public.lignes_bl
- public.lignes_transfert
- public.logs_activite
- public.logs_securite
- public.mamas
- public.menu_fiches
- public.menu_groupe_lignes
- public.menu_groupe_modele_lignes
- public.menu_groupe_modeles
- public.menu_groupes
- public.menus
- public.menus_groupes
- public.menus_groupes_fiches
- public.menus_jour
- public.menus_jour_fiches
- public.menus_jour_lignes
- public.notification_preferences
- public.notifications
- public.parametres_commandes
- public.periodes_comptables
- public.permissions
- public.pertes
- public.planning_lignes
- public.planning_previsionnel
- public.produits
- public.produits_inventaire
- public.produits_zones
- public.promotions
- public.rapports_generes
- public.regles_alertes
- public.requisition_lignes
- public.requisitions
- public.roles
- public.settings
- public.signalements
- public.sous_familles
- public.stocks
- public.tableaux_de_bord
- public.taches
- public.templates_commandes
- public.tooltips
- public.transferts
- public.unites
- public.usage_stats
- public.user_mama_access
- public.utilisateurs
- public.utilisateurs_taches
- public.validation_requests
- public.ventes_boissons
- public.ventes_fiches
- public.ventes_fiches_carte
- public.ventes_import_staging
- public.zones_droits
- public.zones_stock

### Policies
- db/00_admin_only.sql:user_mama_access_select
- db/00_admin_only.sql:zones_stock_select
- db/01_app_safe.sql:achats_all
- db/01_app_safe.sql:alertes_all
- db/01_app_safe.sql:alertes_rupture_all
- db/01_app_safe.sql:api_keys_all
- db/01_app_safe.sql:auth_double_facteur_all
- db/01_app_safe.sql:bons_livraison_all
- db/01_app_safe.sql:catalogue_updates_all
- db/01_app_safe.sql:centres_de_cout_all
- db/01_app_safe.sql:commande_lignes_all
- db/01_app_safe.sql:commandes_all
- db/01_app_safe.sql:compta_mapping_all
- db/01_app_safe.sql:consentements_utilisateur_all
- db/01_app_safe.sql:documentation_all
- db/01_app_safe.sql:documents_all
- db/01_app_safe.sql:emails_envoyes_all
- db/01_app_safe.sql:etapes_onboarding_all
- db/01_app_safe.sql:facture_lignes_all
- db/01_app_safe.sql:factures_all
- db/01_app_safe.sql:familles_all
- db/01_app_safe.sql:feedback_all
- db/01_app_safe.sql:fiche_cout_history_all
- db/01_app_safe.sql:fiche_lignes_all
- db/01_app_safe.sql:fiches_all
- db/01_app_safe.sql:fiches_techniques_all
- db/01_app_safe.sql:fournisseur_contacts_all
- db/01_app_safe.sql:fournisseur_notes_all
- db/01_app_safe.sql:fournisseur_produits_all
- db/01_app_safe.sql:fournisseurs_all
- db/01_app_safe.sql:fournisseurs_api_config_all
- db/01_app_safe.sql:gadgets_all
- db/01_app_safe.sql:groupes_all
- db/01_app_safe.sql:guides_seen_all
- db/01_app_safe.sql:help_articles_all
- db/01_app_safe.sql:inventaire_insert
- db/01_app_safe.sql:inventaire_zones_all
- db/01_app_safe.sql:inventaires_delete
- db/01_app_safe.sql:inventaires_select
- db/01_app_safe.sql:inventaires_update
- db/01_app_safe.sql:journaux_utilisateur_all
- db/01_app_safe.sql:lignes_bl_all
- db/01_app_safe.sql:lignes_transfert_all
- db/01_app_safe.sql:logs_activite_all
- db/01_app_safe.sql:logs_securite_all
- db/01_app_safe.sql:mamas_all
- db/01_app_safe.sql:menu_fiches_all
- db/01_app_safe.sql:menu_groupe_lignes_all
- db/01_app_safe.sql:menu_groupe_modele_lignes_all
- db/01_app_safe.sql:menu_groupe_modeles_all
- db/01_app_safe.sql:menu_groupes_all
- db/01_app_safe.sql:menus_all
- db/01_app_safe.sql:menus_groupes_all
- db/01_app_safe.sql:menus_groupes_fiches_all
- db/01_app_safe.sql:menus_jour_all
- db/01_app_safe.sql:menus_jour_fiches_all
- db/01_app_safe.sql:menus_jour_lignes_all
- db/01_app_safe.sql:notification_preferences_all
- db/01_app_safe.sql:notifications_all
- db/01_app_safe.sql:parametres_commandes_all
- db/01_app_safe.sql:periodes_comptables_rls
- db/01_app_safe.sql:permissions_insert_mama
- db/01_app_safe.sql:permissions_self_mama
- db/01_app_safe.sql:permissions_update_mama
- db/01_app_safe.sql:pertes_all
- db/01_app_safe.sql:planning_lignes_all
- db/01_app_safe.sql:planning_previsionnel_all
- db/01_app_safe.sql:produits_all
- db/01_app_safe.sql:produits_inventaire_rls
- db/01_app_safe.sql:promotions_all
- db/01_app_safe.sql:rapports_generes_all
- db/01_app_safe.sql:regles_alertes_all
- db/01_app_safe.sql:requisition_lignes_delete
- db/01_app_safe.sql:requisition_lignes_insert
- db/01_app_safe.sql:requisition_lignes_select
- db/01_app_safe.sql:requisition_lignes_update
- db/01_app_safe.sql:requisitions_delete
- db/01_app_safe.sql:requisitions_insert
- db/01_app_safe.sql:requisitions_select
- db/01_app_safe.sql:requisitions_update
- db/01_app_safe.sql:roles_insert_mama
- db/01_app_safe.sql:roles_self_mama
- db/01_app_safe.sql:roles_update_mama
- db/01_app_safe.sql:settings_all
- db/01_app_safe.sql:signalements_all
- db/01_app_safe.sql:sous_familles_all
- db/01_app_safe.sql:stocks_all
- db/01_app_safe.sql:tableaux_de_bord_all
- db/01_app_safe.sql:taches_all
- db/01_app_safe.sql:templates_commandes_crud_admin
- db/01_app_safe.sql:templates_commandes_select
- db/01_app_safe.sql:tooltips_all
- db/01_app_safe.sql:transferts_all
- db/01_app_safe.sql:unites_all
- db/01_app_safe.sql:usage_stats_all
- db/01_app_safe.sql:user_mama_access_modify
- db/01_app_safe.sql:utilisateurs_insert_mama
- db/01_app_safe.sql:utilisateurs_self_mama
- db/01_app_safe.sql:utilisateurs_taches_all
- db/01_app_safe.sql:utilisateurs_update_mama
- db/01_app_safe.sql:validation_requests_all
- db/01_app_safe.sql:ventes_boissons_all
- db/01_app_safe.sql:ventes_fiches_all
- db/01_app_safe.sql:ventes_fiches_carte_all
- db/01_app_safe.sql:ventes_import_staging_all
- db/01_app_safe.sql:zones_droits_admin_all
- db/01_app_safe.sql:zones_stock_admin_iud

## Diffs schéma (avant/après)
À générer en comparant l'exécution de 00_snapshot_before.sql et 99_snapshot_after.sql après les migrations.

## Comptes de lignes (avant/après)
À obtenir en exécutant les scripts de snapshot avant et après les migrations.
