SELECT
    table_name,
    column_name,
    data_type,
    is_nullable,
    column_default
FROM
    information_schema.columns
WHERE
    table_schema = 'public'
ORDER BY
    table_name, ordinal_position;


| table_name                               | column_name               | data_type                | is_nullable | column_default       |
| ---------------------------------------- | ------------------------- | ------------------------ | ----------- | -------------------- |
| access_rights                            | id                        | uuid                     | NO          | gen_random_uuid()    |
| access_rights                            | mama_id                   | uuid                     | NO          | null                 |
| access_rights                            | role_id                   | uuid                     | NO          | null                 |
| access_rights                            | module                    | text                     | NO          | null                 |
| access_rights                            | peut_voir                 | boolean                  | NO          | false                |
| access_rights                            | peut_modifier             | boolean                  | NO          | false                |
| access_rights                            | created_at                | timestamp with time zone | YES         | now()                |
| achats                                   | id                        | uuid                     | NO          | gen_random_uuid()    |
| achats                                   | mama_id                   | uuid                     | YES         | null                 |
| achats                                   | produit_id                | uuid                     | YES         | null                 |
| achats                                   | fournisseur_id            | uuid                     | YES         | null                 |
| achats                                   | prix                      | numeric                  | YES         | null                 |
| achats                                   | quantite                  | numeric                  | YES         | null                 |
| achats                                   | date_achat                | date                     | YES         | null                 |
| achats                                   | created_at                | timestamp with time zone | YES         | now()                |
| achats                                   | updated_at                | timestamp with time zone | YES         | now()                |
| achats                                   | actif                     | boolean                  | YES         | true                 |
| api_keys                                 | id                        | uuid                     | NO          | gen_random_uuid()    |
| api_keys                                 | mama_id                   | uuid                     | YES         | null                 |
| api_keys                                 | user_id                   | uuid                     | YES         | null                 |
| api_keys                                 | name                      | text                     | YES         | null                 |
| api_keys                                 | scopes                    | jsonb                    | YES         | null                 |
| api_keys                                 | role                      | text                     | YES         | null                 |
| api_keys                                 | expiration                | date                     | YES         | null                 |
| api_keys                                 | revoked                   | boolean                  | YES         | false                |
| api_keys                                 | created_at                | timestamp with time zone | YES         | now()                |
| auth_double_facteur                      | id                        | uuid                     | NO          | null                 |
| auth_double_facteur                      | secret                    | text                     | YES         | null                 |
| auth_double_facteur                      | enabled                   | boolean                  | YES         | false                |
| auth_double_facteur                      | created_at                | timestamp with time zone | YES         | now()                |
| bons_livraison                           | id                        | uuid                     | NO          | gen_random_uuid()    |
| bons_livraison                           | mama_id                   | uuid                     | YES         | null                 |
| bons_livraison                           | fournisseur_id            | uuid                     | YES         | null                 |
| bons_livraison                           | numero_bl                 | text                     | YES         | null                 |
| bons_livraison                           | date_livraison            | date                     | YES         | null                 |
| bons_livraison                           | created_at                | timestamp with time zone | YES         | now()                |
| bons_livraison                           | date_reception            | date                     | YES         | null                 |
| bons_livraison                           | commentaire               | text                     | YES         | null                 |
| bons_livraison                           | statut                    | text                     | YES         | 'recu'::text         |
| bons_livraison                           | actif                     | boolean                  | YES         | true                 |
| bons_livraison                           | updated_at                | timestamp with time zone | YES         | now()                |
| bons_livraison                           | commande_id               | uuid                     | YES         | null                 |
| bons_livraison                           | facture_id                | uuid                     | YES         | null                 |
| catalogue_updates                        | id                        | uuid                     | NO          | gen_random_uuid()    |
| catalogue_updates                        | mama_id                   | uuid                     | YES         | null                 |
| catalogue_updates                        | fournisseur_id            | uuid                     | YES         | null                 |
| catalogue_updates                        | produit_id                | uuid                     | YES         | null                 |
| catalogue_updates                        | ancienne_valeur           | numeric                  | YES         | null                 |
| catalogue_updates                        | nouvelle_valeur           | numeric                  | YES         | null                 |
| catalogue_updates                        | modification              | jsonb                    | YES         | null                 |
| catalogue_updates                        | created_at                | timestamp with time zone | YES         | now()                |
| centres_de_cout                          | id                        | uuid                     | NO          | gen_random_uuid()    |
| centres_de_cout                          | mama_id                   | uuid                     | NO          | null                 |
| centres_de_cout                          | nom                       | text                     | NO          | null                 |
| centres_de_cout                          | created_at                | timestamp with time zone | YES         | now()                |
| centres_de_cout                          | updated_at                | timestamp with time zone | YES         | now()                |
| centres_de_cout                          | actif                     | boolean                  | YES         | true                 |
| centres_de_cout                          | activite                  | text                     | YES         | null                 |
| commande_lignes                          | id                        | uuid                     | NO          | gen_random_uuid()    |
| commande_lignes                          | mama_id                   | uuid                     | NO          | null                 |
| commande_lignes                          | commande_id               | uuid                     | NO          | null                 |
| commande_lignes                          | produit_id                | uuid                     | NO          | null                 |
| commande_lignes                          | quantite                  | numeric                  | YES         | null                 |
| commande_lignes                          | unite                     | text                     | YES         | null                 |
| commande_lignes                          | prix_unitaire             | numeric                  | YES         | null                 |
| commande_lignes                          | tva                       | numeric                  | YES         | null                 |
| commande_lignes                          | total                     | numeric                  | YES         | null                 |
| commande_lignes                          | commentaire               | text                     | YES         | null                 |
| commande_lignes                          | part_livree               | numeric                  | YES         | null                 |
| commande_lignes                          | rupture                   | boolean                  | YES         | null                 |
| commande_lignes                          | actif                     | boolean                  | YES         | true                 |
| commande_lignes                          | created_at                | timestamp with time zone | YES         | now()                |
| commande_lignes                          | updated_at                | timestamp with time zone | YES         | now()                |
| commandes                                | id                        | uuid                     | NO          | gen_random_uuid()    |
| commandes                                | mama_id                   | uuid                     | YES         | null                 |
| commandes                                | fournisseur_id            | uuid                     | YES         | null                 |
| commandes                                | statut                    | text                     | YES         | null                 |
| commandes                                | created_at                | timestamp with time zone | YES         | now()                |
| commandes                                | date_commande             | date                     | YES         | null                 |
| commandes                                | date_livraison_prevue     | date                     | YES         | null                 |
| commandes                                | montant_total             | numeric                  | YES         | null                 |
| commandes                                | commentaire               | text                     | YES         | null                 |
| commandes                                | updated_at                | timestamp with time zone | YES         | now()                |
| commandes                                | actif                     | boolean                  | YES         | true                 |
| commandes                                | bl_id                     | uuid                     | YES         | null                 |
| commandes                                | facture_id                | uuid                     | YES         | null                 |
| compta_mapping                           | id                        | uuid                     | NO          | gen_random_uuid()    |
| compta_mapping                           | mama_id                   | uuid                     | YES         | null                 |
| compta_mapping                           | cle                       | text                     | YES         | null                 |
| compta_mapping                           | compte                    | text                     | YES         | null                 |
| compta_mapping                           | type                      | text                     | YES         | null                 |
| compta_mapping                           | created_at                | timestamp with time zone | YES         | now()                |
| consentements_utilisateur                | id                        | uuid                     | NO          | gen_random_uuid()    |
| consentements_utilisateur                | user_id                   | uuid                     | YES         | null                 |
| consentements_utilisateur                | mama_id                   | uuid                     | YES         | null                 |
| consentements_utilisateur                | consentement              | boolean                  | YES         | null                 |
| consentements_utilisateur                | date_consentement         | timestamp with time zone | YES         | null                 |
| consentements_utilisateur                | actif                     | boolean                  | YES         | true                 |
| consentements_utilisateur                | created_at                | timestamp with time zone | YES         | now()                |
| consentements_utilisateur                | utilisateur_id            | uuid                     | YES         | null                 |
| consentements_utilisateur                | type_consentement         | text                     | YES         | null                 |
| documentation                            | id                        | uuid                     | NO          | gen_random_uuid()    |
| documentation                            | mama_id                   | uuid                     | YES         | null                 |
| documentation                            | titre                     | text                     | YES         | null                 |
| documentation                            | contenu                   | text                     | YES         | null                 |
| documentation                            | categorie                 | text                     | YES         | null                 |
| documentation                            | created_at                | timestamp with time zone | YES         | now()                |
| documents                                | id                        | uuid                     | NO          | gen_random_uuid()    |
| documents                                | mama_id                   | uuid                     | YES         | null                 |
| documents                                | chemin                    | text                     | YES         | null                 |
| documents                                | type                      | text                     | YES         | null                 |
| documents                                | created_at                | timestamp with time zone | YES         | now()                |
| etapes_onboarding                        | id                        | uuid                     | NO          | gen_random_uuid()    |
| etapes_onboarding                        | mama_id                   | uuid                     | YES         | null                 |
| etapes_onboarding                        | etape                     | text                     | YES         | null                 |
| etapes_onboarding                        | terminee                  | boolean                  | YES         | false                |
| etapes_onboarding                        | created_at                | timestamp with time zone | YES         | now()                |
| facture_lignes                           | id                        | uuid                     | NO          | gen_random_uuid()    |
| facture_lignes                           | mama_id                   | uuid                     | NO          | null                 |
| facture_lignes                           | facture_id                | uuid                     | NO          | null                 |
| facture_lignes                           | produit_id                | uuid                     | NO          | null                 |
| facture_lignes                           | quantite                  | numeric                  | YES         | null                 |
| facture_lignes                           | prix                      | numeric                  | YES         | null                 |
| facture_lignes                           | created_at                | timestamp with time zone | YES         | now()                |
| facture_lignes                           | updated_at                | timestamp with time zone | YES         | now()                |
| facture_lignes                           | actif                     | boolean                  | YES         | true                 |
| facture_lignes                           | prix_unitaire             | numeric                  | YES         | null                 |
| facture_lignes                           | tva                       | numeric                  | YES         | null                 |
| facture_lignes                           | total                     | numeric                  | YES         | null                 |
| factures                                 | id                        | uuid                     | NO          | gen_random_uuid()    |
| factures                                 | mama_id                   | uuid                     | NO          | null                 |
| factures                                 | fournisseur_id            | uuid                     | YES         | null                 |
| factures                                 | numero                    | text                     | YES         | null                 |
| factures                                 | date_facture              | date                     | YES         | null                 |
| factures                                 | created_at                | timestamp with time zone | YES         | now()                |
| factures                                 | updated_at                | timestamp with time zone | YES         | now()                |
| factures                                 | actif                     | boolean                  | YES         | true                 |
| factures                                 | total_ht                  | numeric                  | YES         | null                 |
| factures                                 | total_tva                 | numeric                  | YES         | null                 |
| factures                                 | total_ttc                 | numeric                  | YES         | null                 |
| factures                                 | statut                    | text                     | YES         | null                 |
| factures                                 | montant_total             | numeric                  | YES         | null                 |
| familles                                 | id                        | uuid                     | NO          | uuid_generate_v4()   |
| familles                                 | nom                       | text                     | NO          | null                 |
| familles                                 | mama_id                   | uuid                     | NO          | null                 |
| familles                                 | actif                     | boolean                  | YES         | true                 |
| familles                                 | created_at                | timestamp with time zone | YES         | now()                |
| familles                                 | parent_id                 | uuid                     | YES         | null                 |
| familles                                 | populaire                 | boolean                  | YES         | false                |
| familles                                 | updated_at                | timestamp with time zone | YES         | now()                |
| feedback                                 | id                        | uuid                     | NO          | gen_random_uuid()    |
| feedback                                 | mama_id                   | uuid                     | YES         | null                 |
| feedback                                 | user_id                   | uuid                     | YES         | null                 |
| feedback                                 | module                    | text                     | YES         | null                 |
| feedback                                 | message                   | text                     | YES         | null                 |
| feedback                                 | urgence                   | text                     | YES         | null                 |
| feedback                                 | created_at                | timestamp with time zone | YES         | now()                |
| fiche_cout_history                       | id                        | uuid                     | NO          | gen_random_uuid()    |
| fiche_cout_history                       | mama_id                   | uuid                     | NO          | null                 |
| fiche_cout_history                       | fiche_id                  | uuid                     | NO          | null                 |
| fiche_cout_history                       | old_cout                  | numeric                  | YES         | null                 |
| fiche_cout_history                       | new_cout                  | numeric                  | YES         | null                 |
| fiche_cout_history                       | changed_by                | uuid                     | YES         | null                 |
| fiche_cout_history                       | changed_at                | timestamp with time zone | YES         | null                 |
| fiche_cout_history                       | created_at                | timestamp with time zone | YES         | now()                |
| fiche_cout_history                       | updated_at                | timestamp with time zone | YES         | now()                |
| fiche_cout_history                       | actif                     | boolean                  | YES         | true                 |
| fiche_lignes                             | id                        | uuid                     | NO          | gen_random_uuid()    |
| fiche_lignes                             | mama_id                   | uuid                     | NO          | null                 |
| fiche_lignes                             | fiche_id                  | uuid                     | NO          | null                 |
| fiche_lignes                             | description               | text                     | YES         | null                 |
| fiche_lignes                             | quantite                  | numeric                  | YES         | null                 |
| fiche_lignes                             | created_at                | timestamp with time zone | YES         | now()                |
| fiche_lignes                             | updated_at                | timestamp with time zone | YES         | now()                |
| fiche_lignes                             | actif                     | boolean                  | YES         | true                 |
| fiche_lignes                             | produit_id                | uuid                     | YES         | null                 |
| fiche_lignes                             | sous_fiche_id             | uuid                     | YES         | null                 |
| fiche_prix_history                       | id                        | uuid                     | NO          | gen_random_uuid()    |
| fiche_prix_history                       | mama_id                   | uuid                     | NO          | null                 |
| fiche_prix_history                       | fiche_id                  | uuid                     | NO          | null                 |
| fiche_prix_history                       | old_prix                  | numeric                  | YES         | null                 |
| fiche_prix_history                       | new_prix                  | numeric                  | YES         | null                 |
| fiche_prix_history                       | changed_by                | uuid                     | YES         | null                 |
| fiche_prix_history                       | changed_at                | timestamp with time zone | YES         | null                 |
| fiche_prix_history                       | created_at                | timestamp with time zone | YES         | now()                |
| fiche_prix_history                       | updated_at                | timestamp with time zone | YES         | now()                |
| fiche_prix_history                       | actif                     | boolean                  | YES         | true                 |
| fiches                                   | id                        | uuid                     | NO          | gen_random_uuid()    |
| fiches                                   | mama_id                   | uuid                     | NO          | null                 |
| fiches                                   | titre                     | text                     | NO          | null                 |
| fiches                                   | created_at                | timestamp with time zone | YES         | now()                |
| fiches                                   | updated_at                | timestamp with time zone | YES         | now()                |
| fiches                                   | actif                     | boolean                  | YES         | true                 |
| fiches                                   | portions                  | numeric                  | YES         | 1                    |
| fiches_techniques                        | id                        | uuid                     | NO          | gen_random_uuid()    |
| fiches_techniques                        | mama_id                   | uuid                     | NO          | null                 |
| fiches_techniques                        | fiche_id                  | uuid                     | NO          | null                 |
| fiches_techniques                        | technique                 | text                     | YES         | null                 |
| fiches_techniques                        | created_at                | timestamp with time zone | YES         | now()                |
| fiches_techniques                        | updated_at                | timestamp with time zone | YES         | now()                |
| fiches_techniques                        | actif                     | boolean                  | YES         | true                 |
| fiches_techniques                        | nom                       | text                     | YES         | null                 |
| fiches_techniques                        | cout_par_portion          | numeric                  | YES         | null                 |
| fiches_techniques                        | portions                  | numeric                  | YES         | 1                    |
| fiches_techniques                        | famille                   | text                     | YES         | null                 |
| fiches_techniques                        | prix_vente                | numeric                  | YES         | null                 |
| fiches_techniques                        | type_carte                | text                     | YES         | null                 |
| fiches_techniques                        | sous_type_carte           | text                     | YES         | null                 |
| fiches_techniques                        | carte_actuelle            | boolean                  | YES         | false                |
| fiches_techniques                        | cout_total                | numeric                  | YES         | null                 |
| fiches_techniques                        | cout_portion              | numeric                  | YES         | null                 |
| fiches_techniques                        | rendement                 | numeric                  | YES         | 1                    |
| fournisseur_contacts                     | id                        | uuid                     | NO          | gen_random_uuid()    |
| fournisseur_contacts                     | mama_id                   | uuid                     | NO          | null                 |
| fournisseur_contacts                     | fournisseur_id            | uuid                     | NO          | null                 |
| fournisseur_contacts                     | nom                       | text                     | YES         | null                 |
| fournisseur_contacts                     | email                     | text                     | YES         | null                 |
| fournisseur_contacts                     | tel                       | text                     | YES         | null                 |
| fournisseur_contacts                     | created_at                | timestamp with time zone | YES         | now()                |
| fournisseur_contacts                     | updated_at                | timestamp with time zone | YES         | now()                |
| fournisseur_contacts                     | actif                     | boolean                  | YES         | true                 |
| fournisseur_notes                        | id                        | uuid                     | NO          | gen_random_uuid()    |
| fournisseur_notes                        | mama_id                   | uuid                     | NO          | null                 |
| fournisseur_notes                        | fournisseur_id            | uuid                     | NO          | null                 |
| fournisseur_notes                        | note                      | text                     | YES         | null                 |
| fournisseur_notes                        | date                      | date                     | YES         | null                 |
| fournisseur_notes                        | created_at                | timestamp with time zone | YES         | now()                |
| fournisseur_notes                        | updated_at                | timestamp with time zone | YES         | now()                |
| fournisseur_notes                        | actif                     | boolean                  | YES         | true                 |
| fournisseur_produits                     | id                        | uuid                     | NO          | gen_random_uuid()    |
| fournisseur_produits                     | mama_id                   | uuid                     | NO          | null                 |
| fournisseur_produits                     | fournisseur_id            | uuid                     | NO          | null                 |
| fournisseur_produits                     | produit_id                | uuid                     | NO          | null                 |
| fournisseur_produits                     | created_at                | timestamp with time zone | YES         | now()                |
| fournisseur_produits                     | updated_at                | timestamp with time zone | YES         | now()                |
| fournisseur_produits                     | actif                     | boolean                  | YES         | true                 |
| fournisseur_produits                     | prix_achat                | numeric                  | YES         | null                 |
| fournisseur_produits                     | date_livraison            | date                     | YES         | null                 |
| fournisseurs                             | id                        | uuid                     | NO          | gen_random_uuid()    |
| fournisseurs                             | mama_id                   | uuid                     | NO          | null                 |
| fournisseurs                             | nom                       | text                     | NO          | null                 |
| fournisseurs                             | created_at                | timestamp with time zone | YES         | now()                |
| fournisseurs                             | updated_at                | timestamp with time zone | YES         | now()                |
| fournisseurs                             | actif                     | boolean                  | YES         | true                 |
| fournisseurs_api_config                  | fournisseur_id            | uuid                     | NO          | null                 |
| fournisseurs_api_config                  | mama_id                   | uuid                     | NO          | null                 |
| fournisseurs_api_config                  | url                       | text                     | YES         | null                 |
| fournisseurs_api_config                  | type_api                  | text                     | YES         | 'rest'::text         |
| fournisseurs_api_config                  | token                     | text                     | YES         | null                 |
| fournisseurs_api_config                  | format_facture            | text                     | YES         | 'json'::text         |
| fournisseurs_api_config                  | actif                     | boolean                  | YES         | true                 |
| fournisseurs_api_config                  | created_at                | timestamp with time zone | YES         | now()                |
| gadgets                                  | id                        | uuid                     | NO          | gen_random_uuid()    |
| gadgets                                  | tableau_id                | uuid                     | YES         | null                 |
| gadgets                                  | type                      | text                     | YES         | null                 |
| gadgets                                  | config                    | jsonb                    | YES         | null                 |
| gadgets                                  | created_at                | timestamp with time zone | YES         | now()                |
| gadgets                                  | mama_id                   | uuid                     | YES         | null                 |
| gadgets                                  | actif                     | boolean                  | YES         | true                 |
| gadgets                                  | nom                       | text                     | YES         | null                 |
| gadgets                                  | ordre                     | integer                  | YES         | 0                    |
| gadgets                                  | configuration_json        | jsonb                    | YES         | null                 |
| guides_seen                              | user_id                   | uuid                     | NO          | null                 |
| guides_seen                              | mama_id                   | uuid                     | YES         | null                 |
| guides_seen                              | module                    | text                     | NO          | null                 |
| guides_seen                              | seen                      | boolean                  | YES         | false                |
| help_articles                            | id                        | uuid                     | NO          | gen_random_uuid()    |
| help_articles                            | titre                     | text                     | YES         | null                 |
| help_articles                            | contenu                   | text                     | YES         | null                 |
| help_articles                            | created_at                | timestamp with time zone | YES         | now()                |
| inventaire_lignes                        | id                        | uuid                     | NO          | gen_random_uuid()    |
| inventaire_lignes                        | mama_id                   | uuid                     | NO          | null                 |
| inventaire_lignes                        | inventaire_id             | uuid                     | NO          | null                 |
| inventaire_lignes                        | produit_id                | uuid                     | NO          | null                 |
| inventaire_lignes                        | quantite                  | numeric                  | YES         | null                 |
| inventaire_lignes                        | created_at                | timestamp with time zone | YES         | now()                |
| inventaire_lignes                        | updated_at                | timestamp with time zone | YES         | now()                |
| inventaire_lignes                        | actif                     | boolean                  | YES         | true                 |
| inventaire_lignes                        | zone_id                   | uuid                     | YES         | null                 |
| inventaire_lignes                        | quantite_theorique        | numeric                  | YES         | null                 |
| inventaire_lignes                        | quantite_reelle           | numeric                  | YES         | null                 |
| inventaire_lignes                        | motif                     | text                     | YES         | null                 |
| inventaire_zones                         | id                        | uuid                     | NO          | gen_random_uuid()    |
| inventaire_zones                         | mama_id                   | uuid                     | YES         | null                 |
| inventaire_zones                         | nom                       | text                     | YES         | null                 |
| inventaire_zones                         | created_at                | timestamp with time zone | YES         | now()                |
| inventaire_zones                         | actif                     | boolean                  | YES         | true                 |
| inventaires                              | id                        | uuid                     | NO          | gen_random_uuid()    |
| inventaires                              | mama_id                   | uuid                     | NO          | null                 |
| inventaires                              | date_inventaire           | date                     | YES         | null                 |
| inventaires                              | created_at                | timestamp with time zone | YES         | now()                |
| inventaires                              | updated_at                | timestamp with time zone | YES         | now()                |
| inventaires                              | actif                     | boolean                  | YES         | true                 |
| inventaires                              | reference                 | text                     | YES         | null                 |
| inventaires                              | zone                      | text                     | YES         | null                 |
| inventaires                              | date_debut                | date                     | YES         | null                 |
| inventaires                              | cloture                   | boolean                  | YES         | false                |
| journal_audit                            | id                        | uuid                     | NO          | gen_random_uuid()    |
| journal_audit                            | mama_id                   | uuid                     | NO          | null                 |
| journal_audit                            | table_name                | text                     | YES         | null                 |
| journal_audit                            | row_id                    | uuid                     | YES         | null                 |
| journal_audit                            | operation                 | text                     | YES         | null                 |
| journal_audit                            | old_data                  | jsonb                    | YES         | null                 |
| journal_audit                            | new_data                  | jsonb                    | YES         | null                 |
| journal_audit                            | changed_by                | uuid                     | YES         | null                 |
| journal_audit                            | created_at                | timestamp with time zone | YES         | now()                |
| journal_audit                            | updated_at                | timestamp with time zone | YES         | now()                |
| journal_audit                            | actif                     | boolean                  | YES         | true                 |
| journal_audit                            | changed_at                | timestamp with time zone | YES         | null                 |
| journal_audit                            | utilisateur_id            | uuid                     | YES         | null                 |
| journaux_utilisateur                     | id                        | uuid                     | NO          | gen_random_uuid()    |
| journaux_utilisateur                     | mama_id                   | uuid                     | NO          | null                 |
| journaux_utilisateur                     | user_id                   | uuid                     | NO          | null                 |
| journaux_utilisateur                     | action                    | text                     | YES         | null                 |
| journaux_utilisateur                     | details                   | jsonb                    | YES         | null                 |
| journaux_utilisateur                     | done_by                   | uuid                     | YES         | null                 |
| journaux_utilisateur                     | created_at                | timestamp with time zone | YES         | now()                |
| journaux_utilisateur                     | updated_at                | timestamp with time zone | YES         | now()                |
| journaux_utilisateur                     | actif                     | boolean                  | YES         | true                 |
| journaux_utilisateur                     | utilisateur_id            | uuid                     | YES         | null                 |
| journaux_utilisateur                     | page                      | text                     | YES         | null                 |
| journaux_utilisateur                     | ip                        | text                     | YES         | null                 |
| journaux_utilisateur                     | date_action               | timestamp with time zone | YES         | null                 |
| lignes_bl                                | id                        | uuid                     | NO          | gen_random_uuid()    |
| lignes_bl                                | bl_id                     | uuid                     | YES         | null                 |
| lignes_bl                                | produit_id                | uuid                     | YES         | null                 |
| lignes_bl                                | quantite                  | numeric                  | YES         | null                 |
| lignes_bl                                | prix                      | numeric                  | YES         | null                 |
| lignes_bl                                | tva                       | numeric                  | YES         | null                 |
| lignes_bl                                | created_at                | timestamp with time zone | YES         | now()                |
| lignes_bl                                | mama_id                   | uuid                     | YES         | null                 |
| lignes_bl                                | quantite_recue            | numeric                  | YES         | null                 |
| lignes_bl                                | prix_unitaire             | numeric                  | YES         | null                 |
| lignes_bl                                | commentaire               | text                     | YES         | null                 |
| lignes_bl                                | actif                     | boolean                  | YES         | true                 |
| lignes_bl                                | updated_at                | timestamp with time zone | YES         | now()                |
| logs_securite                            | id                        | uuid                     | NO          | gen_random_uuid()    |
| logs_securite                            | mama_id                   | uuid                     | YES         | null                 |
| logs_securite                            | user_id                   | uuid                     | YES         | null                 |
| logs_securite                            | type                      | text                     | YES         | null                 |
| logs_securite                            | ip                        | text                     | YES         | null                 |
| logs_securite                            | navigateur                | text                     | YES         | null                 |
| logs_securite                            | description               | text                     | YES         | null                 |
| logs_securite                            | created_at                | timestamp with time zone | YES         | now()                |
| logs_securite                            | utilisateur_id            | uuid                     | YES         | null                 |
| logs_securite                            | type_evenement            | text                     | YES         | null                 |
| logs_securite                            | details                   | jsonb                    | YES         | null                 |
| logs_securite                            | date_evenement            | timestamp with time zone | YES         | null                 |
| logs_securite                            | niveau_criticite          | text                     | YES         | null                 |
| mamas                                    | id                        | uuid                     | NO          | gen_random_uuid()    |
| mamas                                    | created_at                | timestamp with time zone | YES         | now()                |
| mamas                                    | updated_at                | timestamp with time zone | YES         | now()                |
| mamas                                    | actif                     | boolean                  | YES         | true                 |
| mamas                                    | nom                       | text                     | YES         | null                 |
| mamas                                    | logo_url                  | text                     | YES         | null                 |
| mamas                                    | primary_color             | text                     | YES         | null                 |
| mamas                                    | secondary_color           | text                     | YES         | null                 |
| mamas                                    | email_envoi               | text                     | YES         | null                 |
| mamas                                    | email_alertes             | text                     | YES         | null                 |
| mamas                                    | dark_mode                 | boolean                  | YES         | false                |
| mamas                                    | langue                    | text                     | YES         | 'fr'::text           |
| mamas                                    | monnaie                   | text                     | YES         | 'EUR'::text          |
| mamas                                    | timezone                  | text                     | YES         | 'Europe/Paris'::text |
| mamas                                    | rgpd_text                 | text                     | YES         | null                 |
| mamas                                    | mentions_legales          | text                     | YES         | null                 |
| mamas                                    | ville                     | text                     | YES         | null                 |
| menu_fiches                              | id                        | uuid                     | NO          | gen_random_uuid()    |
| menu_fiches                              | mama_id                   | uuid                     | NO          | null                 |
| menu_fiches                              | menu_id                   | uuid                     | NO          | null                 |
| menu_fiches                              | fiche_id                  | uuid                     | NO          | null                 |
| menu_fiches                              | created_at                | timestamp with time zone | YES         | now()                |
| menu_fiches                              | updated_at                | timestamp with time zone | YES         | now()                |
| menu_fiches                              | actif                     | boolean                  | YES         | true                 |
| menus                                    | id                        | uuid                     | NO          | gen_random_uuid()    |
| menus                                    | mama_id                   | uuid                     | NO          | null                 |
| menus                                    | nom                       | text                     | NO          | null                 |
| menus                                    | date                      | date                     | YES         | null                 |
| menus                                    | created_at                | timestamp with time zone | YES         | now()                |
| menus                                    | updated_at                | timestamp with time zone | YES         | now()                |
| menus                                    | actif                     | boolean                  | YES         | true                 |
| menus_jour                               | id                        | uuid                     | NO          | gen_random_uuid()    |
| menus_jour                               | mama_id                   | uuid                     | NO          | null                 |
| menus_jour                               | nom                       | text                     | NO          | null                 |
| menus_jour                               | date                      | date                     | NO          | null                 |
| menus_jour                               | prix_vente_ttc            | numeric                  | YES         | null                 |
| menus_jour                               | tva                       | numeric                  | YES         | 5.5                  |
| menus_jour                               | created_at                | timestamp with time zone | YES         | now()                |
| menus_jour                               | updated_at                | timestamp with time zone | YES         | now()                |
| menus_jour                               | actif                     | boolean                  | YES         | true                 |
| menus_jour_fiches                        | id                        | uuid                     | NO          | gen_random_uuid()    |
| menus_jour_fiches                        | menu_jour_id              | uuid                     | NO          | null                 |
| menus_jour_fiches                        | fiche_id                  | uuid                     | NO          | null                 |
| menus_jour_fiches                        | mama_id                   | uuid                     | NO          | null                 |
| menus_jour_fiches                        | quantite                  | numeric                  | YES         | 1                    |
| menus_jour_fiches                        | created_at                | timestamp with time zone | YES         | now()                |
| menus_jour_fiches                        | updated_at                | timestamp with time zone | YES         | now()                |
| menus_jour_fiches                        | actif                     | boolean                  | YES         | true                 |
| mouvements_centres_cout                  | id                        | uuid                     | NO          | gen_random_uuid()    |
| mouvements_centres_cout                  | mama_id                   | uuid                     | NO          | null                 |
| mouvements_centres_cout                  | mouvement_id              | uuid                     | YES         | null                 |
| mouvements_centres_cout                  | centre_cout_id            | uuid                     | NO          | null                 |
| mouvements_centres_cout                  | quantite                  | numeric                  | YES         | null                 |
| mouvements_centres_cout                  | valeur                    | numeric                  | YES         | null                 |
| mouvements_centres_cout                  | created_at                | timestamp with time zone | YES         | now()                |
| mouvements_centres_cout                  | updated_at                | timestamp with time zone | YES         | now()                |
| mouvements_centres_cout                  | actif                     | boolean                  | YES         | true                 |
| notification_preferences                 | id                        | uuid                     | NO          | gen_random_uuid()    |
| notification_preferences                 | utilisateur_id            | uuid                     | YES         | null                 |
| notification_preferences                 | mama_id                   | uuid                     | YES         | null                 |
| notification_preferences                 | email_enabled             | boolean                  | YES         | true                 |
| notification_preferences                 | webhook_enabled           | boolean                  | YES         | false                |
| notification_preferences                 | webhook_url               | text                     | YES         | null                 |
| notification_preferences                 | webhook_token             | text                     | YES         | null                 |
| notification_preferences                 | updated_at                | timestamp with time zone | YES         | now()                |
| notifications                            | id                        | uuid                     | NO          | gen_random_uuid()    |
| notifications                            | mama_id                   | uuid                     | YES         | null                 |
| notifications                            | user_id                   | uuid                     | YES         | null                 |
| notifications                            | titre                     | text                     | YES         | null                 |
| notifications                            | texte                     | text                     | YES         | null                 |
| notifications                            | lien                      | text                     | YES         | null                 |
| notifications                            | type                      | text                     | YES         | null                 |
| notifications                            | lu                        | boolean                  | YES         | false                |
| notifications                            | created_at                | timestamp with time zone | YES         | now()                |
| notifications                            | actif                     | boolean                  | YES         | true                 |
| notifications                            | utilisateur_id            | uuid                     | YES         | null                 |
| parametres                               | id                        | uuid                     | NO          | gen_random_uuid()    |
| parametres                               | mama_id                   | uuid                     | NO          | null                 |
| parametres                               | nom                       | text                     | YES         | null                 |
| parametres                               | logo                      | text                     | YES         | null                 |
| parametres                               | contacts                  | jsonb                    | YES         | null                 |
| parametres                               | created_at                | timestamp with time zone | YES         | now()                |
| parametres                               | updated_at                | timestamp with time zone | YES         | now()                |
| parametres                               | actif                     | boolean                  | YES         | true                 |
| permissions                              | id                        | uuid                     | NO          | gen_random_uuid()    |
| permissions                              | mama_id                   | uuid                     | NO          | null                 |
| permissions                              | role_id                   | uuid                     | NO          | null                 |
| permissions                              | user_id                   | uuid                     | YES         | null                 |
| permissions                              | module                    | text                     | YES         | null                 |
| permissions                              | droit                     | text                     | YES         | null                 |
| permissions                              | created_at                | timestamp with time zone | YES         | now()                |
| permissions                              | updated_at                | timestamp with time zone | YES         | now()                |
| permissions                              | actif                     | boolean                  | YES         | true                 |
| pertes                                   | id                        | uuid                     | NO          | gen_random_uuid()    |
| pertes                                   | mama_id                   | uuid                     | NO          | null                 |
| pertes                                   | produit_id                | uuid                     | NO          | null                 |
| pertes                                   | centre_cout_id            | uuid                     | YES         | null                 |
| pertes                                   | date_perte                | date                     | YES         | null                 |
| pertes                                   | quantite                  | numeric                  | YES         | null                 |
| pertes                                   | motif                     | text                     | YES         | null                 |
| pertes                                   | created_by                | uuid                     | YES         | null                 |
| pertes                                   | created_at                | timestamp with time zone | YES         | now()                |
| pertes                                   | updated_at                | timestamp with time zone | YES         | now()                |
| pertes                                   | actif                     | boolean                  | YES         | true                 |
| planning_previsionnel                    | id                        | uuid                     | NO          | gen_random_uuid()    |
| planning_previsionnel                    | mama_id                   | uuid                     | YES         | null                 |
| planning_previsionnel                    | date_prevue               | date                     | YES         | null                 |
| planning_previsionnel                    | quantite                  | numeric                  | YES         | null                 |
| planning_previsionnel                    | produit_id                | uuid                     | YES         | null                 |
| planning_previsionnel                    | created_at                | timestamp with time zone | YES         | now()                |
| produits                                 | id                        | uuid                     | NO          | gen_random_uuid()    |
| produits                                 | mama_id                   | uuid                     | NO          | null                 |
| produits                                 | nom                       | text                     | NO          | null                 |
| produits                                 | created_at                | timestamp with time zone | YES         | now()                |
| produits                                 | updated_at                | timestamp with time zone | YES         | now()                |
| produits                                 | actif                     | boolean                  | YES         | true                 |
| produits                                 | famille_id                | uuid                     | YES         | null                 |
| produits                                 | unite_id                  | uuid                     | YES         | null                 |
| produits                                 | code                      | text                     | YES         | null                 |
| produits                                 | url_photo                 | text                     | YES         | null                 |
| produits                                 | allergenes                | text                     | YES         | null                 |
| produits                                 | pmp                       | numeric                  | YES         | null                 |
| produits                                 | stock_reel                | numeric                  | YES         | null                 |
| produits                                 | stock_min                 | numeric                  | YES         | null                 |
| produits                                 | stock_theorique           | numeric                  | YES         | null                 |
| produits                                 | fournisseur_principal_id          | uuid                     | YES         | null                 |
| produits                                 | dernier_prix              | numeric                  | YES         | null                 |
| produits                                 | fiche_technique_id        | uuid                     | YES         | null                 |
| produits                                 | prix_vente                | numeric                  | YES         | null                 |
| promotion_produits                       | id                        | uuid                     | NO          | gen_random_uuid()    |
| promotion_produits                       | mama_id                   | uuid                     | NO          | null                 |
| promotion_produits                       | promotion_id              | uuid                     | NO          | null                 |
| promotion_produits                       | produit_id                | uuid                     | NO          | null                 |
| promotion_produits                       | discount                  | numeric                  | YES         | null                 |
| promotion_produits                       | prix_promo                | numeric                  | YES         | null                 |
| promotion_produits                       | created_at                | timestamp with time zone | YES         | now()                |
| promotion_produits                       | updated_at                | timestamp with time zone | YES         | now()                |
| promotion_produits                       | actif                     | boolean                  | YES         | true                 |
| promotions                               | id                        | uuid                     | NO          | gen_random_uuid()    |
| promotions                               | mama_id                   | uuid                     | NO          | null                 |
| promotions                               | nom                       | text                     | YES         | null                 |
| promotions                               | description               | text                     | YES         | null                 |
| promotions                               | date_debut                | date                     | YES         | null                 |
| promotions                               | date_fin                  | date                     | YES         | null                 |
| promotions                               | created_at                | timestamp with time zone | YES         | now()                |
| promotions                               | updated_at                | timestamp with time zone | YES         | now()                |
| promotions                               | actif                     | boolean                  | YES         | true                 |
| regles_alertes                           | id                        | uuid                     | NO          | gen_random_uuid()    |
| regles_alertes                           | mama_id                   | uuid                     | YES         | null                 |
| regles_alertes                           | produit_id                | uuid                     | YES         | null                 |
| regles_alertes                           | type                      | text                     | YES         | null                 |
| regles_alertes                           | seuil                     | numeric                  | YES         | null                 |
| regles_alertes                           | actif                     | boolean                  | YES         | true                 |
| regles_alertes                           | created_at                | timestamp with time zone | YES         | now()                |
| requisition_lignes                       | id                        | uuid                     | NO          | gen_random_uuid()    |
| requisition_lignes                       | mama_id                   | uuid                     | NO          | null                 |
| requisition_lignes                       | requisition_id            | uuid                     | NO          | null                 |
| requisition_lignes                       | produit_id                | uuid                     | NO          | null                 |
| requisition_lignes                       | quantite_demandee         | numeric                  | YES         | null                 |
| requisition_lignes                       | stock_theorique_avant     | numeric                  | YES         | null                 |
| requisition_lignes                       | stock_theorique_apres     | numeric                  | YES         | null                 |
| requisition_lignes                       | commentaire               | text                     | YES         | null                 |
| requisition_lignes                       | actif                     | boolean                  | YES         | true                 |
| requisition_lignes                       | created_at                | timestamp with time zone | YES         | now()                |
| requisition_lignes                       | updated_at                | timestamp with time zone | YES         | now()                |
| requisitions                             | id                        | uuid                     | NO          | gen_random_uuid()    |
| requisitions                             | mama_id                   | uuid                     | NO          | null                 |
| requisitions                             | produit_id                | uuid                     | NO          | null                 |
| requisitions                             | zone_id                   | uuid                     | NO          | null                 |
| requisitions                             | date_requisition          | date                     | YES         | null                 |
| requisitions                             | quantite                  | numeric                  | YES         | null                 |
| requisitions                             | type                      | text                     | YES         | null                 |
| requisitions                             | commentaire               | text                     | YES         | null                 |
| requisitions                             | auteur_id                 | uuid                     | YES         | null                 |
| requisitions                             | created_at                | timestamp with time zone | YES         | now()                |
| requisitions                             | updated_at                | timestamp with time zone | YES         | now()                |
| requisitions                             | actif                     | boolean                  | YES         | true                 |
| requisitions                             | utilisateur_id            | uuid                     | YES         | null                 |
| requisitions                             | date_demande              | date                     | YES         | null                 |
| requisitions                             | statut                    | text                     | YES         | 'brouillon'::text    |
| roles                                    | id                        | uuid                     | NO          | gen_random_uuid()    |
| roles                                    | nom                       | text                     | NO          | null                 |
| roles                                    | created_at                | timestamp with time zone | YES         | now()                |
| roles                                    | updated_at                | timestamp with time zone | YES         | now()                |
| roles                                    | actif                     | boolean                  | YES         | true                 |
| roles                                    | mama_id                   | uuid                     | YES         | null                 |
| roles                                    | description               | text                     | YES         | null                 |
| roles                                    | access_rights             | jsonb                    | YES         | '[]'::jsonb          |
| signalements                             | id                        | uuid                     | NO          | gen_random_uuid()    |
| signalements                             | mama_id                   | uuid                     | YES         | null                 |
| signalements                             | created_by                | uuid                     | YES         | null                 |
| signalements                             | type                      | text                     | YES         | null                 |
| signalements                             | description               | text                     | YES         | null                 |
| signalements                             | date                      | timestamp with time zone | YES         | null                 |
| signalements                             | created_at                | timestamp with time zone | YES         | now()                |
| stock_mouvements                         | id                        | uuid                     | NO          | gen_random_uuid()    |
| stock_mouvements                         | mama_id                   | uuid                     | NO          | null                 |
| stock_mouvements                         | inventaire_id             | uuid                     | NO          | null                 |
| stock_mouvements                         | created_at                | timestamp with time zone | YES         | now()                |
| stock_mouvements                         | updated_at                | timestamp with time zone | YES         | now()                |
| stock_mouvements                         | actif                     | boolean                  | YES         | true                 |
| stock_mouvements                         | date                      | timestamp with time zone | YES         | null                 |
| stock_mouvements                         | type                      | text                     | YES         | null                 |
| stock_mouvements                         | quantite                  | numeric                  | YES         | null                 |
| stock_mouvements                         | produit_id                | uuid                     | YES         | null                 |
| stock_mouvements                         | zone_source_id            | uuid                     | YES         | null                 |
| stock_mouvements                         | zone_destination_id       | uuid                     | YES         | null                 |
| stock_mouvements                         | commentaire               | text                     | YES         | null                 |
| stock_mouvements                         | auteur_id                 | uuid                     | YES         | null                 |
| stock_mouvements                         | zone_id                   | uuid                     | YES         | null                 |
| stocks                                   | id                        | uuid                     | NO          | gen_random_uuid()    |
| stocks                                   | mama_id                   | uuid                     | NO          | null                 |
| stocks                                   | zone_id                   | uuid                     | NO          | null                 |
| stocks                                   | produit_id                | uuid                     | NO          | null                 |
| stocks                                   | quantite                  | numeric                  | YES         | null                 |
| stocks                                   | created_at                | timestamp with time zone | YES         | now()                |
| stocks                                   | updated_at                | timestamp with time zone | YES         | now()                |
| stocks                                   | actif                     | boolean                  | YES         | true                 |
| tableaux_de_bord                         | id                        | uuid                     | NO          | gen_random_uuid()    |
| tableaux_de_bord                         | mama_id                   | uuid                     | YES         | null                 |
| tableaux_de_bord                         | nom                       | text                     | YES         | null                 |
| tableaux_de_bord                         | created_at                | timestamp with time zone | YES         | now()                |
| tableaux_de_bord                         | utilisateur_id            | uuid                     | YES         | null                 |
| tache_assignations                       | id                        | uuid                     | NO          | gen_random_uuid()    |
| tache_assignations                       | mama_id                   | uuid                     | NO          | null                 |
| tache_assignations                       | tache_id                  | uuid                     | NO          | null                 |
| tache_assignations                       | utilisateur_id            | uuid                     | NO          | null                 |
| tache_assignations                       | statut                    | text                     | YES         | 'a_faire'::text      |
| tache_assignations                       | commentaire               | text                     | YES         | null                 |
| tache_assignations                       | date_realisation          | timestamp with time zone | YES         | null                 |
| tache_assignations                       | created_at                | timestamp with time zone | YES         | now()                |
| tache_assignations                       | updated_at                | timestamp with time zone | YES         | now()                |
| tache_assignations                       | actif                     | boolean                  | YES         | true                 |
| tache_instances                          | id                        | uuid                     | NO          | gen_random_uuid()    |
| tache_instances                          | mama_id                   | uuid                     | NO          | null                 |
| tache_instances                          | tache_id                  | uuid                     | NO          | null                 |
| tache_instances                          | date_echeance             | date                     | YES         | null                 |
| tache_instances                          | statut                    | text                     | YES         | null                 |
| tache_instances                          | done_by                   | uuid                     | YES         | null                 |
| tache_instances                          | created_at                | timestamp with time zone | YES         | now()                |
| tache_instances                          | updated_at                | timestamp with time zone | YES         | now()                |
| tache_instances                          | actif                     | boolean                  | YES         | true                 |
| taches                                   | id                        | uuid                     | NO          | gen_random_uuid()    |
| taches                                   | mama_id                   | uuid                     | NO          | null                 |
| taches                                   | titre                     | text                     | NO          | null                 |
| taches                                   | description               | text                     | YES         | null                 |
| taches                                   | assignes                  | ARRAY                    | YES         | null                 |
| taches                                   | date_debut                | date                     | YES         | null                 |
| taches                                   | delai_jours               | integer                  | YES         | null                 |
| taches                                   | date_echeance             | date                     | YES         | null                 |
| taches                                   | recurrente                | boolean                  | YES         | null                 |
| taches                                   | frequence                 | text                     | YES         | null                 |
| taches                                   | priorite                  | text                     | YES         | null                 |
| taches                                   | statut                    | text                     | YES         | null                 |
| taches                                   | created_by                | uuid                     | YES         | null                 |
| taches                                   | created_at                | timestamp with time zone | YES         | now()                |
| taches                                   | updated_at                | timestamp with time zone | YES         | now()                |
| taches                                   | actif                     | boolean                  | YES         | true                 |
| taches                                   | utilisateur_id            | uuid                     | YES         | null                 |
| tooltips                                 | id                        | uuid                     | NO          | gen_random_uuid()    |
| tooltips                                 | mama_id                   | uuid                     | YES         | null                 |
| tooltips                                 | champ                     | text                     | YES         | null                 |
| tooltips                                 | texte                     | text                     | YES         | null                 |
| tooltips                                 | created_at                | timestamp with time zone | YES         | now()                |
| transfert_lignes                         | id                        | uuid                     | NO          | gen_random_uuid()    |
| transfert_lignes                         | transfert_id              | uuid                     | NO          | null                 |
| transfert_lignes                         | produit_id                | uuid                     | NO          | null                 |
| transfert_lignes                         | quantite                  | numeric                  | NO          | null                 |
| transfert_lignes                         | commentaire               | text                     | YES         | null                 |
| transfert_lignes                         | actif                     | boolean                  | YES         | true                 |
| transferts                               | id                        | uuid                     | NO          | gen_random_uuid()    |
| transferts                               | mama_id                   | uuid                     | NO          | null                 |
| transferts                               | produit_id                | uuid                     | NO          | null                 |
| transferts                               | quantite                  | numeric                  | YES         | null                 |
| transferts                               | motif                     | text                     | YES         | null                 |
| transferts                               | date_transfert            | date                     | YES         | null                 |
| transferts                               | created_by                | uuid                     | YES         | null                 |
| transferts                               | created_at                | timestamp with time zone | YES         | now()                |
| transferts                               | updated_at                | timestamp with time zone | YES         | now()                |
| transferts                               | actif                     | boolean                  | YES         | true                 |
| transferts                               | zone_source_id            | uuid                     | YES         | null                 |
| transferts                               | zone_dest_id              | uuid                     | YES         | null                 |
| transferts                               | commentaire               | text                     | YES         | null                 |
| transferts                               | utilisateur_id            | uuid                     | YES         | null                 |
| unites                                   | id                        | uuid                     | NO          | uuid_generate_v4()   |
| unites                                   | nom                       | text                     | NO          | null                 |
| unites                                   | mama_id                   | uuid                     | NO          | null                 |
| unites                                   | actif                     | boolean                  | YES         | true                 |
| unites                                   | created_at                | timestamp with time zone | YES         | now()                |
| unites                                   | populaire                 | boolean                  | YES         | false                |
| unites                                   | updated_at                | timestamp with time zone | YES         | now()                |
| unites_equivalentes                      | id                        | uuid                     | NO          | gen_random_uuid()    |
| unites_equivalentes                      | mama_id                   | uuid                     | NO          | null                 |
| unites_equivalentes                      | unite_src                 | uuid                     | NO          | null                 |
| unites_equivalentes                      | unite_dst                 | uuid                     | NO          | null                 |
| unites_equivalentes                      | coefficient               | numeric                  | NO          | null                 |
| unites_equivalentes                      | actif                     | boolean                  | YES         | true                 |
| unites_equivalentes                      | created_at                | timestamp with time zone | YES         | now()                |
| unites_equivalentes                      | updated_at                | timestamp with time zone | YES         | now()                |
| usage_stats                              | id                        | uuid                     | NO          | gen_random_uuid()    |
| usage_stats                              | mama_id                   | uuid                     | YES         | null                 |
| usage_stats                              | user_id                   | uuid                     | YES         | null                 |
| usage_stats                              | module                    | text                     | YES         | null                 |
| usage_stats                              | timestamp                 | timestamp with time zone | YES         | now()                |
| users                                    | id                        | uuid                     | NO          | gen_random_uuid()    |
| users                                    | username                  | text                     | NO          | null                 |
| users                                    | created_at                | timestamp with time zone | YES         | now()                |
| users                                    | updated_at                | timestamp with time zone | YES         | now()                |
| users                                    | actif                     | boolean                  | YES         | true                 |
| utilisateurs                             | id                        | uuid                     | NO          | gen_random_uuid()    |
| utilisateurs                             | mama_id                   | uuid                     | NO          | null                 |
| utilisateurs                             | nom                       | text                     | YES         | null                 |
| utilisateurs                             | created_at                | timestamp with time zone | YES         | now()                |
| utilisateurs                             | updated_at                | timestamp with time zone | YES         | now()                |
| utilisateurs                             | actif                     | boolean                  | YES         | true                 |
| utilisateurs                             | role_id                   | uuid                     | YES         | null                 |
| utilisateurs                             | access_rights             | jsonb                    | YES         | '[]'::jsonb          |
| utilisateurs                             | auth_id                   | uuid                     | YES         | null                 |
| utilisateurs                             | email                     | text                     | YES         | null                 |
| utilisateurs                             | role                      | text                     | YES         | null                 |
| utilisateurs                             | invite_pending            | boolean                  | YES         | false                |
| utilisateurs_complets                    | id                        | uuid                     | YES         | null                 |
| utilisateurs_complets                    | nom                       | text                     | YES         | null                 |
| utilisateurs_complets                    | mama_id                   | uuid                     | YES         | null                 |
| utilisateurs_complets                    | created_at                | timestamp with time zone | YES         | null                 |
| utilisateurs_complets                    | updated_at                | timestamp with time zone | YES         | null                 |
| utilisateurs_complets                    | actif                     | boolean                  | YES         | null                 |
| utilisateurs_complets                    | role                      | text                     | YES         | null                 |
| v_analytique_stock                       | date                      | timestamp with time zone | YES         | null                 |
| v_analytique_stock                       | produit_id                | uuid                     | YES         | null                 |
| v_analytique_stock                       | famille                   | text                     | YES         | null                 |
| v_analytique_stock                       | activite                  | text                     | YES         | null                 |
| v_analytique_stock                       | cost_center_id            | uuid                     | YES         | null                 |
| v_analytique_stock                       | cost_center_nom           | text                     | YES         | null                 |
| v_analytique_stock                       | quantite                  | numeric                  | YES         | null                 |
| v_analytique_stock                       | valeur                    | numeric                  | YES         | null                 |
| v_analytique_stock                       | mama_id                   | uuid                     | YES         | null                 |
| v_besoins_previsionnels                  | mama_id                   | uuid                     | YES         | null                 |
| v_besoins_previsionnels                  | menu_id                   | uuid                     | YES         | null                 |
| v_besoins_previsionnels                  | produit_id                | uuid                     | YES         | null                 |
| v_besoins_previsionnels                  | quantite                  | numeric                  | YES         | null                 |
| v_besoins_previsionnels                  | valeur                    | numeric                  | YES         | null                 |
| v_boissons                               | id                        | uuid                     | YES         | null                 |
| v_boissons                               | nom                       | text                     | YES         | null                 |
| v_boissons                               | prix_vente                | numeric                  | YES         | null                 |
| v_boissons                               | created_at                | timestamp with time zone | YES         | null                 |
| v_boissons                               | mama_id                   | uuid                     | YES         | null                 |
| v_boissons                               | famille                   | text                     | YES         | null                 |
| v_boissons                               | unite                     | text                     | YES         | null                 |
| v_boissons                               | fiche_id                  | uuid                     | YES         | null                 |
| v_boissons                               | cout_portion              | numeric                  | YES         | null                 |
| v_cost_center_month                      | mama_id                   | uuid                     | YES         | null                 |
| v_cost_center_month                      | cost_center_id            | uuid                     | YES         | null                 |
| v_cost_center_month                      | nom                       | text                     | YES         | null                 |
| v_cost_center_month                      | mois                      | text                     | YES         | null                 |
| v_cost_center_month                      | total                     | numeric                  | YES         | null                 |
| v_cost_center_monthly                    | mama_id                   | uuid                     | YES         | null                 |
| v_cost_center_monthly                    | nom                       | text                     | YES         | null                 |
| v_cost_center_monthly                    | mois                      | text                     | YES         | null                 |
| v_cost_center_monthly                    | montant                   | numeric                  | YES         | null                 |
| v_ecarts_inventaire                      | mama_id                   | uuid                     | YES         | null                 |
| v_ecarts_inventaire                      | produit_id                | uuid                     | YES         | null                 |
| v_ecarts_inventaire                      | date                      | date                     | YES         | null                 |
| v_ecarts_inventaire                      | zone                      | uuid                     | YES         | null                 |
| v_ecarts_inventaire                      | stock_theorique           | numeric                  | YES         | null                 |
| v_ecarts_inventaire                      | stock_reel                | numeric                  | YES         | null                 |
| v_ecarts_inventaire                      | ecart                     | numeric                  | YES         | null                 |
| v_ecarts_inventaire                      | motif                     | text                     | YES         | null                 |
| v_evolution_achats                       | mama_id                   | uuid                     | YES         | null                 |
| v_evolution_achats                       | produit_id                | uuid                     | YES         | null                 |
| v_evolution_achats                       | mois                      | text                     | YES         | null                 |
| v_evolution_achats                       | montant                   | numeric                  | YES         | null                 |
| v_familles_orphelines                    | id                        | uuid                     | YES         | null                 |
| v_familles_orphelines                    | nom                       | text                     | YES         | null                 |
| v_familles_orphelines                    | mama_id                   | uuid                     | YES         | null                 |
| v_familles_orphelines                    | actif                     | boolean                  | YES         | null                 |
| v_familles_orphelines                    | created_at                | timestamp with time zone | YES         | null                 |
| v_familles_orphelines                    | parent_id                 | uuid                     | YES         | null                 |
| v_familles_orphelines                    | populaire                 | boolean                  | YES         | null                 |
| v_familles_orphelines                    | updated_at                | timestamp with time zone | YES         | null                 |
| v_fournisseurs_inactifs                  | mama_id                   | uuid                     | YES         | null                 |
| v_fournisseurs_inactifs                  | fournisseur_id            | uuid                     | YES         | null                 |
| v_fournisseurs_inactifs                  | nom                       | text                     | YES         | null                 |
| v_fournisseurs_inactifs                  | fournisseur_actif         | boolean                  | YES         | null                 |
| v_fournisseurs_inactifs                  | facture_actif             | boolean                  | YES         | null                 |
| v_fournisseurs_inactifs                  | dernier_achat             | date                     | YES         | null                 |
| v_menu_engineering                       | fiche_id                  | uuid                     | YES         | null                 |
| v_menu_engineering                       | nom                       | text                     | YES         | null                 |
| v_menu_engineering                       | famille                   | text                     | YES         | null                 |
| v_menu_engineering                       | prix_vente                | numeric                  | YES         | null                 |
| v_menu_engineering                       | cout_portion              | numeric                  | YES         | null                 |
| v_menu_engineering                       | periode                   | date                     | YES         | null                 |
| v_menu_engineering                       | ventes                    | integer                  | YES         | null                 |
| v_menu_engineering                       | popularite                | numeric                  | YES         | null                 |
| v_menu_engineering                       | marge                     | numeric                  | YES         | null                 |
| v_menu_engineering                       | mama_id                   | uuid                     | YES         | null                 |
| v_monthly_purchases                      | mama_id                   | uuid                     | YES         | null                 |
| v_monthly_purchases                      | mois                      | text                     | YES         | null                 |
| v_monthly_purchases                      | total                     | numeric                  | YES         | null                 |
| v_mouvements_centres_cout_stats          | centre_cout_id            | uuid                     | YES         | null                 |
| v_mouvements_centres_cout_stats          | centre_cout               | text                     | YES         | null                 |
| v_mouvements_centres_cout_stats          | total_quantite            | numeric                  | YES         | null                 |
| v_mouvements_centres_cout_stats          | total_valeur              | numeric                  | YES         | null                 |
| v_notifications_non_lues                 | utilisateur_id            | uuid                     | YES         | null                 |
| v_notifications_non_lues                 | mama_id                   | uuid                     | YES         | null                 |
| v_notifications_non_lues                 | total_non_lues            | bigint                   | YES         | null                 |
| v_performance_fiches                     | mama_id                   | uuid                     | YES         | null                 |
| v_performance_fiches                     | fiche_id                  | uuid                     | YES         | null                 |
| v_performance_fiches                     | nom                       | text                     | YES         | null                 |
| v_performance_fiches                     | cout                      | numeric                  | YES         | null                 |
| v_performance_fiches                     | volume                    | bigint                   | YES         | null                 |
| v_performance_fiches                     | popularite                | numeric                  | YES         | null                 |
| v_pmp                                    | mama_id                   | uuid                     | YES         | null                 |
| v_pmp                                    | produit_id                | uuid                     | YES         | null                 |
| v_pmp                                    | produit_actif             | boolean                  | YES         | null                 |
| v_pmp                                    | fournisseur_produit_actif | boolean                  | YES         | null                 |
| v_pmp                                    | pmp                       | numeric                  | YES         | null                 |
| v_produits_actifs                        | id                        | uuid                     | YES         | null                 |
| v_produits_actifs                        | mama_id                   | uuid                     | YES         | null                 |
| v_produits_actifs                        | nom                       | text                     | YES         | null                 |
| v_produits_actifs                        | created_at                | timestamp with time zone | YES         | null                 |
| v_produits_actifs                        | updated_at                | timestamp with time zone | YES         | null                 |
| v_produits_actifs                        | actif                     | boolean                  | YES         | null                 |
| v_produits_actifs                        | famille_id                | uuid                     | YES         | null                 |
| v_produits_actifs                        | unite_id                  | uuid                     | YES         | null                 |
| v_produits_actifs                        | code                      | text                     | YES         | null                 |
| v_produits_actifs                        | url_photo                 | text                     | YES         | null                 |
| v_produits_actifs                        | allergenes                | text                     | YES         | null                 |
| v_produits_actifs                        | pmp                       | numeric                  | YES         | null                 |
| v_produits_actifs                        | stock_reel                | numeric                  | YES         | null                 |
| v_produits_actifs                        | stock_min                 | numeric                  | YES         | null                 |
| v_produits_actifs                        | stock_theorique           | numeric                  | YES         | null                 |
| v_produits_actifs                        | fournisseur_principal_id          | uuid                     | YES         | null                 |
| v_produits_actifs                        | dernier_prix              | numeric                  | YES         | null                 |
| v_produits_dernier_prix                  | id                        | uuid                     | YES         | null                 |
| v_produits_dernier_prix                  | nom                       | text                     | YES         | null                 |
| v_produits_dernier_prix                  | famille_id                | uuid                     | YES         | null                 |
| v_produits_dernier_prix                  | famille                   | text                     | YES         | null                 |
| v_produits_dernier_prix                  | unite_id                  | uuid                     | YES         | null                 |
| v_produits_dernier_prix                  | unite                     | text                     | YES         | null                 |
| v_produits_dernier_prix                  | stock_reel                | numeric                  | YES         | null                 |
| v_produits_dernier_prix                  | stock_min                 | numeric                  | YES         | null                 |
| v_produits_dernier_prix                  | fournisseur_id            | uuid                     | YES         | null                 |
| v_produits_dernier_prix                  | fournisseur               | text                     | YES         | null                 |
| v_produits_dernier_prix                  | dernier_prix              | numeric                  | YES         | null                 |
| v_produits_dernier_prix                  | date_livraison            | date                     | YES         | null                 |
| v_produits_dernier_prix                  | mama_id                   | uuid                     | YES         | null                 |
| v_produits_inactifs                      | id                        | uuid                     | YES         | null                 |
| v_produits_inactifs                      | mama_id                   | uuid                     | YES         | null                 |
| v_produits_inactifs                      | nom                       | text                     | YES         | null                 |
| v_produits_inactifs                      | created_at                | timestamp with time zone | YES         | null                 |
| v_produits_inactifs                      | updated_at                | timestamp with time zone | YES         | null                 |
| v_produits_inactifs                      | actif                     | boolean                  | YES         | null                 |
| v_produits_inactifs                      | famille_id                | uuid                     | YES         | null                 |
| v_produits_inactifs                      | unite_id                  | uuid                     | YES         | null                 |
| v_produits_inactifs                      | code                      | text                     | YES         | null                 |
| v_produits_inactifs                      | url_photo                 | text                     | YES         | null                 |
| v_produits_inactifs                      | allergenes                | text                     | YES         | null                 |
| v_produits_inactifs                      | pmp                       | numeric                  | YES         | null                 |
| v_produits_inactifs                      | stock_reel                | numeric                  | YES         | null                 |
| v_produits_inactifs                      | stock_min                 | numeric                  | YES         | null                 |
| v_produits_inactifs                      | stock_theorique           | numeric                  | YES         | null                 |
| v_produits_inactifs                      | fournisseur_principal_id          | uuid                     | YES         | null                 |
| v_produits_inactifs                      | dernier_prix              | numeric                  | YES         | null                 |
| v_reco_stockmort                         | mama_id                   | uuid                     | YES         | null                 |
| v_reco_stockmort                         | produit_id                | uuid                     | YES         | null                 |
| v_reco_stockmort                         | nom                       | text                     | YES         | null                 |
| v_reco_stockmort                         | jours_inactif             | double precision         | YES         | null                 |
| v_reco_surcout                           | mama_id                   | uuid                     | YES         | null                 |
| v_reco_surcout                           | produit_id                | uuid                     | YES         | null                 |
| v_reco_surcout                           | nom                       | text                     | YES         | null                 |
| v_reco_surcout                           | variation_pct             | numeric                  | YES         | null                 |
| v_requisition_stock                      | ligne_id                  | uuid                     | YES         | null                 |
| v_requisition_stock                      | requisition_id            | uuid                     | YES         | null                 |
| v_requisition_stock                      | zone_id                   | uuid                     | YES         | null                 |
| v_requisition_stock                      | produit_id                | uuid                     | YES         | null                 |
| v_requisition_stock                      | stock_reel                | numeric                  | YES         | null                 |
| v_requisition_stock                      | quantite_demandee         | numeric                  | YES         | null                 |
| v_requisition_stock                      | stock_apres               | numeric                  | YES         | null                 |
| v_requisition_stock                      | mama_id                   | uuid                     | YES         | null                 |
| v_stocks                                 | mama_id                   | uuid                     | YES         | null                 |
| v_stocks                                 | produit_id                | uuid                     | YES         | null                 |
| v_stocks                                 | stock                     | numeric                  | YES         | null                 |
| v_tendance_prix_produit                  | mama_id                   | uuid                     | YES         | null                 |
| v_tendance_prix_produit                  | produit_id                | uuid                     | YES         | null                 |
| v_tendance_prix_produit                  | mois                      | text                     | YES         | null                 |
| v_tendance_prix_produit                  | prix_moyen                | numeric                  | YES         | null                 |
| v_transferts_historique                  | transfert_id              | uuid                     | YES         | null                 |
| v_transferts_historique                  | date_transfert            | date                     | YES         | null                 |
| v_transferts_historique                  | zone_source_id            | uuid                     | YES         | null                 |
| v_transferts_historique                  | zone_source               | text                     | YES         | null                 |
| v_transferts_historique                  | zone_dest_id              | uuid                     | YES         | null                 |
| v_transferts_historique                  | zone_dest                 | text                     | YES         | null                 |
| v_transferts_historique                  | produit_id                | uuid                     | YES         | null                 |
| v_transferts_historique                  | produit                   | text                     | YES         | null                 |
| v_transferts_historique                  | quantite                  | numeric                  | YES         | null                 |
| v_transferts_historique                  | commentaire               | text                     | YES         | null                 |
| v_transferts_historique                  | utilisateur_id            | uuid                     | YES         | null                 |
| v_transferts_historique                  | created_at                | timestamp with time zone | YES         | null                 |
| v_unites_orphelines                      | id                        | uuid                     | YES         | null                 |
| v_unites_orphelines                      | nom                       | text                     | YES         | null                 |
| v_unites_orphelines                      | mama_id                   | uuid                     | YES         | null                 |
| v_unites_orphelines                      | actif                     | boolean                  | YES         | null                 |
| v_unites_orphelines                      | created_at                | timestamp with time zone | YES         | null                 |
| v_unites_orphelines                      | populaire                 | boolean                  | YES         | null                 |
| v_unites_orphelines                      | updated_at                | timestamp with time zone | YES         | null                 |
| validation_requests                      | id                        | uuid                     | NO          | gen_random_uuid()    |
| validation_requests                      | mama_id                   | uuid                     | YES         | null                 |
| validation_requests                      | user_id                   | uuid                     | YES         | null                 |
| validation_requests                      | module                    | text                     | YES         | null                 |
| validation_requests                      | payload                   | jsonb                    | YES         | null                 |
| validation_requests                      | statut                    | text                     | YES         | null                 |
| validation_requests                      | created_at                | timestamp with time zone | YES         | now()                |
| validation_requests                      | actif                     | boolean                  | YES         | true                 |
| validation_requests                      | updated_at                | timestamp with time zone | YES         | now()                |
| ventes_boissons                          | id                        | uuid                     | NO          | gen_random_uuid()    |
| ventes_boissons                          | mama_id                   | uuid                     | NO          | null                 |
| ventes_boissons                          | boisson_id                | uuid                     | YES         | null                 |
| ventes_boissons                          | quantite                  | numeric                  | YES         | null                 |
| ventes_boissons                          | date_vente                | date                     | YES         | null                 |
| ventes_boissons                          | created_by                | uuid                     | YES         | null                 |
| ventes_boissons                          | created_at                | timestamp with time zone | YES         | now()                |
| ventes_boissons                          | updated_at                | timestamp with time zone | YES         | now()                |
| ventes_boissons                          | actif                     | boolean                  | YES         | true                 |
| ventes_fiches_carte                      | id                        | uuid                     | NO          | gen_random_uuid()    |
| ventes_fiches_carte                      | mama_id                   | uuid                     | NO          | null                 |
| ventes_fiches_carte                      | fiche_id                  | uuid                     | NO          | null                 |
| ventes_fiches_carte                      | periode                   | date                     | YES         | null                 |
| ventes_fiches_carte                      | ventes                    | integer                  | YES         | null                 |
| ventes_fiches_carte                      | created_at                | timestamp with time zone | YES         | now()                |
| ventes_fiches_carte                      | updated_at                | timestamp with time zone | YES         | now()                |
| ventes_fiches_carte                      | actif                     | boolean                  | YES         | true                 |
| vue_stock_disponible_par_produit_et_zone | produit                   | text                     | YES         | null                 |
| vue_stock_disponible_par_produit_et_zone | unite                     | text                     | YES         | null                 |
| vue_stock_disponible_par_produit_et_zone | famille                   | text                     | YES         | null                 |
| vue_stock_disponible_par_produit_et_zone | zone_stock                | text                     | YES         | null                 |
| vue_stock_disponible_par_produit_et_zone | quantite                  | numeric                  | YES         | null                 |
| vue_stock_disponible_par_produit_et_zone | updated_at                | timestamp with time zone | YES         | null                 |
| vue_stock_disponible_par_produit_et_zone | mama_id                   | uuid                     | YES         | null                 |
| zones_stock                              | id                        | uuid                     | NO          | gen_random_uuid()    |
| zones_stock                              | mama_id                   | uuid                     | NO          | null                 |
| zones_stock                              | nom                       | text                     | NO          | null                 |
| zones_stock                              | created_at                | timestamp with time zone | YES         | now()                |
| zones_stock                              | updated_at                | timestamp with time zone | YES         | now()                |
| zones_stock                              | actif                     | boolean                  | YES         | true                 |
| zones_stock                              | description               | text                     | YES         | null                 |
| zones_stock                              | type_zone                 | text                     | YES         | null                 |


SELECT
    tc.table_name,
    kcu.column_name,
    ccu.table_name AS foreign_table_name,
    ccu.column_name AS foreign_column_name
FROM
    information_schema.table_constraints AS tc
    JOIN information_schema.key_column_usage AS kcu
      ON tc.constraint_name = kcu.constraint_name
     AND tc.table_schema = kcu.table_schema
    JOIN information_schema.constraint_column_usage AS ccu
      ON ccu.constraint_name = tc.constraint_name
     AND ccu.table_schema = tc.table_schema
WHERE tc.constraint_type = 'FOREIGN KEY'
  AND tc.table_schema = 'public'
ORDER BY tc.table_name, kcu.column_name;


| table_name                | column_name         | foreign_table_name | foreign_column_name |
| ------------------------- | ------------------- | ------------------ | ------------------- |
| access_rights             | mama_id             | mamas              | id                  |
| access_rights             | role_id             | roles              | id                  |
| achats                    | mama_id             | mamas              | id                  |
| achats                    | produit_id          | produits           | id                  |
| achats                    | fournisseur_id      | fournisseurs       | id                  |
| api_keys                  | mama_id             | mamas              | id                  |
| api_keys                  | user_id             | utilisateurs       | id                  |
| bons_livraison            | commande_id         | commandes          | id                  |
| bons_livraison            | facture_id          | factures           | id                  |
| bons_livraison            | fournisseur_id      | fournisseurs       | id                  |
| bons_livraison            | mama_id             | mamas              | id                  |
| catalogue_updates         | fournisseur_id      | fournisseurs       | id                  |
| catalogue_updates         | mama_id             | mamas              | id                  |
| catalogue_updates         | produit_id          | produits           | id                  |
| centres_de_cout           | mama_id             | mamas              | id                  |
| commande_lignes           | commande_id         | commandes          | id                  |
| commande_lignes           | mama_id             | mamas              | id                  |
| commande_lignes           | produit_id          | produits           | id                  |
| commandes                 | bl_id               | bons_livraison     | id                  |
| commandes                 | facture_id          | factures           | id                  |
| commandes                 | fournisseur_id      | fournisseurs       | id                  |
| commandes                 | mama_id             | mamas              | id                  |
| compta_mapping            | mama_id             | mamas              | id                  |
| consentements_utilisateur | mama_id             | mamas              | id                  |
| consentements_utilisateur | user_id             | utilisateurs       | id                  |
| consentements_utilisateur | utilisateur_id      | utilisateurs       | id                  |
| documentation             | mama_id             | mamas              | id                  |
| documents                 | mama_id             | mamas              | id                  |
| etapes_onboarding         | mama_id             | mamas              | id                  |
| facture_lignes            | facture_id          | factures           | id                  |
| facture_lignes            | mama_id             | mamas              | id                  |
| facture_lignes            | produit_id          | produits           | id                  |
| factures                  | fournisseur_id      | fournisseurs       | id                  |
| factures                  | mama_id             | mamas              | id                  |
| familles                  | mama_id             | mamas              | id                  |
| familles                  | parent_id           | familles           | id                  |
| feedback                  | mama_id             | mamas              | id                  |
| feedback                  | user_id             | utilisateurs       | id                  |
| fiche_cout_history        | changed_by          | users              | id                  |
| fiche_cout_history        | fiche_id            | fiches             | id                  |
| fiche_cout_history        | mama_id             | mamas              | id                  |
| fiche_lignes              | fiche_id            | fiches             | id                  |
| fiche_lignes              | mama_id             | mamas              | id                  |
| fiche_lignes              | produit_id          | produits           | id                  |
| fiche_lignes              | sous_fiche_id       | fiches_techniques  | id                  |
| fiche_prix_history        | changed_by          | users              | id                  |
| fiche_prix_history        | fiche_id            | fiches             | id                  |
| fiche_prix_history        | mama_id             | mamas              | id                  |
| fiches                    | mama_id             | mamas              | id                  |
| fiches_techniques         | fiche_id            | fiches             | id                  |
| fiches_techniques         | mama_id             | mamas              | id                  |
| fournisseur_contacts      | fournisseur_id      | fournisseurs       | id                  |
| fournisseur_contacts      | mama_id             | mamas              | id                  |
| fournisseur_notes         | fournisseur_id      | fournisseurs       | id                  |
| fournisseur_notes         | mama_id             | mamas              | id                  |
| fournisseur_produits      | fournisseur_id      | fournisseurs       | id                  |
| fournisseur_produits      | fournisseur_id      | fournisseurs       | id                  |
| fournisseur_produits      | mama_id             | mamas              | id                  |
| fournisseur_produits      | produit_id          | produits           | id                  |
| fournisseur_produits      | produit_id          | produits           | id                  |
| fournisseurs              | mama_id             | mamas              | id                  |
| fournisseurs_api_config   | fournisseur_id      | fournisseurs       | id                  |
| fournisseurs_api_config   | mama_id             | mamas              | id                  |
| gadgets                   | tableau_id          | tableaux_de_bord   | id                  |
| guides_seen               | mama_id             | mamas              | id                  |
| guides_seen               | user_id             | utilisateurs       | id                  |
| inventaire_lignes         | inventaire_id       | inventaires        | id                  |
| inventaire_lignes         | mama_id             | mamas              | id                  |
| inventaire_lignes         | produit_id          | produits           | id                  |
| inventaire_lignes         | zone_id             | zones_stock        | id                  |
| inventaire_zones          | mama_id             | mamas              | id                  |
| inventaires               | mama_id             | mamas              | id                  |
| journal_audit             | changed_by          | users              | id                  |
| journal_audit             | mama_id             | mamas              | id                  |
| journal_audit             | utilisateur_id      | utilisateurs       | id                  |
| journaux_utilisateur      | done_by             | users              | id                  |
| journaux_utilisateur      | mama_id             | mamas              | id                  |
| journaux_utilisateur      | user_id             | users              | id                  |
| journaux_utilisateur      | utilisateur_id      | utilisateurs       | id                  |
| lignes_bl                 | bl_id               | bons_livraison     | id                  |
| lignes_bl                 | mama_id             | mamas              | id                  |
| lignes_bl                 | produit_id          | produits           | id                  |
| logs_securite             | mama_id             | mamas              | id                  |
| logs_securite             | user_id             | utilisateurs       | id                  |
| logs_securite             | utilisateur_id      | utilisateurs       | id                  |
| menu_fiches               | fiche_id            | fiches             | id                  |
| menu_fiches               | mama_id             | mamas              | id                  |
| menu_fiches               | menu_id             | menus              | id                  |
| menus                     | mama_id             | mamas              | id                  |
| menus_jour                | mama_id             | mamas              | id                  |
| menus_jour_fiches         | fiche_id            | fiches_techniques  | id                  |
| menus_jour_fiches         | mama_id             | mamas              | id                  |
| menus_jour_fiches         | menu_jour_id        | menus_jour         | id                  |
| mouvements_centres_cout   | centre_cout_id      | centres_de_cout    | id                  |
| mouvements_centres_cout   | mama_id             | mamas              | id                  |
| notification_preferences  | mama_id             | mamas              | id                  |
| notification_preferences  | utilisateur_id      | utilisateurs       | id                  |
| notifications             | mama_id             | mamas              | id                  |
| notifications             | user_id             | utilisateurs       | id                  |
| notifications             | utilisateur_id      | utilisateurs       | id                  |
| parametres                | mama_id             | mamas              | id                  |
| permissions               | mama_id             | mamas              | id                  |
| permissions               | role_id             | roles              | id                  |
| permissions               | user_id             | users              | id                  |
| pertes                    | centre_cout_id      | centres_de_cout    | id                  |
| pertes                    | created_by          | users              | id                  |
| pertes                    | mama_id             | mamas              | id                  |
| pertes                    | produit_id          | produits           | id                  |
| planning_previsionnel     | mama_id             | mamas              | id                  |
| planning_previsionnel     | produit_id          | produits           | id                  |
| produits                  | famille_id          | familles           | id                  |
| produits                  | fiche_technique_id  | fiches_techniques  | id                  |
| produits                  | fournisseur_principal_id    | fournisseurs       | id                  |
| produits                  | mama_id             | mamas              | id                  |
| produits                  | unite_id            | unites             | id                  |
| promotion_produits        | mama_id             | mamas              | id                  |
| promotion_produits        | produit_id          | produits           | id                  |
| promotion_produits        | promotion_id        | promotions         | id                  |
| promotions                | mama_id             | mamas              | id                  |
| regles_alertes            | mama_id             | mamas              | id                  |
| regles_alertes            | produit_id          | produits           | id                  |
| requisition_lignes        | mama_id             | mamas              | id                  |
| requisition_lignes        | produit_id          | produits           | id                  |
| requisition_lignes        | requisition_id      | requisitions       | id                  |
| requisitions              | auteur_id           | users              | id                  |
| requisitions              | mama_id             | mamas              | id                  |
| requisitions              | produit_id          | produits           | id                  |
| requisitions              | utilisateur_id      | utilisateurs       | id                  |
| requisitions              | zone_id             | zones_stock        | id                  |
| roles                     | mama_id             | mamas              | id                  |
| signalements              | created_by          | utilisateurs       | id                  |
| signalements              | mama_id             | mamas              | id                  |
| stock_mouvements          | auteur_id           | utilisateurs       | id                  |
| stock_mouvements          | inventaire_id       | inventaires        | id                  |
| stock_mouvements          | mama_id             | mamas              | id                  |
| stock_mouvements          | produit_id          | produits           | id                  |
| stock_mouvements          | zone_destination_id | zones_stock        | id                  |
| stock_mouvements          | zone_id             | zones_stock        | id                  |
| stock_mouvements          | zone_source_id      | zones_stock        | id                  |
| stocks                    | mama_id             | mamas              | id                  |
| stocks                    | produit_id          | produits           | id                  |
| stocks                    | zone_id             | zones_stock        | id                  |
| tableaux_de_bord          | mama_id             | mamas              | id                  |
| tableaux_de_bord          | utilisateur_id      | utilisateurs       | id                  |
| tache_assignations        | mama_id             | mamas              | id                  |
| tache_assignations        | tache_id            | taches             | id                  |
| tache_assignations        | utilisateur_id      | utilisateurs       | id                  |
| tache_instances           | done_by             | users              | id                  |
| tache_instances           | mama_id             | mamas              | id                  |
| tache_instances           | tache_id            | taches             | id                  |
| taches                    | created_by          | users              | id                  |
| taches                    | mama_id             | mamas              | id                  |
| taches                    | utilisateur_id      | utilisateurs       | id                  |
| tooltips                  | mama_id             | mamas              | id                  |
| transfert_lignes          | produit_id          | produits           | id                  |
| transfert_lignes          | transfert_id        | transferts         | id                  |
| transferts                | created_by          | users              | id                  |
| transferts                | mama_id             | mamas              | id                  |
| transferts                | produit_id          | produits           | id                  |
| transferts                | utilisateur_id      | utilisateurs       | id                  |
| transferts                | zone_dest_id        | zones_stock        | id                  |
| transferts                | zone_source_id      | zones_stock        | id                  |
| unites                    | mama_id             | mamas              | id                  |
| unites_equivalentes       | mama_id             | mamas              | id                  |
| unites_equivalentes       | unite_dst           | unites             | id                  |
| unites_equivalentes       | unite_src           | unites             | id                  |
| usage_stats               | mama_id             | mamas              | id                  |
| usage_stats               | user_id             | utilisateurs       | id                  |
| utilisateurs              | mama_id             | mamas              | id                  |
| utilisateurs              | role_id             | roles              | id                  |
| validation_requests       | mama_id             | mamas              | id                  |
| validation_requests       | user_id             | utilisateurs       | id                  |
| ventes_boissons           | boisson_id          | produits           | id                  |
| ventes_boissons           | created_by          | users              | id                  |
| ventes_boissons           | mama_id             | mamas              | id                  |
| ventes_fiches_carte       | fiche_id            | fiches             | id                  |
| ventes_fiches_carte       | mama_id             | mamas              | id                  |
| zones_stock               | mama_id             | mamas              | id                  |


SELECT
    t.relname AS table_name,
    i.relname AS index_name,
    array_to_string(array_agg(a.attname), ', ') AS column_names,
    ix.indisunique AS is_unique,
    ix.indisprimary AS is_primary
FROM
    pg_class t,
    pg_class i,
    pg_index ix,
    pg_attribute a
WHERE
    t.oid = ix.indrelid
    AND i.oid = ix.indexrelid
    AND a.attrelid = t.oid
    AND a.attnum = ANY(ix.indkey)
    AND t.relkind = 'r'
    AND t.relnamespace = (SELECT oid FROM pg_namespace WHERE nspname = 'public')
GROUP BY t.relname, i.relname, ix.indisunique, ix.indisprimary
ORDER BY t.relname, i.relname;


| table_name                | index_name                                          | column_names                                  | is_unique | is_primary |
| ------------------------- | --------------------------------------------------- | --------------------------------------------- | --------- | ---------- |
| access_rights             | access_rights_pkey                                  | id                                            | true      | true       |
| access_rights             | idx_access_rights_mama_id                           | mama_id                                       | false     | false      |
| access_rights             | idx_access_rights_mama_role_module                  | module, mama_id, role_id                      | false     | false      |
| access_rights             | uniq_access_rights_mama_role_module                 | module, role_id, mama_id                      | true      | false      |
| achats                    | achats_pkey                                         | id                                            | true      | true       |
| achats                    | idx_achats_date                                     | date_achat                                    | false     | false      |
| achats                    | idx_achats_mama_id                                  | mama_id                                       | false     | false      |
| api_keys                  | api_keys_pkey                                       | id                                            | true      | true       |
| api_keys                  | idx_api_keys_mama_id                                | mama_id                                       | false     | false      |
| auth_double_facteur       | auth_double_facteur_pkey                            | id                                            | true      | true       |
| bons_livraison            | bons_livraison_pkey                                 | id                                            | true      | true       |
| bons_livraison            | idx_bons_livraison_date_reception                   | date_reception                                | false     | false      |
| bons_livraison            | idx_bons_livraison_fournisseur_id                   | fournisseur_id                                | false     | false      |
| bons_livraison            | idx_bons_livraison_mama_id                          | mama_id                                       | false     | false      |
| bons_livraison            | idx_bons_livraison_statut                           | statut                                        | false     | false      |
| catalogue_updates         | catalogue_updates_pkey                              | id                                            | true      | true       |
| catalogue_updates         | idx_catalogue_updates_mama_id                       | mama_id                                       | false     | false      |
| centres_de_cout           | centres_de_cout_pkey                                | id                                            | true      | true       |
| centres_de_cout           | idx_centres_de_cout_created_at                      | created_at                                    | false     | false      |
| centres_de_cout           | idx_centres_de_cout_mama_id                         | mama_id                                       | false     | false      |
| commande_lignes           | commande_lignes_pkey                                | id                                            | true      | true       |
| commande_lignes           | idx_commande_lignes_commande_id                     | commande_id                                   | false     | false      |
| commande_lignes           | idx_commande_lignes_mama_id                         | mama_id                                       | false     | false      |
| commandes                 | commandes_pkey                                      | id                                            | true      | true       |
| commandes                 | idx_commandes_date_commande                         | date_commande                                 | false     | false      |
| commandes                 | idx_commandes_fournisseur_id                        | fournisseur_id                                | false     | false      |
| commandes                 | idx_commandes_mama_id                               | mama_id                                       | false     | false      |
| commandes                 | idx_commandes_statut                                | statut                                        | false     | false      |
| compta_mapping            | compta_mapping_pkey                                 | id                                            | true      | true       |
| compta_mapping            | idx_compta_mapping_mama_id                          | mama_id                                       | false     | false      |
| consentements_utilisateur | consentements_utilisateur_pkey                      | id                                            | true      | true       |
| consentements_utilisateur | idx_consentements_utilisateur_mama                  | mama_id                                       | false     | false      |
| consentements_utilisateur | idx_consentements_utilisateur_mama_id               | mama_id                                       | false     | false      |
| consentements_utilisateur | idx_consentements_utilisateur_user                  | user_id                                       | false     | false      |
| documentation             | documentation_pkey                                  | id                                            | true      | true       |
| documentation             | idx_documentation_mama_id                           | mama_id                                       | false     | false      |
| documents                 | documents_pkey                                      | id                                            | true      | true       |
| documents                 | idx_documents_mama_id                               | mama_id                                       | false     | false      |
| etapes_onboarding         | etapes_onboarding_pkey                              | id                                            | true      | true       |
| etapes_onboarding         | idx_etapes_onboarding_mama_id                       | mama_id                                       | false     | false      |
| facture_lignes            | facture_lignes_pkey                                 | id                                            | true      | true       |
| facture_lignes            | idx_facture_lignes_mama_id                          | mama_id                                       | false     | false      |
| factures                  | factures_pkey                                       | id                                            | true      | true       |
| factures                  | idx_factures_created_at                             | created_at                                    | false     | false      |
| factures                  | idx_factures_fournisseur_id                         | fournisseur_id                                | false     | false      |
| factures                  | idx_factures_mama_id                                | mama_id                                       | false     | false      |
| factures                  | uniq_factures_numero                                | date_facture, mama_id, fournisseur_id, numero | true      | false      |
| familles                  | familles_pkey                                       | id                                            | true      | true       |
| familles                  | idx_familles_actif                                  | actif                                         | false     | false      |
| familles                  | idx_familles_mama_id                                | mama_id                                       | false     | false      |
| familles                  | uniq_familles_nom                                   | nom, mama_id                                  | true      | false      |
| feedback                  | feedback_pkey                                       | id                                            | true      | true       |
| feedback                  | idx_feedback_mama_id                                | mama_id                                       | false     | false      |
| fiche_cout_history        | fiche_cout_history_pkey                             | id                                            | true      | true       |
| fiche_cout_history        | idx_fiche_cout_history_mama_id                      | mama_id                                       | false     | false      |
| fiche_lignes              | fiche_lignes_pkey                                   | id                                            | true      | true       |
| fiche_lignes              | idx_fiche_lignes_mama_id                            | mama_id                                       | false     | false      |
| fiche_lignes              | idx_fiche_lignes_produit_id                         | produit_id                                    | false     | false      |
| fiche_lignes              | idx_fiche_lignes_sous_fiche_id                      | sous_fiche_id                                 | false     | false      |
| fiche_prix_history        | fiche_prix_history_pkey                             | id                                            | true      | true       |
| fiche_prix_history        | idx_fiche_prix_history_mama_id                      | mama_id                                       | false     | false      |
| fiches                    | fiches_pkey                                         | id                                            | true      | true       |
| fiches                    | idx_fiches_created_at                               | created_at                                    | false     | false      |
| fiches                    | idx_fiches_mama_id                                  | mama_id                                       | false     | false      |
| fiches_techniques         | fiches_techniques_pkey                              | id                                            | true      | true       |
| fiches_techniques         | idx_fiches_techniques_carte_actuelle                | carte_actuelle                                | false     | false      |
| fiches_techniques         | idx_fiches_techniques_mama_id                       | mama_id                                       | false     | false      |
| fournisseur_contacts      | fournisseur_contacts_pkey                           | id                                            | true      | true       |
| fournisseur_contacts      | idx_fournisseur_contacts_mama_id                    | mama_id                                       | false     | false      |
| fournisseur_notes         | fournisseur_notes_pkey                              | id                                            | true      | true       |
| fournisseur_notes         | idx_fournisseur_notes_mama_id                       | mama_id                                       | false     | false      |
| fournisseur_produits      | fournisseur_produits_pkey                           | id                                            | true      | true       |
| fournisseur_produits      | idx_fournisseur_produits_mama_id                    | mama_id                                       | false     | false      |
| fournisseur_produits      | idx_fp_date                                         | date_livraison                                | false     | false      |
| fournisseur_produits      | idx_fp_fournisseur                                  | fournisseur_id                                | false     | false      |
| fournisseur_produits      | idx_fp_produit                                      | produit_id                                    | false     | false      |
| fournisseur_produits      | uniq_fournisseur_produits                           | fournisseur_id, produit_id, date_livraison    | true      | false      |
| fournisseurs              | fournisseurs_pkey                                   | id                                            | true      | true       |
| fournisseurs              | idx_fournisseurs_created_at                         | created_at                                    | false     | false      |
| fournisseurs              | idx_fournisseurs_mama_id                            | mama_id                                       | false     | false      |
| fournisseurs_api_config   | fournisseurs_api_config_pkey                        | mama_id, fournisseur_id                       | true      | true       |
| fournisseurs_api_config   | idx_fournisseurs_api_config_fournisseur_id          | fournisseur_id                                | false     | false      |
| fournisseurs_api_config   | idx_fournisseurs_api_config_mama_id                 | mama_id                                       | false     | false      |
| gadgets                   | gadgets_pkey                                        | id                                            | true      | true       |
| gadgets                   | idx_gadgets_actif                                   | actif                                         | false     | false      |
| gadgets                   | idx_gadgets_mama_id                                 | mama_id                                       | false     | false      |
| guides_seen               | guides_seen_pkey                                    | user_id, module                               | true      | true       |
| guides_seen               | idx_guides_seen_mama_id                             | mama_id                                       | false     | false      |
| help_articles             | help_articles_pkey                                  | id                                            | true      | true       |
| inventaire_lignes         | idx_inventaire_lignes_inventaire_id                 | inventaire_id                                 | false     | false      |
| inventaire_lignes         | idx_inventaire_lignes_mama_id                       | mama_id                                       | false     | false      |
| inventaire_lignes         | inventaire_lignes_pkey                              | id                                            | true      | true       |
| inventaire_zones          | idx_inventaire_zones_mama_id                        | mama_id                                       | false     | false      |
| inventaire_zones          | inventaire_zones_pkey                               | id                                            | true      | true       |
| inventaires               | idx_inventaires_created_at                          | created_at                                    | false     | false      |
| inventaires               | idx_inventaires_date_debut                          | date_debut                                    | false     | false      |
| inventaires               | idx_inventaires_date_inventaire                     | date_inventaire                               | false     | false      |
| inventaires               | idx_inventaires_mama_id                             | mama_id                                       | false     | false      |
| inventaires               | inventaires_pkey                                    | id                                            | true      | true       |
| journal_audit             | idx_journal_audit_mama                              | mama_id                                       | false     | false      |
| journal_audit             | idx_journal_audit_mama_id                           | mama_id                                       | false     | false      |
| journal_audit             | journal_audit_pkey                                  | id                                            | true      | true       |
| journaux_utilisateur      | idx_journaux_utilisateur_mama                       | mama_id                                       | false     | false      |
| journaux_utilisateur      | idx_journaux_utilisateur_mama_id                    | mama_id                                       | false     | false      |
| journaux_utilisateur      | journaux_utilisateur_pkey                           | id                                            | true      | true       |
| lignes_bl                 | idx_lignes_bl_bl_id                                 | bl_id                                         | false     | false      |
| lignes_bl                 | idx_lignes_bl_mama_id                               | mama_id                                       | false     | false      |
| lignes_bl                 | lignes_bl_pkey                                      | id                                            | true      | true       |
| logs_securite             | idx_logs_securite_mama                              | mama_id                                       | false     | false      |
| logs_securite             | idx_logs_securite_mama_id                           | mama_id                                       | false     | false      |
| logs_securite             | logs_securite_pkey                                  | id                                            | true      | true       |
| mamas                     | mamas_pkey                                          | id                                            | true      | true       |
| menu_fiches               | idx_menu_fiches_fiche_id                            | fiche_id                                      | false     | false      |
| menu_fiches               | idx_menu_fiches_mama_id                             | mama_id                                       | false     | false      |
| menu_fiches               | menu_fiches_pkey                                    | id                                            | true      | true       |
| menus                     | idx_menus_mama_id                                   | mama_id                                       | false     | false      |
| menus                     | menus_pkey                                          | id                                            | true      | true       |
| menus_jour                | idx_menus_jour_mama_id                              | mama_id                                       | false     | false      |
| menus_jour                | menus_jour_pkey                                     | id                                            | true      | true       |
| menus_jour_fiches         | idx_menus_jour_fiches_fiche_id                      | fiche_id                                      | false     | false      |
| menus_jour_fiches         | idx_menus_jour_fiches_mama_id                       | mama_id                                       | false     | false      |
| menus_jour_fiches         | idx_menus_jour_fiches_menu_id                       | menu_jour_id                                  | false     | false      |
| menus_jour_fiches         | menus_jour_fiches_pkey                              | id                                            | true      | true       |
| mouvements_centres_cout   | idx_mouvements_centres_cout_mama_id                 | mama_id                                       | false     | false      |
| mouvements_centres_cout   | mouvements_centres_cout_pkey                        | id                                            | true      | true       |
| notification_preferences  | notification_preferences_pkey                       | id                                            | true      | true       |
| notification_preferences  | uniq_notif_prefs_user                               | mama_id, utilisateur_id                       | true      | false      |
| notifications             | idx_notifications_mama_id                           | mama_id                                       | false     | false      |
| notifications             | idx_notifications_user                              | utilisateur_id                                | false     | false      |
| notifications             | notifications_pkey                                  | id                                            | true      | true       |
| parametres                | idx_parametres_mama_id                              | mama_id                                       | false     | false      |
| parametres                | parametres_pkey                                     | id                                            | true      | true       |
| permissions               | idx_permissions_mama_id                             | mama_id                                       | false     | false      |
| permissions               | permissions_pkey                                    | id                                            | true      | true       |
| pertes                    | idx_pertes_mama_id                                  | mama_id                                       | false     | false      |
| pertes                    | pertes_pkey                                         | id                                            | true      | true       |
| planning_previsionnel     | idx_planning_previsionnel_mama_id                   | mama_id                                       | false     | false      |
| planning_previsionnel     | planning_previsionnel_pkey                          | id                                            | true      | true       |
| produits                  | idx_produits_created_at                             | created_at                                    | false     | false      |
| produits                  | idx_produits_famille_id                             | famille_id                                    | false     | false      |
| produits                  | idx_produits_fiche_technique_id                     | fiche_technique_id                            | false     | false      |
| produits                  | idx_produits_fournisseur_principal                          | fournisseur_principal_id                              | false     | false |      |
| produits                  | idx_produits_mama_id                                | mama_id                                       | false     | false      |
| produits                  | idx_produits_unite_id                               | unite_id                                      | false     | false      |
| produits                  | produits_pkey                                       | id                                            | true      | true       |
| promotion_produits        | idx_promotion_produits_mama_id                      | mama_id                                       | false     | false      |
| promotion_produits        | promotion_produits_pkey                             | id                                            | true      | true       |
| promotions                | idx_promotions_created_at                           | created_at                                    | false     | false      |
| promotions                | idx_promotions_mama_id                              | mama_id                                       | false     | false      |
| promotions                | promotions_pkey                                     | id                                            | true      | true       |
| regles_alertes            | idx_regles_alertes_mama_id                          | mama_id                                       | false     | false      |
| regles_alertes            | regles_alertes_pkey                                 | id                                            | true      | true       |
| requisition_lignes        | idx_requisition_lignes_mama_id                      | mama_id                                       | false     | false      |
| requisition_lignes        | idx_requisition_lignes_requisition_id               | requisition_id                                | false     | false      |
| requisition_lignes        | requisition_lignes_pkey                             | id                                            | true      | true       |
| requisitions              | idx_requisitions_mama_id                            | mama_id                                       | false     | false      |
| requisitions              | requisitions_pkey                                   | id                                            | true      | true       |
| roles                     | idx_roles_mama_id                                   | mama_id                                       | false     | false      |
| roles                     | roles_pkey                                          | id                                            | true      | true       |
| signalements              | idx_signalements_mama_id                            | mama_id                                       | false     | false      |
| signalements              | signalements_pkey                                   | id                                            | true      | true       |
| stock_mouvements          | idx_stock_mouvements_created_at                     | created_at                                    | false     | false      |
| stock_mouvements          | idx_stock_mouvements_date                           | date                                          | false     | false      |
| stock_mouvements          | idx_stock_mouvements_mama_id                        | mama_id                                       | false     | false      |
| stock_mouvements          | idx_stock_mouvements_produit                        | produit_id                                    | false     | false      |
| stock_mouvements          | stock_mouvements_pkey                               | id                                            | true      | true       |
| stocks                    | idx_stocks_mama_id                                  | mama_id                                       | false     | false      |
| stocks                    | stocks_pkey                                         | id                                            | true      | true       |
| tableaux_de_bord          | idx_tableaux_de_bord_mama_id                        | mama_id                                       | false     | false      |
| tableaux_de_bord          | tableaux_de_bord_pkey                               | id                                            | true      | true       |
| tableaux_de_bord          | uniq_tableaux_de_bord_user                          | mama_id, utilisateur_id                       | true      | false      |
| tache_assignations        | idx_tache_assignations_mama_id                      | mama_id                                       | false     | false      |
| tache_assignations        | idx_tache_assignations_tache_id                     | tache_id                                      | false     | false      |
| tache_assignations        | tache_assignations_pkey                             | id                                            | true      | true       |
| tache_instances           | idx_tache_instances_mama_id                         | mama_id                                       | false     | false      |
| tache_instances           | tache_instances_pkey                                | id                                            | true      | true       |
| taches                    | idx_taches_created_at                               | created_at                                    | false     | false      |
| taches                    | idx_taches_mama_id                                  | mama_id                                       | false     | false      |
| taches                    | idx_taches_utilisateur_id                           | utilisateur_id                                | false     | false      |
| taches                    | taches_pkey                                         | id                                            | true      | true       |
| tooltips                  | idx_tooltips_mama_id                                | mama_id                                       | false     | false      |
| tooltips                  | tooltips_pkey                                       | id                                            | true      | true       |
| transfert_lignes          | idx_transfert_lignes_produit_id                     | produit_id                                    | false     | false      |
| transfert_lignes          | idx_transfert_lignes_transfert_id                   | transfert_id                                  | false     | false      |
| transfert_lignes          | transfert_lignes_pkey                               | id                                            | true      | true       |
| transferts                | idx_transferts_mama_id                              | mama_id                                       | false     | false      |
| transferts                | transferts_pkey                                     | id                                            | true      | true       |
| unites                    | idx_unites_actif                                    | actif                                         | false     | false      |
| unites                    | idx_unites_mama_id                                  | mama_id                                       | false     | false      |
| unites                    | uniq_unites_nom                                     | mama_id, nom                                  | true      | false      |
| unites                    | unites_pkey                                         | id                                            | true      | true       |
| unites_equivalentes       | idx_unites_equiv_mama_id                            | mama_id                                       | false     | false      |
| unites_equivalentes       | unites_equivalentes_mama_id_unite_src_unite_dst_key | unite_dst, unite_src, mama_id                 | true      | false      |
| unites_equivalentes       | unites_equivalentes_pkey                            | id                                            | true      | true       |
| usage_stats               | idx_usage_stats_mama_id                             | mama_id                                       | false     | false      |
| usage_stats               | usage_stats_pkey                                    | id                                            | true      | true       |
| users                     | users_pkey                                          | id                                            | true      | true       |
| utilisateurs              | idx_utilisateurs_auth_id                            | auth_id                                       | false     | false      |
| utilisateurs              | idx_utilisateurs_email                              | email                                         | false     | false      |
| utilisateurs              | idx_utilisateurs_mama_id                            | mama_id                                       | false     | false      |
| utilisateurs              | utilisateurs_pkey                                   | id                                            | true      | true       |
| validation_requests       | idx_validation_requests_actif                       | actif                                         | false     | false      |
| validation_requests       | idx_validation_requests_mama_id                     | mama_id                                       | false     | false      |
| validation_requests       | idx_validation_requests_updated                     | updated_at                                    | false     | false      |
| validation_requests       | validation_requests_pkey                            | id                                            | true      | true       |
| ventes_boissons           | idx_ventes_boissons_mama_id                         | mama_id                                       | false     | false      |
| ventes_boissons           | ventes_boissons_pkey                                | id                                            | true      | true       |
| ventes_fiches_carte       | idx_ventes_fiches_carte_mama_id                     | mama_id                                       | false     | false      |
| ventes_fiches_carte       | idx_ventes_fiches_carte_periode                     | periode                                       | false     | false      |
| ventes_fiches_carte       | ventes_fiches_carte_pkey                            | id                                            | true      | true       |
| zones_stock               | idx_zones_stock_mama_id                             | mama_id                                       | false     | false      |
| zones_stock               | idx_zones_stock_nom                                 | nom                                           | false     | false      |
| zones_stock               | zones_stock_pkey                                    | id                                            | true      | true       |


SELECT
    table_name AS view_name,
    view_definition
FROM
    information_schema.views
WHERE
    table_schema = 'public'
ORDER BY table_name;



| view_name                                | view_definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ---------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| utilisateurs_complets                    |  SELECT u.id,
    u.nom,
    u.mama_id,
    u.created_at,
    u.updated_at,
    u.actif,
    r.nom AS role
   FROM (utilisateurs u
     LEFT JOIN roles r ON ((u.role_id = r.id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| v_analytique_stock                       |  SELECT m.date,
    m.produit_id,
    fam.nom AS famille,
    cc.activite,
    mc.centre_cout_id AS cost_center_id,
    cc.nom AS cost_center_nom,
    m.quantite,
    mc.valeur,
    m.mama_id
   FROM ((((stock_mouvements m
     LEFT JOIN produits p ON ((p.id = m.produit_id)))
     LEFT JOIN familles fam ON (((fam.id = p.famille_id) AND (fam.mama_id = p.mama_id))))
     LEFT JOIN mouvements_centres_cout mc ON ((mc.mouvement_id = m.id)))
     LEFT JOIN centres_de_cout cc ON ((cc.id = mc.centre_cout_id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| v_besoins_previsionnels                  |  SELECT m.mama_id,
    m.id AS menu_id,
    fl.produit_id,
    sum((fl.quantite * COALESCE(f.portions, (1)::numeric))) AS quantite,
    sum(((fl.quantite * COALESCE(f.portions, (1)::numeric)) * COALESCE(p.pmp, (0)::numeric))) AS valeur
   FROM ((((menus m
     JOIN menu_fiches mf ON ((mf.menu_id = m.id)))
     JOIN fiches f ON ((f.id = mf.fiche_id)))
     JOIN fiche_lignes fl ON ((fl.fiche_id = f.id)))
     LEFT JOIN produits p ON ((p.id = fl.produit_id)))
  GROUP BY m.mama_id, m.id, fl.produit_id;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| v_boissons                               |  SELECT p.id,
    p.nom,
    p.prix_vente,
    p.created_at,
    p.mama_id,
    COALESCE(ft.famille, fam.nom) AS famille,
    u.nom AS unite,
    p.fiche_technique_id AS fiche_id,
        CASE
            WHEN (p.fiche_technique_id IS NOT NULL) THEN ft.cout_par_portion
            ELSE p.pmp
        END AS cout_portion
   FROM (((produits p
     LEFT JOIN familles fam ON ((fam.id = p.famille_id)))
     LEFT JOIN unites u ON ((u.id = p.unite_id)))
     LEFT JOIN fiches_techniques ft ON ((ft.id = p.fiche_technique_id)))
  WHERE ((p.actif = true) AND (COALESCE(ft.famille, fam.nom) ~~* '%boisson%'::text));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| v_cost_center_month                      |  SELECT NULL::uuid AS mama_id,
    NULL::uuid AS cost_center_id,
    NULL::text AS nom,
    NULL::text AS mois,
    NULL::numeric AS total;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| v_cost_center_monthly                    |  SELECT mc.mama_id,
    cc.nom,
    to_char(date_trunc('month'::text, mc.created_at), 'YYYY-MM'::text) AS mois,
    sum(COALESCE(mc.valeur, (0)::numeric)) AS montant
   FROM (mouvements_centres_cout mc
     JOIN centres_de_cout cc ON ((cc.id = mc.centre_cout_id)))
  WHERE ((mc.actif = true) AND (cc.actif = true) AND (mc.mama_id = current_user_mama_id()))
  GROUP BY mc.mama_id, cc.nom, (to_char(date_trunc('month'::text, mc.created_at), 'YYYY-MM'::text));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| v_ecarts_inventaire                      |  SELECT i.mama_id,
    l.produit_id,
    i.date_inventaire AS date,
    l.zone_id AS zone,
    l.quantite_theorique AS stock_theorique,
    l.quantite_reelle AS stock_reel,
    (l.quantite_reelle - l.quantite_theorique) AS ecart,
    l.motif
   FROM (inventaires i
     JOIN inventaire_lignes l ON ((l.inventaire_id = i.id)))
  WHERE ((i.actif = true) AND (l.actif = true));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| v_evolution_achats                       |  SELECT f.mama_id,
    fl.produit_id,
    to_char(date_trunc('month'::text, (f.date_facture)::timestamp with time zone), 'YYYY-MM'::text) AS mois,
    sum((fl.prix_unitaire * fl.quantite)) AS montant
   FROM (facture_lignes fl
     JOIN factures f ON ((f.id = fl.facture_id)))
  WHERE ((f.actif = true) AND (fl.actif = true))
  GROUP BY f.mama_id, fl.produit_id, (to_char(date_trunc('month'::text, (f.date_facture)::timestamp with time zone), 'YYYY-MM'::text));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| v_familles_orphelines                    |  SELECT f.id,
    f.nom,
    f.mama_id,
    f.actif,
    f.created_at,
    f.parent_id,
    f.populaire,
    f.updated_at
   FROM (familles f
     LEFT JOIN produits p ON (((p.famille_id = f.id) AND (p.actif = true))))
  WHERE ((p.id IS NULL) AND (f.actif = true));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| v_fournisseurs_inactifs                  |  SELECT f.mama_id,
    f.id AS fournisseur_id,
    f.nom,
    f.actif AS fournisseur_actif,
    bool_or(fc.actif) AS facture_actif,
    max(fc.date_facture) AS dernier_achat
   FROM (fournisseurs f
     LEFT JOIN factures fc ON ((fc.fournisseur_id = f.id)))
  WHERE (f.mama_id IS NOT NULL)
  GROUP BY f.mama_id, f.id, f.nom
 HAVING (COALESCE((max(fc.date_facture))::timestamp without time zone, (CURRENT_DATE - '83 years 3 mons'::interval)) < (CURRENT_DATE - '6 mons'::interval));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| v_menu_engineering                       |  SELECT f.id AS fiche_id,
    f.nom,
    f.famille,
    f.prix_vente,
    COALESCE(f.cout_par_portion, (0)::numeric) AS cout_portion,
    v.periode,
    COALESCE(v.ventes, 0) AS ventes,
    round(((COALESCE(v.ventes, 0))::numeric / (NULLIF(sum(v.ventes) OVER (PARTITION BY f.mama_id, v.periode), 0))::numeric), 4) AS popularite,
    round((((100)::numeric * (f.prix_vente - COALESCE(f.cout_par_portion, (0)::numeric))) / NULLIF(f.prix_vente, (0)::numeric)), 2) AS marge,
    f.mama_id
   FROM (fiches_techniques f
     LEFT JOIN ventes_fiches_carte v ON (((v.fiche_id = f.id) AND (v.mama_id = f.mama_id))))
  WHERE (f.actif = true);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| v_monthly_purchases                      |  SELECT f.mama_id,
    to_char(date_trunc('month'::text, (f.date_facture)::timestamp with time zone), 'YYYY-MM'::text) AS mois,
    sum((fl.quantite * fl.prix_unitaire)) AS total
   FROM (factures f
     JOIN facture_lignes fl ON ((fl.facture_id = f.id)))
  WHERE (f.mama_id = current_user_mama_id())
  GROUP BY f.mama_id, (to_char(date_trunc('month'::text, (f.date_facture)::timestamp with time zone), 'YYYY-MM'::text));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| v_mouvements_centres_cout_stats          |  SELECT c.id AS centre_cout_id,
    c.nom AS centre_cout,
    sum(m.quantite) AS total_quantite,
    sum(m.valeur) AS total_valeur
   FROM (mouvements_centres_cout m
     JOIN centres_de_cout c ON ((m.centre_cout_id = c.id)))
  WHERE ((m.actif = true) AND (c.actif = true))
  GROUP BY c.id, c.nom;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| v_notifications_non_lues                 |  SELECT notifications.utilisateur_id,
    notifications.mama_id,
    count(*) AS total_non_lues
   FROM notifications
  WHERE (notifications.lu = false)
  GROUP BY notifications.utilisateur_id, notifications.mama_id;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| v_performance_fiches                     |  WITH ventes AS (
         SELECT ventes_fiches_carte.mama_id,
            ventes_fiches_carte.fiche_id,
            sum(ventes_fiches_carte.ventes) AS volume
           FROM ventes_fiches_carte
          WHERE (ventes_fiches_carte.actif = true)
          GROUP BY ventes_fiches_carte.mama_id, ventes_fiches_carte.fiche_id
        ), totals AS (
         SELECT ventes_fiches_carte.mama_id,
            sum(ventes_fiches_carte.ventes) AS total_volume
           FROM ventes_fiches_carte
          WHERE (ventes_fiches_carte.actif = true)
          GROUP BY ventes_fiches_carte.mama_id
        )
 SELECT f.mama_id,
    f.id AS fiche_id,
    f.nom,
    COALESCE(f.cout_par_portion, NULL::numeric) AS cout,
    COALESCE(v.volume, (0)::bigint) AS volume,
        CASE
            WHEN (t.total_volume > 0) THEN ((COALESCE(v.volume, (0)::bigint))::numeric / (t.total_volume)::numeric)
            ELSE (0)::numeric
        END AS popularite
   FROM ((fiches_techniques f
     LEFT JOIN ventes v ON (((v.fiche_id = f.id) AND (v.mama_id = f.mama_id))))
     LEFT JOIN totals t ON ((t.mama_id = f.mama_id)))
  WHERE (f.actif = true); |
| v_pmp                                    |  SELECT p.mama_id,
    p.id AS produit_id,
    p.actif AS produit_actif,
    bool_or(fp.actif) AS fournisseur_produit_actif,
    COALESCE(avg(fp.prix_achat), (0)::numeric) AS pmp
   FROM (produits p
     LEFT JOIN fournisseur_produits fp ON (((fp.produit_id = p.id) AND (fp.mama_id = p.mama_id))))
  GROUP BY p.mama_id, p.id, p.actif;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| v_produits_actifs                        |  SELECT produits.id,
    produits.mama_id,
    produits.nom,
    produits.created_at,
    produits.updated_at,
    produits.actif,
    produits.famille_id,
    produits.unite_id,
    produits.code,
    produits.url_photo,
    produits.allergenes,
    produits.pmp,
    produits.stock_reel,
    produits.stock_min,
    produits.stock_theorique,
    produits.fournisseur_principal_id,
    produits.dernier_prix
   FROM produits
  WHERE (produits.actif = true);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| v_produits_dernier_prix                  |  SELECT p.id,
    p.nom,
    p.famille_id,
    f2.nom AS famille,
    p.unite_id,
    u.nom AS unite,
    p.stock_reel,
    p.stock_min,
    fp.fournisseur_id,
    f.nom AS fournisseur,
    fp.prix_achat AS dernier_prix,
    fp.date_livraison,
    p.mama_id
   FROM ((((produits p
     LEFT JOIN LATERAL ( SELECT fp2.fournisseur_id,
            fp2.prix_achat,
            fp2.date_livraison
           FROM fournisseur_produits fp2
          WHERE ((fp2.produit_id = p.id) AND (fp2.mama_id = p.mama_id))
          ORDER BY fp2.date_livraison DESC
         LIMIT 1) fp ON (true))
     LEFT JOIN fournisseurs f ON ((f.id = fp.fournisseur_id)))
     LEFT JOIN familles f2 ON ((f2.id = p.famille_id)))
     LEFT JOIN unites u ON ((u.id = p.unite_id)));                                                                                                                                                                                                                                                                                                                                                                                         |
| v_produits_inactifs                      |  SELECT produits.id,
    produits.mama_id,
    produits.nom,
    produits.created_at,
    produits.updated_at,
    produits.actif,
    produits.famille_id,
    produits.unite_id,
    produits.code,
    produits.url_photo,
    produits.allergenes,
    produits.pmp,
    produits.stock_reel,
    produits.stock_min,
    produits.stock_theorique,
    produits.fournisseur_principal_id,
    produits.dernier_prix
   FROM produits
  WHERE (produits.actif = false);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| v_reco_stockmort                         |  SELECT p.mama_id,
    p.id AS produit_id,
    p.nom,
    COALESCE(date_part('day'::text, (now() - max(sm.date))), (9999)::double precision) AS jours_inactif
   FROM (produits p
     LEFT JOIN stock_mouvements sm ON (((sm.produit_id = p.id) AND (sm.mama_id = p.mama_id) AND (sm.actif IS TRUE))))
  WHERE (p.mama_id = current_user_mama_id())
  GROUP BY p.mama_id, p.id, p.nom;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| v_reco_surcout                           |  WITH prix AS (
         SELECT fp.mama_id,
            fp.produit_id,
            fp.prix_achat,
            row_number() OVER (PARTITION BY fp.produit_id ORDER BY fp.date_livraison DESC) AS rn
           FROM fournisseur_produits fp
          WHERE ((fp.actif IS TRUE) AND (fp.mama_id = current_user_mama_id()))
        )
 SELECT p.mama_id,
    p.id AS produit_id,
    p.nom,
        CASE
            WHEN (prev.prix_achat IS NULL) THEN NULL::numeric
            ELSE round((((100)::numeric * (last.prix_achat - prev.prix_achat)) / prev.prix_achat), 2)
        END AS variation_pct
   FROM ((produits p
     JOIN prix last ON (((last.produit_id = p.id) AND (last.rn = 1))))
     LEFT JOIN prix prev ON (((prev.produit_id = p.id) AND (prev.rn = 2))))
  WHERE (p.mama_id = current_user_mama_id());                                                                                                                                                                                                                                                                                                                                         |
| v_requisition_stock                      |  SELECT rl.id AS ligne_id,
    rl.requisition_id,
    r.zone_id,
    rl.produit_id,
    rl.stock_theorique_avant AS stock_reel,
    rl.quantite_demandee,
    rl.stock_theorique_apres AS stock_apres,
    rl.mama_id
   FROM (requisition_lignes rl
     JOIN requisitions r ON ((r.id = rl.requisition_id)))
  WHERE ((rl.actif IS TRUE) AND (r.actif IS TRUE));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| v_stocks                                 |  SELECT s.mama_id,
    s.produit_id,
    sum(s.quantite) AS stock
   FROM stocks s
  WHERE (s.actif IS TRUE)
  GROUP BY s.mama_id, s.produit_id;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| v_tendance_prix_produit                  |  SELECT f.mama_id,
    fl.produit_id,
    to_char(date_trunc('month'::text, (f.date_facture)::timestamp with time zone), 'YYYY-MM'::text) AS mois,
    avg(fl.prix_unitaire) AS prix_moyen
   FROM (factures f
     JOIN facture_lignes fl ON ((fl.facture_id = f.id)))
  WHERE ((f.actif = true) AND (fl.actif = true) AND (f.mama_id = current_user_mama_id()))
  GROUP BY f.mama_id, fl.produit_id, (to_char(date_trunc('month'::text, (f.date_facture)::timestamp with time zone), 'YYYY-MM'::text));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| v_transferts_historique                  |  SELECT t.id AS transfert_id,
    t.date_transfert,
    t.zone_source_id,
    zs1.nom AS zone_source,
    t.zone_dest_id,
    zs2.nom AS zone_dest,
    l.produit_id,
    p.nom AS produit,
    l.quantite,
    COALESCE(l.commentaire, t.commentaire) AS commentaire,
    t.utilisateur_id,
    t.created_at
   FROM ((((transferts t
     JOIN transfert_lignes l ON ((l.transfert_id = t.id)))
     JOIN produits p ON ((p.id = l.produit_id)))
     LEFT JOIN zones_stock zs1 ON ((zs1.id = t.zone_source_id)))
     LEFT JOIN zones_stock zs2 ON ((zs2.id = t.zone_dest_id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| v_unites_orphelines                      |  SELECT u.id,
    u.nom,
    u.mama_id,
    u.actif,
    u.created_at,
    u.populaire,
    u.updated_at
   FROM (unites u
     LEFT JOIN produits p ON (((p.unite_id = u.id) AND (p.actif = true))))
  WHERE ((p.id IS NULL) AND (u.actif = true));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| vue_stock_disponible_par_produit_et_zone |  SELECT p.nom AS produit,
    un.nom AS unite,
    f.nom AS famille,
    zs.nom AS zone_stock,
    s.quantite,
    s.updated_at,
    s.mama_id
   FROM ((((stocks s
     JOIN produits p ON ((s.produit_id = p.id)))
     LEFT JOIN familles f ON ((p.famille_id = f.id)))
     LEFT JOIN unites un ON ((p.unite_id = un.id)))
     LEFT JOIN zones_stock zs ON ((s.zone_id = zs.id)))
  WHERE (s.actif = true);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |


  SELECT
    event_object_table AS table_name,
    trigger_name,
    action_timing AS trigger_type,
    event_manipulation AS event,
    action_statement AS trigger_function
FROM
    information_schema.triggers
WHERE
    trigger_schema = 'public'
ORDER BY event_object_table, trigger_name;


| table_name          | trigger_name                           | trigger_type | event  | trigger_function                                     |
| ------------------- | -------------------------------------- | ------------ | ------ | ---------------------------------------------------- |
| commande_lignes     | trg_commande_lignes_totals             | AFTER        | INSERT | EXECUTE FUNCTION update_commande_totals()            |
| commande_lignes     | trg_commande_lignes_totals             | AFTER        | UPDATE | EXECUTE FUNCTION update_commande_totals()            |
| commande_lignes     | trg_commande_lignes_totals             | AFTER        | DELETE | EXECUTE FUNCTION update_commande_totals()            |
| facture_lignes      | trg_facture_lignes_achats              | AFTER        | INSERT | EXECUTE FUNCTION insert_achat_from_facture_line()    |
| facture_lignes      | trg_facture_lignes_totals              | AFTER        | INSERT | EXECUTE FUNCTION update_facture_totals()             |
| facture_lignes      | trg_facture_lignes_totals              | AFTER        | UPDATE | EXECUTE FUNCTION update_facture_totals()             |
| facture_lignes      | trg_facture_lignes_totals              | AFTER        | DELETE | EXECUTE FUNCTION update_facture_totals()             |
| factures            | trg_audit_factures                     | AFTER        | INSERT | EXECUTE FUNCTION insert_journal_audit()              |
| factures            | trg_audit_factures                     | AFTER        | UPDATE | EXECUTE FUNCTION insert_journal_audit()              |
| factures            | trg_audit_factures                     | AFTER        | DELETE | EXECUTE FUNCTION insert_journal_audit()              |
| familles            | trg_famille_delete                     | BEFORE       | DELETE | EXECUTE FUNCTION prevent_famille_delete()            |
| familles            | trg_familles_updated_at                | BEFORE       | UPDATE | EXECUTE FUNCTION set_updated_at()                    |
| feedback            | trg_set_updated_at_feedback            | BEFORE       | UPDATE | EXECUTE FUNCTION set_updated_at()                    |
| produits            | trg_audit_produits                     | AFTER        | UPDATE | EXECUTE FUNCTION insert_journal_audit()              |
| produits            | trg_audit_produits                     | AFTER        | INSERT | EXECUTE FUNCTION insert_journal_audit()              |
| produits            | trg_audit_produits                     | AFTER        | DELETE | EXECUTE FUNCTION insert_journal_audit()              |
| produits            | trg_journal_produit                    | AFTER        | DELETE | EXECUTE FUNCTION journaliser_modifs_produit()        |
| produits            | trg_journal_produit                    | AFTER        | UPDATE | EXECUTE FUNCTION journaliser_modifs_produit()        |
| produits            | trg_journal_produit                    | AFTER        | INSERT | EXECUTE FUNCTION journaliser_modifs_produit()        |
| requisition_lignes  | trg_requisition_lignes_stock           | BEFORE       | INSERT | EXECUTE FUNCTION set_requisition_stock_theorique()   |
| taches              | trg_set_updated_at_taches              | BEFORE       | UPDATE | EXECUTE FUNCTION set_updated_at()                    |
| transfert_lignes    | trg_transfert_lignes_stock             | AFTER        | INSERT | EXECUTE FUNCTION insert_stock_from_transfert_ligne() |
| unites              | trg_unite_delete                       | BEFORE       | DELETE | EXECUTE FUNCTION prevent_unite_delete()              |
| unites              | trg_unites_updated_at                  | BEFORE       | UPDATE | EXECUTE FUNCTION set_updated_at()                    |
| ventes_fiches_carte | trg_set_updated_at_ventes_fiches_carte | BEFORE       | UPDATE | EXECUTE FUNCTION set_updated_at()                    |


SELECT
    routine_name,
    routine_type,
    data_type,
    routine_definition
FROM
    information_schema.routines
WHERE
    specific_schema = 'public'
ORDER BY routine_name;


| routine_name                      | routine_type | data_type | routine_definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| --------------------------------- | ------------ | --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| advanced_stats                    | FUNCTION     | record    | 
  select to_char(date_trunc('month', f.date_facture), 'YYYY-MM') as month,
         sum(fl.quantite * fl.prix_unitaire) as purchases
  from factures f
  join facture_lignes fl on fl.facture_id = f.id
  where f.mama_id = current_user_mama_id()
    and (start_date is null or f.date_facture >= start_date)
    and (end_date is null or f.date_facture <= end_date)
  group by month
  order by month;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| apply_stock_from_achat            | FUNCTION     | void      | 
declare
  r record;
begin
  if achat_table = 'factures' then
    for r in
      select fl.produit_id, fl.quantite
      from facture_lignes fl
      join factures f on f.id = fl.facture_id
      where f.id = achat_id and f.mama_id = mama_id and fl.actif is true
    loop
      insert into stock_mouvements(mama_id, date, type, quantite, produit_id)
      values (mama_id, now(), 'entree_achat', r.quantite, r.produit_id);
    end loop;
  elsif achat_table = 'bons_livraison' then
    for r in
      select l.produit_id, l.quantite_recue as quantite
      from lignes_bl l
      join bons_livraison b on b.id = l.bl_id
      where b.id = achat_id and b.mama_id = mama_id
    loop
      insert into stock_mouvements(mama_id, date, type, quantite, produit_id)
      values (mama_id, now(), 'entree_achat', r.quantite, r.produit_id);
    end loop;
  end if;
end;
                                       |
| calcul_ecarts_inventaire          | FUNCTION     | jsonb     | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| compare_fiche                     | FUNCTION     | jsonb     | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| consolidated_stats                | FUNCTION     | jsonb     | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| current_user_mama_id              | FUNCTION     | uuid      | 
  SELECT mama_id FROM utilisateurs WHERE id = auth.uid() LIMIT 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| dashboard_stats                   | FUNCTION     | record    | 
begin
  return query
  select p.id, p.nom, p.stock_reel,
         coalesce(vp.pmp,0) as pmp,
         (select max(f.date_facture)
            from factures f
            join facture_lignes fl on fl.facture_id = f.id and fl.produit_id = p.id
           where f.mama_id = mama_id_param) as last_purchase
  from produits p
  left join v_pmp vp on vp.produit_id = p.id and vp.mama_id = mama_id_param
  where p.mama_id = mama_id_param
  order by p.nom
  limit page_size_param offset (page_param-1)*page_size_param;
end;
                                                                                                                                                                                                                                                                                                                                                                                                         |
| disable_two_fa                    | FUNCTION     | void      | 
BEGIN
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| enable_two_fa                     | FUNCTION     | void      | 
BEGIN
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| fn_calc_budgets                   | FUNCTION     | record    | 
declare
  d1 date := to_date(periode_param || '-01', 'YYYY-MM-DD');
  d2 date := (d1 + interval '1 month');
begin
  return query
  select f2.nom as famille,
         0::numeric as budget,
         sum(fl.prix_unitaire * fl.quantite) as reel,
         null::numeric as ecart_pct
  from factures f
  join facture_lignes fl on fl.facture_id = f.id
  join produits p on p.id = fl.produit_id
  left join familles f2 on f2.id = p.famille_id
  where f.mama_id = mama_id_param
    and f.date_facture >= d1
    and f.date_facture < d2
    and f.actif is true
    and fl.actif is true
  group by f2.nom;
end;
                                                                                                                                                                                                                                                                                                                |
| import_invoice                    | FUNCTION     | uuid      | 
DECLARE
  fac_id uuid;
  supp_id uuid;
BEGIN
  SELECT id INTO supp_id
    FROM fournisseurs
   WHERE nom = payload->>'fournisseur_nom'
     AND mama_id = current_user_mama_id()
   LIMIT 1;

  INSERT INTO factures(reference, date_facture, fournisseur_id, montant, statut, mama_id)
    VALUES (
      payload->>'reference',
      (payload->>'date')::date,
      supp_id,
      (payload->>'total')::numeric,
      'en attente',
      current_user_mama_id()
    )
    RETURNING id INTO fac_id;

  INSERT INTO facture_lignes(facture_id, produit_id, quantite, prix, mama_id)
  SELECT fac_id,
         p.id,
         (l->>'quantity')::numeric,
         (l->>'unit_price')::numeric,
         current_user_mama_id()
    FROM jsonb_array_elements(payload->'lines') AS l
    LEFT JOIN produits p
      ON p.code = l->>'product_code'
     AND p.mama_id = current_user_mama_id();

  RETURN fac_id;
END;
 |
| insert_achat_from_facture_line    | FUNCTION     | trigger   | 
begin
  if tg_op = 'INSERT' then
    insert into achats(mama_id, produit_id, fournisseur_id, prix, quantite, date_achat)
    values(new.mama_id, new.produit_id,
           (select fournisseur_id from factures where id = new.facture_id),
           new.prix_unitaire, new.quantite,
           (select date_facture from factures where id = new.facture_id));
  end if;
  return new;
end;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| insert_journal_audit              | FUNCTION     | trigger   | 
BEGIN
  INSERT INTO journal_audit(
    table_modifiee,
    operation,
    utilisateur_id,
    mama_id,
    date_action,
    donnees_avant,
    donnees_apres
  ) VALUES (
    TG_TABLE_NAME,
    TG_OP,
    auth.uid(),
    coalesce(new.mama_id, old.mama_id),
    now(),
    row_to_json(old),
    row_to_json(new)
  );
  IF TG_OP = 'DELETE' THEN
    RETURN old;
  ELSE
    RETURN new;
  END IF;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| insert_stock_from_transfert_ligne | FUNCTION     | trigger   | 
declare
  tr record;
  com text;
begin
  select * into tr from transferts where id = new.transfert_id;
  com := coalesce(new.commentaire, tr.commentaire);

  -- Sortie du stock dans la zone source
  insert into stock_mouvements(mama_id, produit_id, quantite, type, date, zone_id, auteur_id, commentaire)
    values(tr.mama_id, new.produit_id, -new.quantite, 'transfert', tr.date_transfert, tr.zone_source_id, tr.utilisateur_id, com);

  -- Entrée du stock dans la zone destination
  insert into stock_mouvements(mama_id, produit_id, quantite, type, date, zone_id, auteur_id, commentaire)
    values(tr.mama_id, new.produit_id, new.quantite, 'transfert', tr.date_transfert, tr.zone_dest_id, tr.utilisateur_id, com);

  return new;
end;
                                                                                                                                                                           |
| journaliser_modifs_produit        | FUNCTION     | trigger   | 
BEGIN
  -- TODO: stub pour log des modifications
  RETURN NEW;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| maj_stock_produit                 | FUNCTION     | void      | 
BEGIN
  -- TODO: implémentation future
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| mettre_a_jour_pmp_produit         | FUNCTION     | void      | 
BEGIN
  -- TODO: implémentation future
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| mouvements_without_alloc          | FUNCTION     | record    | 
  select sm.id, sm.produit_id, sm.quantite, sm.mama_id, sm.date
  from stock_mouvements sm
  left join mouvements_centres_cout mc on mc.mouvement_id = sm.id
  where mc.id is null
  order by sm.date desc
  limit limit_param
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| prevent_famille_delete            | FUNCTION     | trigger   | 
begin
  if exists (select 1 from produits where famille_id = old.id and actif is true) then
    raise exception 'Famille utilisée par des produits';
  end if;
  return old;
end;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| prevent_unite_delete              | FUNCTION     | trigger   | 
begin
  if exists (select 1 from produits where unite_id = old.id and actif is true) then
    raise exception 'Unité utilisée par des produits';
  end if;
  return old;
end;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| rafraichir_cout_fiche             | FUNCTION     | void      | 
BEGIN
  -- TODO: implémentation future
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| rafraichir_total_facture          | FUNCTION     | void      | 
BEGIN
  -- TODO: implémentation future
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| send_email_notification           | FUNCTION     | void      | 
BEGIN
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| send_notification_webhook         | FUNCTION     | void      | 
BEGIN
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| set_requisition_stock_theorique   | FUNCTION     | trigger   | 
declare
  current_stock numeric;
  zid uuid;
begin
  select zone_id into zid from requisitions where id = new.requisition_id;
  select quantite into current_stock from stocks
    where mama_id = new.mama_id and zone_id = zid and produit_id = new.produit_id;
  new.stock_theorique_avant := coalesce(current_stock,0);
  new.stock_theorique_apres := coalesce(current_stock,0) - coalesce(new.quantite_demandee,0);
  return new;
end;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| set_updated_at                    | FUNCTION     | trigger   | 
begin
  new.updated_at := now();
  return new;
end;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| stats_achats_fournisseur          | FUNCTION     | jsonb     | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| stats_achats_fournisseurs         | FUNCTION     | jsonb     | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| stats_cost_centers                | FUNCTION     | jsonb     | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| stats_multi_mamas                 | FUNCTION     | jsonb     | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| stats_rotation_produit            | FUNCTION     | jsonb     | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| suggest_cost_centers              | FUNCTION     | jsonb     | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| top_produits                      | FUNCTION     | record    | 
begin
  return query
  select p.id, p.nom,
         sum(sm.quantite) as total
  from stock_mouvements sm
  join produits p on p.id = sm.produit_id
  where sm.mama_id = mama_id_param
    and sm.type = 'sortie'
    and (debut_param is null or sm.date >= debut_param)
    and (fin_param is null or sm.date < fin_param + interval '1 day')
  group by p.id, p.nom
  order by total desc
  limit limit_param;
end;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| update_commande_totals            | FUNCTION     | trigger   | 
begin
  update commandes
  set montant_total = coalesce((select sum(quantite * prix_unitaire * (1 + coalesce(tva,0)/100)) from commande_lignes where commande_id = coalesce(new.commande_id, old.commande_id) and actif = true),0),
      updated_at = now()
  where id = coalesce(new.commande_id, old.commande_id);
  return new;
end;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| update_facture_totals             | FUNCTION     | trigger   | 
begin
  update factures
  set total_ht = coalesce((select sum(quantite * prix_unitaire) from facture_lignes where facture_id = coalesce(new.facture_id, old.facture_id) and actif = true),0),
      total_tva = coalesce((select sum(quantite * prix_unitaire * coalesce(tva,0)/100) from facture_lignes where facture_id = coalesce(new.facture_id, old.facture_id) and actif = true),0),
      total_ttc = coalesce((select sum(quantite * prix_unitaire * (1 + coalesce(tva,0)/100)) from facture_lignes where facture_id = coalesce(new.facture_id, old.facture_id) and actif = true),0),
      montant_total = coalesce((select sum(quantite * prix_unitaire * (1 + coalesce(tva,0)/100)) from facture_lignes where facture_id = coalesce(new.facture_id, old.facture_id) and actif = true),0)
  where id = coalesce(new.facture_id, old.facture_id);
  return new;
end;
                                                                    |




                                                                    SELECT
    extname AS extension_name
FROM
    pg_extension
ORDER BY extname;

| extension_name     |
| ------------------ |
| pg_cron            |
| pg_graphql         |
| pg_stat_statements |
| pgcrypto           |
| pgjwt              |
| plpgsql            |
| supabase_vault     |
| uuid-ossp          |


SELECT
    tc.table_name,
    tc.constraint_type,
    kcu.column_name,
    ccu.column_name AS foreign_column_name,
    ccu.table_name AS foreign_table_name
FROM
    information_schema.table_constraints AS tc
    LEFT JOIN information_schema.key_column_usage AS kcu
        ON tc.constraint_name = kcu.constraint_name
       AND tc.table_schema = kcu.table_schema
    LEFT JOIN information_schema.constraint_column_usage AS ccu
        ON ccu.constraint_name = tc.constraint_name
       AND ccu.table_schema = tc.table_schema
WHERE
    tc.table_schema = 'public'
ORDER BY tc.table_name, tc.constraint_type;


| table_name                | constraint_type | column_name         | foreign_column_name | foreign_table_name        |
| ------------------------- | --------------- | ------------------- | ------------------- | ------------------------- |
| access_rights             | CHECK           | null                | null                | null                      |
| access_rights             | CHECK           | null                | null                | null                      |
| access_rights             | CHECK           | null                | null                | null                      |
| access_rights             | CHECK           | null                | null                | null                      |
| access_rights             | CHECK           | null                | null                | null                      |
| access_rights             | CHECK           | null                | null                | null                      |
| access_rights             | FOREIGN KEY     | role_id             | id                  | roles                     |
| access_rights             | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| access_rights             | PRIMARY KEY     | id                  | id                  | access_rights             |
| achats                    | CHECK           | null                | null                | null                      |
| achats                    | FOREIGN KEY     | fournisseur_id      | id               | fournisseurs |              |
| achats                    | FOREIGN KEY     | produit_id          | id                  | produits                  |
| achats                    | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| achats                    | PRIMARY KEY     | id                  | id                  | achats                    |
| api_keys                  | CHECK           | null                | null                | null                      |
| api_keys                  | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| api_keys                  | FOREIGN KEY     | user_id             | id                  | utilisateurs              |
| api_keys                  | PRIMARY KEY     | id                  | id                  | api_keys                  |
| auth_double_facteur       | CHECK           | null                | null                | null                      |
| auth_double_facteur       | PRIMARY KEY     | id                  | id                  | auth_double_facteur       |
| bons_livraison            | CHECK           | null                | null                | null                      |
| bons_livraison            | FOREIGN KEY     | facture_id          | id                  | factures                  |
| bons_livraison            | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| bons_livraison            | FOREIGN KEY     | fournisseur_id      | id                  | fournisseurs              |
| bons_livraison            | FOREIGN KEY     | commande_id         | id                  | commandes                 |
| bons_livraison            | PRIMARY KEY     | id                  | id                  | bons_livraison            |
| catalogue_updates         | CHECK           | null                | null                | null                      |
| catalogue_updates         | FOREIGN KEY     | produit_id          | id                  | produits                  |
| catalogue_updates         | FOREIGN KEY     | fournisseur_id      | id                  | fournisseurs              |
| catalogue_updates         | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| catalogue_updates         | PRIMARY KEY     | id                  | id                  | catalogue_updates         |
| centres_de_cout           | CHECK           | null                | null                | null                      |
| centres_de_cout           | CHECK           | null                | null                | null                      |
| centres_de_cout           | CHECK           | null                | null                | null                      |
| centres_de_cout           | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| centres_de_cout           | PRIMARY KEY     | id                  | id                  | centres_de_cout           |
| commande_lignes           | CHECK           | null                | null                | null                      |
| commande_lignes           | CHECK           | null                | null                | null                      |
| commande_lignes           | CHECK           | null                | null                | null                      |
| commande_lignes           | CHECK           | null                | null                | null                      |
| commande_lignes           | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| commande_lignes           | FOREIGN KEY     | commande_id         | id                  | commandes                 |
| commande_lignes           | FOREIGN KEY     | produit_id          | id                  | produits                  |
| commande_lignes           | PRIMARY KEY     | id                  | id                  | commande_lignes           |
| commandes                 | CHECK           | null                | null                | null                      |
| commandes                 | FOREIGN KEY     | bl_id               | id                  | bons_livraison            |
| commandes                 | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| commandes                 | FOREIGN KEY     | facture_id          | id                  | factures                  |
| commandes                 | FOREIGN KEY     | fournisseur_id      | id                  | fournisseurs              |
| commandes                 | PRIMARY KEY     | id                  | id                  | commandes                 |
| compta_mapping            | CHECK           | null                | null                | null                      |
| compta_mapping            | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| compta_mapping            | PRIMARY KEY     | id                  | id                  | compta_mapping            |
| consentements_utilisateur | CHECK           | null                | null                | null                      |
| consentements_utilisateur | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| consentements_utilisateur | FOREIGN KEY     | user_id             | id                  | utilisateurs              |
| consentements_utilisateur | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| consentements_utilisateur | PRIMARY KEY     | id                  | id                  | consentements_utilisateur |
| documentation             | CHECK           | null                | null                | null                      |
| documentation             | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| documentation             | PRIMARY KEY     | id                  | id                  | documentation             |
| documents                 | CHECK           | null                | null                | null                      |
| documents                 | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| documents                 | PRIMARY KEY     | id                  | id                  | documents                 |
| etapes_onboarding         | CHECK           | null                | null                | null                      |
| etapes_onboarding         | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| etapes_onboarding         | PRIMARY KEY     | id                  | id                  | etapes_onboarding         |
| facture_lignes            | CHECK           | null                | null                | null                      |
| facture_lignes            | CHECK           | null                | null                | null                      |
| facture_lignes            | CHECK           | null                | null                | null                      |
| facture_lignes            | CHECK           | null                | null                | null                      |
| facture_lignes            | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| facture_lignes            | FOREIGN KEY     | facture_id          | id                  | factures                  |
| facture_lignes            | FOREIGN KEY     | produit_id          | id                  | produits                  |
| facture_lignes            | PRIMARY KEY     | id                  | id                  | facture_lignes            |
| factures                  | CHECK           | null                | null                | null                      |
| factures                  | CHECK           | null                | null                | null                      |
| factures                  | FOREIGN KEY     | fournisseur_id      | id                  | fournisseurs              |
| factures                  | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| factures                  | PRIMARY KEY     | id                  | id                  | factures                  |
| factures                  | UNIQUE          | mama_id             | mama_id             | factures                  |
| factures                  | UNIQUE          | mama_id             | fournisseur_id      | factures                  |
| factures                  | UNIQUE          | mama_id             | numero              | factures                  |
| factures                  | UNIQUE          | mama_id             | date_facture        | factures                  |
| factures                  | UNIQUE          | fournisseur_id      | mama_id             | factures                  |
| factures                  | UNIQUE          | fournisseur_id      | fournisseur_id      | factures                  |
| factures                  | UNIQUE          | fournisseur_id      | numero              | factures                  |
| factures                  | UNIQUE          | fournisseur_id      | date_facture        | factures                  |
| factures                  | UNIQUE          | numero              | mama_id             | factures                  |
| factures                  | UNIQUE          | numero              | fournisseur_id      | factures                  |
| factures                  | UNIQUE          | numero              | numero              | factures                  |
| factures                  | UNIQUE          | numero              | date_facture        | factures                  |
| factures                  | UNIQUE          | date_facture        | mama_id             | factures                  |
| factures                  | UNIQUE          | date_facture        | fournisseur_id      | factures                  |
| factures                  | UNIQUE          | date_facture        | numero              | factures                  |
| factures                  | UNIQUE          | date_facture        | date_facture        | factures                  |
| familles                  | CHECK           | null                | null                | null                      |
| familles                  | CHECK           | null                | null                | null                      |
| familles                  | CHECK           | null                | null                | null                      |
| familles                  | FOREIGN KEY     | parent_id           | id                  | familles                  |
| familles                  | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| familles                  | PRIMARY KEY     | id                  | id                  | familles                  |
| feedback                  | CHECK           | null                | null                | null                      |
| feedback                  | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| feedback                  | FOREIGN KEY     | user_id             | id                  | utilisateurs              |
| feedback                  | PRIMARY KEY     | id                  | id                  | feedback                  |
| fiche_cout_history        | CHECK           | null                | null                | null                      |
| fiche_cout_history        | CHECK           | null                | null                | null                      |
| fiche_cout_history        | CHECK           | null                | null                | null                      |
| fiche_cout_history        | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| fiche_cout_history        | FOREIGN KEY     | changed_by          | id                  | users                     |
| fiche_cout_history        | FOREIGN KEY     | fiche_id            | id                  | fiches                    |
| fiche_cout_history        | PRIMARY KEY     | id                  | id                  | fiche_cout_history        |
| fiche_lignes              | CHECK           | null                | null                | null                      |
| fiche_lignes              | CHECK           | null                | null                | null                      |
| fiche_lignes              | CHECK           | null                | null                | null                      |
| fiche_lignes              | FOREIGN KEY     | sous_fiche_id       | id                  | fiches_techniques         |
| fiche_lignes              | FOREIGN KEY     | produit_id          | id                  | produits                  |
| fiche_lignes              | FOREIGN KEY     | fiche_id            | id                  | fiches                    |
| fiche_lignes              | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| fiche_lignes              | PRIMARY KEY     | id                  | id                  | fiche_lignes              |
| fiche_prix_history        | CHECK           | null                | null                | null                      |
| fiche_prix_history        | CHECK           | null                | null                | null                      |
| fiche_prix_history        | CHECK           | null                | null                | null                      |
| fiche_prix_history        | FOREIGN KEY     | changed_by          | id                  | users                     |
| fiche_prix_history        | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| fiche_prix_history        | FOREIGN KEY     | fiche_id            | id                  | fiches                    |
| fiche_prix_history        | PRIMARY KEY     | id                  | id                  | fiche_prix_history        |
| fiches                    | CHECK           | null                | null                | null                      |
| fiches                    | CHECK           | null                | null                | null                      |
| fiches                    | CHECK           | null                | null                | null                      |
| fiches                    | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| fiches                    | PRIMARY KEY     | id                  | id                  | fiches                    |
| fiches_techniques         | CHECK           | null                | null                | null                      |
| fiches_techniques         | CHECK           | null                | null                | null                      |
| fiches_techniques         | CHECK           | null                | null                | null                      |
| fiches_techniques         | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| fiches_techniques         | FOREIGN KEY     | fiche_id            | id                  | fiches                    |
| fiches_techniques         | PRIMARY KEY     | id                  | id                  | fiches_techniques         |
| fournisseur_contacts      | CHECK           | null                | null                | null                      |
| fournisseur_contacts      | CHECK           | null                | null                | null                      |
| fournisseur_contacts      | CHECK           | null                | null                | null                      |
| fournisseur_contacts      | FOREIGN KEY     | fournisseur_id      | id                  | fournisseurs              |
| fournisseur_contacts      | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| fournisseur_contacts      | PRIMARY KEY     | id                  | id                  | fournisseur_contacts      |
| fournisseur_notes         | CHECK           | null                | null                | null                      |
| fournisseur_notes         | CHECK           | null                | null                | null                      |
| fournisseur_notes         | CHECK           | null                | null                | null                      |
| fournisseur_notes         | FOREIGN KEY     | fournisseur_id      | id                  | fournisseurs              |
| fournisseur_notes         | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| fournisseur_notes         | PRIMARY KEY     | id                  | id                  | fournisseur_notes         |
| fournisseur_produits      | CHECK           | null                | null                | null                      |
| fournisseur_produits      | CHECK           | null                | null                | null                      |
| fournisseur_produits      | CHECK           | null                | null                | null                      |
| fournisseur_produits      | CHECK           | null                | null                | null                      |
| fournisseur_produits      | FOREIGN KEY     | produit_id          | id                  | produits                  |
| fournisseur_produits      | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| fournisseur_produits      | FOREIGN KEY     | produit_id          | id                  | produits                  |
| fournisseur_produits      | FOREIGN KEY     | fournisseur_id      | id                  | fournisseurs              |
| fournisseur_produits      | FOREIGN KEY     | fournisseur_id      | id                  | fournisseurs              |
| fournisseur_produits      | PRIMARY KEY     | id                  | id                  | fournisseur_produits      |
| fournisseurs              | CHECK           | null                | null                | null                      |
| fournisseurs              | CHECK           | null                | null                | null                      |
| fournisseurs              | CHECK           | null                | null                | null                      |
| fournisseurs              | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| fournisseurs              | PRIMARY KEY     | id                  | id                  | fournisseurs              |
| fournisseurs_api_config   | CHECK           | null                | null                | null                      |
| fournisseurs_api_config   | CHECK           | null                | null                | null                      |
| fournisseurs_api_config   | FOREIGN KEY     | fournisseur_id      | id                  | fournisseurs              |
| fournisseurs_api_config   | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| fournisseurs_api_config   | PRIMARY KEY     | mama_id             | mama_id             | fournisseurs_api_config   |
| fournisseurs_api_config   | PRIMARY KEY     | mama_id             | fournisseur_id      | fournisseurs_api_config   |
| fournisseurs_api_config   | PRIMARY KEY     | fournisseur_id      | mama_id             | fournisseurs_api_config   |
| fournisseurs_api_config   | PRIMARY KEY     | fournisseur_id      | fournisseur_id      | fournisseurs_api_config   |
| gadgets                   | CHECK           | null                | null                | null                      |
| gadgets                   | FOREIGN KEY     | tableau_id          | id                  | tableaux_de_bord          |
| gadgets                   | PRIMARY KEY     | id                  | id                  | gadgets                   |
| guides_seen               | CHECK           | null                | null                | null                      |
| guides_seen               | CHECK           | null                | null                | null                      |
| guides_seen               | FOREIGN KEY     | user_id             | id                  | utilisateurs              |
| guides_seen               | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| guides_seen               | PRIMARY KEY     | module              | module              | guides_seen               |
| guides_seen               | PRIMARY KEY     | user_id             | user_id             | guides_seen               |
| guides_seen               | PRIMARY KEY     | user_id             | module              | guides_seen               |
| guides_seen               | PRIMARY KEY     | module              | user_id             | guides_seen               |
| help_articles             | CHECK           | null                | null                | null                      |
| help_articles             | PRIMARY KEY     | id                  | id                  | help_articles             |
| inventaire_lignes         | CHECK           | null                | null                | null                      |
| inventaire_lignes         | CHECK           | null                | null                | null                      |
| inventaire_lignes         | CHECK           | null                | null                | null                      |
| inventaire_lignes         | CHECK           | null                | null                | null                      |
| inventaire_lignes         | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| inventaire_lignes         | FOREIGN KEY     | zone_id             | id                  | zones_stock               |
| inventaire_lignes         | FOREIGN KEY     | produit_id          | id                  | produits                  |
| inventaire_lignes         | FOREIGN KEY     | inventaire_id       | id                  | inventaires               |
| inventaire_lignes         | PRIMARY KEY     | id                  | id                  | inventaire_lignes         |
| inventaire_zones          | CHECK           | null                | null                | null                      |
| inventaire_zones          | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| inventaire_zones          | PRIMARY KEY     | id                  | id                  | inventaire_zones          |
| inventaires               | CHECK           | null                | null                | null                      |
| inventaires               | CHECK           | null                | null                | null                      |
| inventaires               | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| inventaires               | PRIMARY KEY     | id                  | id                  | inventaires               |
| journal_audit             | CHECK           | null                | null                | null                      |
| journal_audit             | CHECK           | null                | null                | null                      |
| journal_audit             | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| journal_audit             | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| journal_audit             | FOREIGN KEY     | changed_by          | id                  | users                     |
| journal_audit             | PRIMARY KEY     | id                  | id                  | journal_audit             |
| journaux_utilisateur      | CHECK           | null                | null                | null                      |
| journaux_utilisateur      | CHECK           | null                | null                | null                      |
| journaux_utilisateur      | CHECK           | null                | null                | null                      |
| journaux_utilisateur      | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| journaux_utilisateur      | FOREIGN KEY     | done_by             | id                  | users                     |
| journaux_utilisateur      | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| journaux_utilisateur      | FOREIGN KEY     | user_id             | id                  | users                     |
| journaux_utilisateur      | PRIMARY KEY     | id                  | id                  | journaux_utilisateur      |
| lignes_bl                 | CHECK           | null                | null                | null                      |
| lignes_bl                 | FOREIGN KEY     | bl_id               | id                  | bons_livraison            |
| lignes_bl                 | FOREIGN KEY     | produit_id          | id                  | produits                  |
| lignes_bl                 | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| lignes_bl                 | PRIMARY KEY     | id                  | id                  | lignes_bl                 |
| logs_securite             | CHECK           | null                | null                | null                      |
| logs_securite             | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| logs_securite             | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| logs_securite             | FOREIGN KEY     | user_id             | id                  | utilisateurs              |
| logs_securite             | PRIMARY KEY     | id                  | id                  | logs_securite             |
| mamas                     | CHECK           | null                | null                | null                      |
| mamas                     | PRIMARY KEY     | id                  | id                  | mamas                     |
| menu_fiches               | CHECK           | null                | null                | null                      |
| menu_fiches               | CHECK           | null                | null                | null                      |
| menu_fiches               | CHECK           | null                | null                | null                      |
| menu_fiches               | CHECK           | null                | null                | null                      |
| menu_fiches               | FOREIGN KEY     | menu_id             | id                  | menus                     |
| menu_fiches               | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| menu_fiches               | FOREIGN KEY     | fiche_id            | id                  | fiches                    |
| menu_fiches               | PRIMARY KEY     | id                  | id                  | menu_fiches               |
| menus                     | CHECK           | null                | null                | null                      |
| menus                     | CHECK           | null                | null                | null                      |
| menus                     | CHECK           | null                | null                | null                      |
| menus                     | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| menus                     | PRIMARY KEY     | id                  | id                  | menus                     |
| menus_jour                | CHECK           | null                | null                | null                      |
| menus_jour                | CHECK           | null                | null                | null                      |
| menus_jour                | CHECK           | null                | null                | null                      |
| menus_jour                | CHECK           | null                | null                | null                      |
| menus_jour                | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| menus_jour                | PRIMARY KEY     | id                  | id                  | menus_jour                |
| menus_jour_fiches         | CHECK           | null                | null                | null                      |
| menus_jour_fiches         | CHECK           | null                | null                | null                      |
| menus_jour_fiches         | CHECK           | null                | null                | null                      |
| menus_jour_fiches         | CHECK           | null                | null                | null                      |
| menus_jour_fiches         | FOREIGN KEY     | menu_jour_id        | id                  | menus_jour                |
| menus_jour_fiches         | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| menus_jour_fiches         | FOREIGN KEY     | fiche_id            | id                  | fiches_techniques         |
| menus_jour_fiches         | PRIMARY KEY     | id                  | id                  | menus_jour_fiches         |
| mouvements_centres_cout   | CHECK           | null                | null                | null                      |
| mouvements_centres_cout   | CHECK           | null                | null                | null                      |
| mouvements_centres_cout   | CHECK           | null                | null                | null                      |
| mouvements_centres_cout   | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| mouvements_centres_cout   | FOREIGN KEY     | centre_cout_id      | id                  | centres_de_cout           |
| mouvements_centres_cout   | PRIMARY KEY     | id                  | id                  | mouvements_centres_cout   |
| notification_preferences  | CHECK           | null                | null                | null                      |
| notification_preferences  | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| notification_preferences  | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| notification_preferences  | PRIMARY KEY     | id                  | id                  | notification_preferences  |
| notifications             | CHECK           | null                | null                | null                      |
| notifications             | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| notifications             | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| notifications             | FOREIGN KEY     | user_id             | id                  | utilisateurs              |
| notifications             | PRIMARY KEY     | id                  | id                  | notifications             |
| parametres                | CHECK           | null                | null                | null                      |
| parametres                | CHECK           | null                | null                | null                      |
| parametres                | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| parametres                | PRIMARY KEY     | id                  | id                  | parametres                |
| permissions               | CHECK           | null                | null                | null                      |
| permissions               | CHECK           | null                | null                | null                      |
| permissions               | CHECK           | null                | null                | null                      |
| permissions               | FOREIGN KEY     | user_id             | id                  | users                     |
| permissions               | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| permissions               | FOREIGN KEY     | role_id             | id                  | roles                     |
| permissions               | PRIMARY KEY     | id                  | id                  | permissions               |
| pertes                    | CHECK           | null                | null                | null                      |
| pertes                    | CHECK           | null                | null                | null                      |
| pertes                    | CHECK           | null                | null                | null                      |
| pertes                    | FOREIGN KEY     | centre_cout_id      | id                  | centres_de_cout           |
| pertes                    | FOREIGN KEY     | produit_id          | id                  | produits                  |
| pertes                    | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| pertes                    | FOREIGN KEY     | created_by          | id                  | users                     |
| pertes                    | PRIMARY KEY     | id                  | id                  | pertes                    |
| planning_previsionnel     | CHECK           | null                | null                | null                      |
| planning_previsionnel     | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| planning_previsionnel     | FOREIGN KEY     | produit_id          | id                  | produits                  |
| planning_previsionnel     | PRIMARY KEY     | id                  | id                  | planning_previsionnel     |
| produits                  | CHECK           | null                | null                | null                      |
| produits                  | CHECK           | null                | null                | null                      |
| produits                  | CHECK           | null                | null                | null                      |
| produits                  | FOREIGN KEY     | fournisseur_principal_id    | id                  | fournisseurs |              |
| produits                  | FOREIGN KEY     | famille_id          | id                  | familles                  |
| produits                  | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| produits                  | FOREIGN KEY     | unite_id            | id                  | unites                    |
| produits                  | FOREIGN KEY     | fiche_technique_id  | id                  | fiches_techniques         |
| produits                  | PRIMARY KEY     | id                  | id                  | produits                  |
| promotion_produits        | CHECK           | null                | null                | null                      |
| promotion_produits        | CHECK           | null                | null                | null                      |
| promotion_produits        | CHECK           | null                | null                | null                      |
| promotion_produits        | CHECK           | null                | null                | null                      |
| promotion_produits        | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| promotion_produits        | FOREIGN KEY     | produit_id          | id                  | produits                  |
| promotion_produits        | FOREIGN KEY     | promotion_id        | id                  | promotions                |
| promotion_produits        | PRIMARY KEY     | id                  | id                  | promotion_produits        |
| promotions                | CHECK           | null                | null                | null                      |
| promotions                | CHECK           | null                | null                | null                      |
| promotions                | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| promotions                | PRIMARY KEY     | id                  | id                  | promotions                |
| regles_alertes            | CHECK           | null                | null                | null                      |
| regles_alertes            | FOREIGN KEY     | produit_id          | id                  | produits                  |
| regles_alertes            | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| regles_alertes            | PRIMARY KEY     | id                  | id                  | regles_alertes            |
| requisition_lignes        | CHECK           | null                | null                | null                      |
| requisition_lignes        | CHECK           | null                | null                | null                      |
| requisition_lignes        | CHECK           | null                | null                | null                      |
| requisition_lignes        | CHECK           | null                | null                | null                      |
| requisition_lignes        | FOREIGN KEY     | requisition_id      | id                  | requisitions              |
| requisition_lignes        | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| requisition_lignes        | FOREIGN KEY     | produit_id          | id                  | produits                  |
| requisition_lignes        | PRIMARY KEY     | id                  | id                  | requisition_lignes        |
| requisitions              | CHECK           | null                | null                | null                      |
| requisitions              | CHECK           | null                | null                | null                      |
| requisitions              | CHECK           | null                | null                | null                      |
| requisitions              | CHECK           | null                | null                | null                      |
| requisitions              | FOREIGN KEY     | auteur_id           | id                  | users                     |
| requisitions              | FOREIGN KEY     | zone_id             | id                  | zones_stock               |
| requisitions              | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| requisitions              | FOREIGN KEY     | produit_id          | id                  | produits                  |
| requisitions              | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| requisitions              | PRIMARY KEY     | id                  | id                  | requisitions              |
| roles                     | CHECK           | null                | null                | null                      |
| roles                     | CHECK           | null                | null                | null                      |
| roles                     | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| roles                     | PRIMARY KEY     | id                  | id                  | roles                     |
| signalements              | CHECK           | null                | null                | null                      |
| signalements              | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| signalements              | FOREIGN KEY     | created_by          | id                  | utilisateurs              |
| signalements              | PRIMARY KEY     | id                  | id                  | signalements              |
| stock_mouvements          | CHECK           | null                | null                | null                      |
| stock_mouvements          | CHECK           | null                | null                | null                      |
| stock_mouvements          | CHECK           | null                | null                | null                      |
| stock_mouvements          | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| stock_mouvements          | FOREIGN KEY     | inventaire_id       | id                  | inventaires               |
| stock_mouvements          | FOREIGN KEY     | produit_id          | id                  | produits                  |
| stock_mouvements          | FOREIGN KEY     | zone_destination_id | id                  | zones_stock               |
| stock_mouvements          | FOREIGN KEY     | auteur_id           | id                  | utilisateurs              |
| stock_mouvements          | FOREIGN KEY     | zone_id             | id                  | zones_stock               |
| stock_mouvements          | FOREIGN KEY     | zone_source_id      | id                  | zones_stock               |
| stock_mouvements          | PRIMARY KEY     | id                  | id                  | stock_mouvements          |
| stocks                    | CHECK           | null                | null                | null                      |
| stocks                    | CHECK           | null                | null                | null                      |
| stocks                    | CHECK           | null                | null                | null                      |
| stocks                    | CHECK           | null                | null                | null                      |
| stocks                    | FOREIGN KEY     | produit_id          | id                  | produits                  |
| stocks                    | FOREIGN KEY     | zone_id             | id                  | zones_stock               |
| stocks                    | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| stocks                    | PRIMARY KEY     | id                  | id                  | stocks                    |
| tableaux_de_bord          | CHECK           | null                | null                | null                      |
| tableaux_de_bord          | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| tableaux_de_bord          | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| tableaux_de_bord          | PRIMARY KEY     | id                  | id                  | tableaux_de_bord          |
| tache_assignations        | CHECK           | null                | null                | null                      |
| tache_assignations        | CHECK           | null                | null                | null                      |
| tache_assignations        | CHECK           | null                | null                | null                      |
| tache_assignations        | CHECK           | null                | null                | null                      |
| tache_assignations        | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| tache_assignations        | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| tache_assignations        | FOREIGN KEY     | tache_id            | id                  | taches                    |
| tache_assignations        | PRIMARY KEY     | id                  | id                  | tache_assignations        |
| tache_instances           | CHECK           | null                | null                | null                      |
| tache_instances           | CHECK           | null                | null                | null                      |
| tache_instances           | CHECK           | null                | null                | null                      |
| tache_instances           | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| tache_instances           | FOREIGN KEY     | tache_id            | id                  | taches                    |
| tache_instances           | FOREIGN KEY     | done_by             | id                  | users                     |
| tache_instances           | PRIMARY KEY     | id                  | id                  | tache_instances           |
| taches                    | CHECK           | null                | null                | null                      |
| taches                    | CHECK           | null                | null                | null                      |
| taches                    | CHECK           | null                | null                | null                      |
| taches                    | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| taches                    | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| taches                    | FOREIGN KEY     | created_by          | id                  | users                     |
| taches                    | PRIMARY KEY     | id                  | id                  | taches                    |
| tooltips                  | CHECK           | null                | null                | null                      |
| tooltips                  | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| tooltips                  | PRIMARY KEY     | id                  | id                  | tooltips                  |
| transfert_lignes          | CHECK           | null                | null                | null                      |
| transfert_lignes          | CHECK           | null                | quantite            | transfert_lignes          |
| transfert_lignes          | CHECK           | null                | null                | null                      |
| transfert_lignes          | CHECK           | null                | null                | null                      |
| transfert_lignes          | CHECK           | null                | null                | null                      |
| transfert_lignes          | FOREIGN KEY     | transfert_id        | id                  | transferts                |
| transfert_lignes          | FOREIGN KEY     | produit_id          | id                  | produits                  |
| transfert_lignes          | PRIMARY KEY     | id                  | id                  | transfert_lignes          |
| transferts                | CHECK           | null                | null                | null                      |
| transferts                | CHECK           | null                | null                | null                      |
| transferts                | CHECK           | null                | null                | null                      |
| transferts                | FOREIGN KEY     | produit_id          | id                  | produits                  |
| transferts                | FOREIGN KEY     | zone_source_id      | id                  | zones_stock               |
| transferts                | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| transferts                | FOREIGN KEY     | created_by          | id                  | users                     |
| transferts                | FOREIGN KEY     | utilisateur_id      | id                  | utilisateurs              |
| transferts                | FOREIGN KEY     | zone_dest_id        | id                  | zones_stock               |
| transferts                | PRIMARY KEY     | id                  | id                  | transferts                |
| unites                    | CHECK           | null                | null                | null                      |
| unites                    | CHECK           | null                | null                | null                      |
| unites                    | CHECK           | null                | null                | null                      |
| unites                    | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| unites                    | PRIMARY KEY     | id                  | id                  | unites                    |
| unites_equivalentes       | CHECK           | null                | null                | null                      |
| unites_equivalentes       | CHECK           | null                | null                | null                      |
| unites_equivalentes       | CHECK           | null                | null                | null                      |
| unites_equivalentes       | CHECK           | null                | null                | null                      |
| unites_equivalentes       | CHECK           | null                | null                | null                      |
| unites_equivalentes       | FOREIGN KEY     | unite_dst           | id                  | unites                    |
| unites_equivalentes       | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| unites_equivalentes       | FOREIGN KEY     | unite_src           | id                  | unites                    |
| unites_equivalentes       | PRIMARY KEY     | id                  | id                  | unites_equivalentes       |
| unites_equivalentes       | UNIQUE          | mama_id             | unite_dst           | unites_equivalentes       |
| unites_equivalentes       | UNIQUE          | unite_src           | unite_dst           | unites_equivalentes       |
| unites_equivalentes       | UNIQUE          | unite_dst           | mama_id             | unites_equivalentes       |
| unites_equivalentes       | UNIQUE          | unite_dst           | unite_dst           | unites_equivalentes       |
| unites_equivalentes       | UNIQUE          | unite_src           | mama_id             | unites_equivalentes       |
| unites_equivalentes       | UNIQUE          | unite_dst           | unite_src           | unites_equivalentes       |
| unites_equivalentes       | UNIQUE          | unite_src           | unite_src           | unites_equivalentes       |
| unites_equivalentes       | UNIQUE          | mama_id             | mama_id             | unites_equivalentes       |
| unites_equivalentes       | UNIQUE          | mama_id             | unite_src           | unites_equivalentes       |
| usage_stats               | CHECK           | null                | null                | null                      |
| usage_stats               | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| usage_stats               | FOREIGN KEY     | user_id             | id                  | utilisateurs              |
| usage_stats               | PRIMARY KEY     | id                  | id                  | usage_stats               |
| users                     | CHECK           | null                | null                | null                      |
| users                     | CHECK           | null                | null                | null                      |
| users                     | PRIMARY KEY     | id                  | id                  | users                     |
| utilisateurs              | CHECK           | null                | null                | null                      |
| utilisateurs              | CHECK           | null                | null                | null                      |
| utilisateurs              | FOREIGN KEY     | role_id             | id                  | roles                     |
| utilisateurs              | FOREIGN KEY     | auth_id             | null                | null                      |
| utilisateurs              | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| utilisateurs              | PRIMARY KEY     | id                  | id                  | utilisateurs              |
| validation_requests       | CHECK           | null                | null                | null                      |
| validation_requests       | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| validation_requests       | FOREIGN KEY     | user_id             | id                  | utilisateurs              |
| validation_requests       | PRIMARY KEY     | id                  | id                  | validation_requests       |
| ventes_boissons           | CHECK           | null                | null                | null                      |
| ventes_boissons           | CHECK           | null                | null                | null                      |
| ventes_boissons           | FOREIGN KEY     | created_by          | id                  | users                     |
| ventes_boissons           | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| ventes_boissons           | FOREIGN KEY     | boisson_id          | id                  | produits                  |
| ventes_boissons           | PRIMARY KEY     | id                  | id                  | ventes_boissons           |
| ventes_fiches_carte       | CHECK           | null                | null                | null                      |
| ventes_fiches_carte       | CHECK           | null                | null                | null                      |
| ventes_fiches_carte       | CHECK           | null                | null                | null                      |
| ventes_fiches_carte       | FOREIGN KEY     | fiche_id            | id                  | fiches                    |
| ventes_fiches_carte       | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| ventes_fiches_carte       | PRIMARY KEY     | id                  | id                  | ventes_fiches_carte       |
| zones_stock               | CHECK           | null                | null                | null                      |
| zones_stock               | CHECK           | null                | null                | null                      |
| zones_stock               | CHECK           | null                | null                | null                      |
| zones_stock               | FOREIGN KEY     | mama_id             | id                  | mamas                     |
| zones_stock               | PRIMARY KEY     | id                  | id                  | zones_stock               |


SELECT
    pol.policyname AS policy_name,
    tab.relname AS table_name,
    pol.cmd AS command,
    pol.permissive,
    pol.roles,
    pol.qual AS using_expression,
    pol.with_check AS with_check_expression
FROM
    pg_policies pol
    JOIN pg_class tab ON pol.tablename = tab.relname
WHERE
    tab.relnamespace = (SELECT oid FROM pg_namespace WHERE nspname = 'public')
ORDER BY tab.relname, pol.policyname;


| policy_name                 | table_name              | command | permissive | roles    | using_expression                                                                                                                                                                   | with_check_expression                                                                                                                                                              |
| --------------------------- | ----------------------- | ------- | ---------- | -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| access_rights_all           | access_rights           | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access_access_rights   | access_rights           | ALL     | PERMISSIVE | {public} | (mama_id = ( SELECT utilisateurs.mama_id
   FROM utilisateurs
  WHERE (auth.uid() = utilisateurs.auth_id)
 LIMIT 1))                                                               | null                                                                                                                                                                               |
| achats_all                  | achats                  | ALL     | PERMISSIVE | {public} | (mama_id = ( SELECT utilisateurs.mama_id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid())))                                                                        | (mama_id = ( SELECT utilisateurs.mama_id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid())))                                                                        |
| bons_livraison_all          | bons_livraison          | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | centres_de_cout         | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| commande_lignes_all         | commande_lignes         | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| commandes_all               | commandes               | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| facture_lignes_all          | facture_lignes          | ALL     | PERMISSIVE | {public} | (mama_id = ( SELECT utilisateurs.mama_id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid())))                                                                        | (mama_id = ( SELECT utilisateurs.mama_id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid())))                                                                        |
| factures_all                | factures                | ALL     | PERMISSIVE | {public} | (mama_id = ( SELECT utilisateurs.mama_id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid())))                                                                        | (mama_id = ( SELECT utilisateurs.mama_id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid())))                                                                        |
| familles_all                | familles                | ALL     | PERMISSIVE | {public} | ((mama_id = current_user_mama_id()) AND (actif = true))                                                                                                                            | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | fiche_prix_history      | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| fiches_techniques_all       | fiches_techniques       | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | fournisseur_contacts    | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | fournisseur_notes       | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| fournisseur_produits_all    | fournisseur_produits    | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| fournisseurs_api_config_all | fournisseurs_api_config | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| gadgets_all                 | gadgets                 | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| inventaire_lignes_all       | inventaire_lignes       | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| inventaire_zones_all        | inventaire_zones        | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| inventaires_all             | inventaires             | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | journal_audit           | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| journaux_utilisateur_all    | journaux_utilisateur    | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | journaux_utilisateur    | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| lignes_bl_all               | lignes_bl               | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| logs_securite_all           | logs_securite           | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | mamas                   | SELECT  | PERMISSIVE | {public} | (id = ( SELECT utilisateurs.mama_id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid())
 LIMIT 1))                                                                    | null                                                                                                                                                                               |
| mamas_all                   | mamas                   | ALL     | PERMISSIVE | {public} | (id = current_user_mama_id())                                                                                                                                                      | (id = current_user_mama_id())                                                                                                                                                      |
| mama_access                 | menu_fiches             | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | menus                   | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| menus_jour_all              | menus_jour              | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| menus_jour_fiches_all       | menus_jour_fiches       | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | mouvements_centres_cout | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| notifications_all           | notifications           | ALL     | PERMISSIVE | {public} | ((mama_id = current_user_mama_id()) AND ((user_id = auth.uid()) OR (utilisateur_id = ( SELECT utilisateurs.id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid()))))) | ((mama_id = current_user_mama_id()) AND ((user_id = auth.uid()) OR (utilisateur_id = ( SELECT utilisateurs.id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid()))))) |
| mama_access                 | parametres              | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | permissions             | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| permissions_all             | permissions             | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | pertes                  | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| produits_all                | produits                | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | promotion_produits      | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| promotion_produits_all      | promotion_produits      | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | promotions              | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| promotions_all              | promotions              | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| requisition_lignes_all      | requisition_lignes      | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | requisitions            | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| requisitions_all            | requisitions            | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| roles_all                   | roles                   | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | stock_mouvements        | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| tableaux_de_bord_all        | tableaux_de_bord        | ALL     | PERMISSIVE | {public} | ((mama_id = current_user_mama_id()) AND (utilisateur_id = ( SELECT utilisateurs.id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid()))))                             | ((mama_id = current_user_mama_id()) AND (utilisateur_id = ( SELECT utilisateurs.id
   FROM utilisateurs
  WHERE (utilisateurs.auth_id = auth.uid()))))                             |
| tache_assignations_all      | tache_assignations      | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| tache_instances_all         | tache_instances         | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | taches                  | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| taches_all                  | taches                  | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| transfert_lignes_all        | transfert_lignes        | ALL     | PERMISSIVE | {public} | (EXISTS ( SELECT 1
   FROM transferts t
  WHERE ((t.id = transfert_lignes.transfert_id) AND (t.mama_id = current_user_mama_id()))))                                                | (EXISTS ( SELECT 1
   FROM transferts t
  WHERE ((t.id = transfert_lignes.transfert_id) AND (t.mama_id = current_user_mama_id()))))                                                |
| mama_access                 | transferts              | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| transferts_all              | transferts              | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| unites_all                  | unites                  | ALL     | PERMISSIVE | {public} | ((mama_id = current_user_mama_id()) AND (actif = true))                                                                                                                            | (mama_id = current_user_mama_id())                                                                                                                                                 |
| unites_equivalentes_all     | unites_equivalentes     | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| utilisateurs_all            | utilisateurs            | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| validation_requests_all     | validation_requests     | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | ventes_boissons         | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| mama_access                 | ventes_fiches_carte     | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| ventes_fiches_carte_all     | ventes_fiches_carte     | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |
| zones_stock_all             | zones_stock             | ALL     | PERMISSIVE | {public} | (mama_id = current_user_mama_id())                                                                                                                                                 | (mama_id = current_user_mama_id())                                                                                                                                                 |

