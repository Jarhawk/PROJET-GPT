| table_schema | table_name                               | column_name               | data_type                | is_nullable | column_default     |
| ------------ | ---------------------------------------- | ------------------------- | ------------------------ | ----------- | ------------------ |
| public       | access_rights                            | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | access_rights                            | mama_id                   | uuid                     | NO          | null               |
| public       | access_rights                            | role_id                   | uuid                     | NO          | null               |
| public       | access_rights                            | module                    | text                     | NO          | null               |
| public       | access_rights                            | peut_voir                 | boolean                  | NO          | false              |
| public       | access_rights                            | peut_modifier             | boolean                  | NO          | false              |
| public       | access_rights                            | created_at                | timestamp with time zone | YES         | now()              |
| public       | api_keys                                 | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | api_keys                                 | mama_id                   | uuid                     | YES         | null               |
| public       | api_keys                                 | user_id                   | uuid                     | YES         | null               |
| public       | api_keys                                 | name                      | text                     | YES         | null               |
| public       | api_keys                                 | scopes                    | jsonb                    | YES         | null               |
| public       | api_keys                                 | role                      | text                     | YES         | null               |
| public       | api_keys                                 | expiration                | date                     | YES         | null               |
| public       | api_keys                                 | revoked                   | boolean                  | YES         | false              |
| public       | api_keys                                 | created_at                | timestamp with time zone | YES         | now()              |
| public       | auth_double_facteur                      | id                        | uuid                     | NO          | null               |
| public       | auth_double_facteur                      | secret                    | text                     | YES         | null               |
| public       | auth_double_facteur                      | enabled                   | boolean                  | YES         | false              |
| public       | auth_double_facteur                      | created_at                | timestamp with time zone | YES         | now()              |
| public       | bons_livraison                           | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | bons_livraison                           | mama_id                   | uuid                     | YES         | null               |
| public       | bons_livraison                           | fournisseur_id            | uuid                     | YES         | null               |
| public       | bons_livraison                           | numero_bl                 | text                     | YES         | null               |
| public       | bons_livraison                           | date_livraison            | date                     | YES         | null               |
| public       | bons_livraison                           | created_at                | timestamp with time zone | YES         | now()              |
| public       | catalogue_updates                        | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | catalogue_updates                        | mama_id                   | uuid                     | YES         | null               |
| public       | catalogue_updates                        | fournisseur_id            | uuid                     | YES         | null               |
| public       | catalogue_updates                        | produit_id                | uuid                     | YES         | null               |
| public       | catalogue_updates                        | ancienne_valeur           | numeric                  | YES         | null               |
| public       | catalogue_updates                        | nouvelle_valeur           | numeric                  | YES         | null               |
| public       | catalogue_updates                        | modification              | jsonb                    | YES         | null               |
| public       | catalogue_updates                        | created_at                | timestamp with time zone | YES         | now()              |
| public       | centres_de_cout                          | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | centres_de_cout                          | mama_id                   | uuid                     | NO          | null               |
| public       | centres_de_cout                          | nom                       | text                     | NO          | null               |
| public       | centres_de_cout                          | created_at                | timestamp with time zone | YES         | now()              |
| public       | centres_de_cout                          | updated_at                | timestamp with time zone | YES         | now()              |
| public       | centres_de_cout                          | actif                     | boolean                  | YES         | true               |
| public       | centres_de_cout                          | activite                  | text                     | YES         | null               |
| public       | commandes                                | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | commandes                                | mama_id                   | uuid                     | YES         | null               |
| public       | commandes                                | fournisseur_id            | uuid                     | YES         | null               |
| public       | commandes                                | statut                    | text                     | YES         | null               |
| public       | commandes                                | created_at                | timestamp with time zone | YES         | now()              |
| public       | compta_mapping                           | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | compta_mapping                           | mama_id                   | uuid                     | YES         | null               |
| public       | compta_mapping                           | cle                       | text                     | YES         | null               |
| public       | compta_mapping                           | compte                    | text                     | YES         | null               |
| public       | compta_mapping                           | type                      | text                     | YES         | null               |
| public       | compta_mapping                           | created_at                | timestamp with time zone | YES         | now()              |
| public       | consentements_utilisateur                | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | consentements_utilisateur                | user_id                   | uuid                     | YES         | null               |
| public       | consentements_utilisateur                | mama_id                   | uuid                     | YES         | null               |
| public       | consentements_utilisateur                | consentement              | boolean                  | YES         | null               |
| public       | consentements_utilisateur                | date_consentement         | timestamp with time zone | YES         | null               |
| public       | consentements_utilisateur                | actif                     | boolean                  | YES         | true               |
| public       | consentements_utilisateur                | created_at                | timestamp with time zone | YES         | now()              |
| public       | documentation                            | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | documentation                            | mama_id                   | uuid                     | YES         | null               |
| public       | documentation                            | titre                     | text                     | YES         | null               |
| public       | documentation                            | contenu                   | text                     | YES         | null               |
| public       | documentation                            | categorie                 | text                     | YES         | null               |
| public       | documentation                            | created_at                | timestamp with time zone | YES         | now()              |
| public       | documents                                | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | documents                                | mama_id                   | uuid                     | YES         | null               |
| public       | documents                                | chemin                    | text                     | YES         | null               |
| public       | documents                                | type                      | text                     | YES         | null               |
| public       | documents                                | created_at                | timestamp with time zone | YES         | now()              |
| public       | etapes_onboarding                        | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | etapes_onboarding                        | mama_id                   | uuid                     | YES         | null               |
| public       | etapes_onboarding                        | etape                     | text                     | YES         | null               |
| public       | etapes_onboarding                        | terminee                  | boolean                  | YES         | false              |
| public       | etapes_onboarding                        | created_at                | timestamp with time zone | YES         | now()              |
| public       | facture_lignes                           | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | facture_lignes                           | mama_id                   | uuid                     | NO          | null               |
| public       | facture_lignes                           | facture_id                | uuid                     | NO          | null               |
| public       | facture_lignes                           | produit_id                | uuid                     | NO          | null               |
| public       | facture_lignes                           | quantite                  | numeric                  | YES         | null               |
| public       | facture_lignes                           | prix                      | numeric                  | YES         | null               |
| public       | facture_lignes                           | created_at                | timestamp with time zone | YES         | now()              |
| public       | facture_lignes                           | updated_at                | timestamp with time zone | YES         | now()              |
| public       | facture_lignes                           | actif                     | boolean                  | YES         | true               |
| public       | factures                                 | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | factures                                 | mama_id                   | uuid                     | NO          | null               |
| public       | factures                                 | fournisseur_id            | uuid                     | YES         | null               |
| public       | factures                                 | numero                    | text                     | YES         | null               |
| public       | factures                                 | date_facture              | date                     | YES         | null               |
| public       | factures                                 | created_at                | timestamp with time zone | YES         | now()              |
| public       | factures                                 | updated_at                | timestamp with time zone | YES         | now()              |
| public       | factures                                 | actif                     | boolean                  | YES         | true               |
| public       | factures                                 | total_ht                  | numeric                  | YES         | null               |
| public       | factures                                 | total_tva                 | numeric                  | YES         | null               |
| public       | factures                                 | total_ttc                 | numeric                  | YES         | null               |
| public       | factures                                 | statut                    | text                     | YES         | null               |
| public       | familles                                 | id                        | uuid                     | NO          | uuid_generate_v4() |
| public       | familles                                 | nom                       | text                     | NO          | null               |
| public       | familles                                 | mama_id                   | uuid                     | NO          | null               |
| public       | familles                                 | actif                     | boolean                  | YES         | true               |
| public       | familles                                 | created_at                | timestamp with time zone | YES         | now()              |
| public       | feedback                                 | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | feedback                                 | mama_id                   | uuid                     | YES         | null               |
| public       | feedback                                 | user_id                   | uuid                     | YES         | null               |
| public       | feedback                                 | module                    | text                     | YES         | null               |
| public       | feedback                                 | message                   | text                     | YES         | null               |
| public       | feedback                                 | urgence                   | text                     | YES         | null               |
| public       | feedback                                 | created_at                | timestamp with time zone | YES         | now()              |
| public       | fiche_cout_history                       | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | fiche_cout_history                       | mama_id                   | uuid                     | NO          | null               |
| public       | fiche_cout_history                       | fiche_id                  | uuid                     | NO          | null               |
| public       | fiche_cout_history                       | old_cout                  | numeric                  | YES         | null               |
| public       | fiche_cout_history                       | new_cout                  | numeric                  | YES         | null               |
| public       | fiche_cout_history                       | changed_by                | uuid                     | YES         | null               |
| public       | fiche_cout_history                       | changed_at                | timestamp with time zone | YES         | null               |
| public       | fiche_cout_history                       | created_at                | timestamp with time zone | YES         | now()              |
| public       | fiche_cout_history                       | updated_at                | timestamp with time zone | YES         | now()              |
| public       | fiche_cout_history                       | actif                     | boolean                  | YES         | true               |
| public       | fiche_lignes                             | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | fiche_lignes                             | mama_id                   | uuid                     | NO          | null               |
| public       | fiche_lignes                             | fiche_id                  | uuid                     | NO          | null               |
| public       | fiche_lignes                             | description               | text                     | YES         | null               |
| public       | fiche_lignes                             | quantite                  | numeric                  | YES         | null               |
| public       | fiche_lignes                             | created_at                | timestamp with time zone | YES         | now()              |
| public       | fiche_lignes                             | updated_at                | timestamp with time zone | YES         | now()              |
| public       | fiche_lignes                             | actif                     | boolean                  | YES         | true               |
| public       | fiche_lignes                             | produit_id                | uuid                     | YES         | null               |
| public       | fiche_prix_history                       | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | fiche_prix_history                       | mama_id                   | uuid                     | NO          | null               |
| public       | fiche_prix_history                       | fiche_id                  | uuid                     | NO          | null               |
| public       | fiche_prix_history                       | old_prix                  | numeric                  | YES         | null               |
| public       | fiche_prix_history                       | new_prix                  | numeric                  | YES         | null               |
| public       | fiche_prix_history                       | changed_by                | uuid                     | YES         | null               |
| public       | fiche_prix_history                       | changed_at                | timestamp with time zone | YES         | null               |
| public       | fiche_prix_history                       | created_at                | timestamp with time zone | YES         | now()              |
| public       | fiche_prix_history                       | updated_at                | timestamp with time zone | YES         | now()              |
| public       | fiche_prix_history                       | actif                     | boolean                  | YES         | true               |
| public       | fiches                                   | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | fiches                                   | mama_id                   | uuid                     | NO          | null               |
| public       | fiches                                   | titre                     | text                     | NO          | null               |
| public       | fiches                                   | created_at                | timestamp with time zone | YES         | now()              |
| public       | fiches                                   | updated_at                | timestamp with time zone | YES         | now()              |
| public       | fiches                                   | actif                     | boolean                  | YES         | true               |
| public       | fiches                                   | portions                  | numeric                  | YES         | 1                  |
| public       | fiches_techniques                        | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | fiches_techniques                        | mama_id                   | uuid                     | NO          | null               |
| public       | fiches_techniques                        | fiche_id                  | uuid                     | NO          | null               |
| public       | fiches_techniques                        | technique                 | text                     | YES         | null               |
| public       | fiches_techniques                        | created_at                | timestamp with time zone | YES         | now()              |
| public       | fiches_techniques                        | updated_at                | timestamp with time zone | YES         | now()              |
| public       | fiches_techniques                        | actif                     | boolean                  | YES         | true               |
| public       | fournisseur_contacts                     | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | fournisseur_contacts                     | mama_id                   | uuid                     | NO          | null               |
| public       | fournisseur_contacts                     | fournisseur_id            | uuid                     | NO          | null               |
| public       | fournisseur_contacts                     | nom                       | text                     | YES         | null               |
| public       | fournisseur_contacts                     | email                     | text                     | YES         | null               |
| public       | fournisseur_contacts                     | tel                       | text                     | YES         | null               |
| public       | fournisseur_contacts                     | created_at                | timestamp with time zone | YES         | now()              |
| public       | fournisseur_contacts                     | updated_at                | timestamp with time zone | YES         | now()              |
| public       | fournisseur_contacts                     | actif                     | boolean                  | YES         | true               |
| public       | fournisseur_notes                        | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | fournisseur_notes                        | mama_id                   | uuid                     | NO          | null               |
| public       | fournisseur_notes                        | fournisseur_id            | uuid                     | NO          | null               |
| public       | fournisseur_notes                        | note                      | text                     | YES         | null               |
| public       | fournisseur_notes                        | date                      | date                     | YES         | null               |
| public       | fournisseur_notes                        | created_at                | timestamp with time zone | YES         | now()              |
| public       | fournisseur_notes                        | updated_at                | timestamp with time zone | YES         | now()              |
| public       | fournisseur_notes                        | actif                     | boolean                  | YES         | true               |
| public       | fournisseur_produits                     | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | fournisseur_produits                     | mama_id                   | uuid                     | NO          | null               |
| public       | fournisseur_produits                     | fournisseur_id            | uuid                     | NO          | null               |
| public       | fournisseur_produits                     | produit_id                | uuid                     | NO          | null               |
| public       | fournisseur_produits                     | created_at                | timestamp with time zone | YES         | now()              |
| public       | fournisseur_produits                     | updated_at                | timestamp with time zone | YES         | now()              |
| public       | fournisseur_produits                     | actif                     | boolean                  | YES         | true               |
| public       | fournisseur_produits                     | prix_achat                | numeric                  | YES         | null               |
| public       | fournisseur_produits                     | date_livraison            | date                     | YES         | null               |
| public       | fournisseurs                             | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | fournisseurs                             | mama_id                   | uuid                     | NO          | null               |
| public       | fournisseurs                             | nom                       | text                     | NO          | null               |
| public       | fournisseurs                             | ville                   | text                     | YES         | null               |
| public       | fournisseurs                             | tel                     | text                     | YES         | null               |
| public       | fournisseurs                             | email                   | text                     | YES         | null               |
| public       | fournisseurs                             | contact                 | text                     | YES         | null               |
| public       | fournisseurs                             | created_at                | timestamp with time zone | YES         | now()              |
| public       | fournisseurs                             | updated_at                | timestamp with time zone | YES         | now()              |
| public       | fournisseurs                             | actif                     | boolean                  | YES         | true               |
| public       | fournisseurs_api_config                  | fournisseur_id            | uuid                     | NO          | null               |
| public       | fournisseurs_api_config                  | mama_id                   | uuid                     | NO          | null               |
| public       | fournisseurs_api_config                  | url                       | text                     | YES         | null               |
| public       | fournisseurs_api_config                  | type_api                  | text                     | YES         | 'rest'::text       |
| public       | fournisseurs_api_config                  | token                     | text                     | YES         | null               |
| public       | fournisseurs_api_config                  | format_facture            | text                     | YES         | 'json'::text       |
| public       | fournisseurs_api_config                  | actif                     | boolean                  | YES         | true               |
| public       | fournisseurs_api_config                  | created_at                | timestamp with time zone | YES         | now()              |
| public       | gadgets                                  | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | gadgets                                  | tableau_id                | uuid                     | YES         | null               |
| public       | gadgets                                  | type                      | text                     | YES         | null               |
| public       | gadgets                                  | config                    | jsonb                    | YES         | null               |
| public       | gadgets                                  | created_at                | timestamp with time zone | YES         | now()              |
| public       | guides_seen                              | user_id                   | uuid                     | NO          | null               |
| public       | guides_seen                              | mama_id                   | uuid                     | YES         | null               |
| public       | guides_seen                              | module                    | text                     | NO          | null               |
| public       | guides_seen                              | seen                      | boolean                  | YES         | false              |
| public       | help_articles                            | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | help_articles                            | titre                     | text                     | YES         | null               |
| public       | help_articles                            | contenu                   | text                     | YES         | null               |
| public       | help_articles                            | created_at                | timestamp with time zone | YES         | now()              |
| public       | inventaire_lignes                        | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | inventaire_lignes                        | mama_id                   | uuid                     | NO          | null               |
| public       | inventaire_lignes                        | inventaire_id             | uuid                     | NO          | null               |
| public       | inventaire_lignes                        | produit_id                | uuid                     | NO          | null               |
| public       | inventaire_lignes                        | quantite                  | numeric                  | YES         | null               |
| public       | inventaire_lignes                        | created_at                | timestamp with time zone | YES         | now()              |
| public       | inventaire_lignes                        | updated_at                | timestamp with time zone | YES         | now()              |
| public       | inventaire_lignes                        | actif                     | boolean                  | YES         | true               |
| public       | inventaire_zones                         | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | inventaire_zones                         | mama_id                   | uuid                     | YES         | null               |
| public       | inventaire_zones                         | nom                       | text                     | YES         | null               |
| public       | inventaire_zones                         | created_at                | timestamp with time zone | YES         | now()              |
| public       | inventaires                              | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | inventaires                              | mama_id                   | uuid                     | NO          | null               |
| public       | inventaires                              | date_inventaire           | date                     | YES         | null               |
| public       | inventaires                              | created_at                | timestamp with time zone | YES         | now()              |
| public       | inventaires                              | updated_at                | timestamp with time zone | YES         | now()              |
| public       | inventaires                              | actif                     | boolean                  | YES         | true               |
| public       | inventaires                              | reference                 | text                     | YES         | null               |
| public       | inventaires                              | zone                      | text                     | YES         | null               |
| public       | inventaires                              | date_debut                | date                     | YES         | null               |
| public       | inventaires                              | cloture                   | boolean                  | YES         | false              |
| public       | journal_audit                            | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | journal_audit                            | mama_id                   | uuid                     | NO          | null               |
| public       | journal_audit                            | table_name                | text                     | YES         | null               |
| public       | journal_audit                            | row_id                    | uuid                     | YES         | null               |
| public       | journal_audit                            | operation                 | text                     | YES         | null               |
| public       | journal_audit                            | old_data                  | jsonb                    | YES         | null               |
| public       | journal_audit                            | new_data                  | jsonb                    | YES         | null               |
| public       | journal_audit                            | changed_by                | uuid                     | YES         | null               |
| public       | journal_audit                            | created_at                | timestamp with time zone | YES         | now()              |
| public       | journal_audit                            | updated_at                | timestamp with time zone | YES         | now()              |
| public       | journal_audit                            | actif                     | boolean                  | YES         | true               |
| public       | journal_audit                            | changed_at                | timestamp with time zone | YES         | null               |
| public       | journaux_utilisateur                     | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | journaux_utilisateur                     | mama_id                   | uuid                     | NO          | null               |
| public       | journaux_utilisateur                     | user_id                   | uuid                     | NO          | null               |
| public       | journaux_utilisateur                     | action                    | text                     | YES         | null               |
| public       | journaux_utilisateur                     | details                   | jsonb                    | YES         | null               |
| public       | journaux_utilisateur                     | done_by                   | uuid                     | YES         | null               |
| public       | journaux_utilisateur                     | created_at                | timestamp with time zone | YES         | now()              |
| public       | journaux_utilisateur                     | updated_at                | timestamp with time zone | YES         | now()              |
| public       | journaux_utilisateur                     | actif                     | boolean                  | YES         | true               |
| public       | lignes_bl                                | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | lignes_bl                                | bl_id                     | uuid                     | YES         | null               |
| public       | lignes_bl                                | produit_id                | uuid                     | YES         | null               |
| public       | lignes_bl                                | quantite                  | numeric                  | YES         | null               |
| public       | lignes_bl                                | prix                      | numeric                  | YES         | null               |
| public       | lignes_bl                                | tva                       | numeric                  | YES         | null               |
| public       | lignes_bl                                | created_at                | timestamp with time zone | YES         | now()              |
| public       | logs_securite                            | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | logs_securite                            | mama_id                   | uuid                     | YES         | null               |
| public       | logs_securite                            | user_id                   | uuid                     | YES         | null               |
| public       | logs_securite                            | type                      | text                     | YES         | null               |
| public       | logs_securite                            | ip                        | text                     | YES         | null               |
| public       | logs_securite                            | navigateur                | text                     | YES         | null               |
| public       | logs_securite                            | description               | text                     | YES         | null               |
| public       | logs_securite                            | created_at                | timestamp with time zone | YES         | now()              |
| public       | mamas                                    | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | mamas                                    | created_at                | timestamp with time zone | YES         | now()              |
| public       | mamas                                    | updated_at                | timestamp with time zone | YES         | now()              |
| public       | mamas                                    | actif                     | boolean                  | YES         | true               |
| public       | menu_fiches                              | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | menu_fiches                              | mama_id                   | uuid                     | NO          | null               |
| public       | menu_fiches                              | menu_id                   | uuid                     | NO          | null               |
| public       | menu_fiches                              | fiche_id                  | uuid                     | NO          | null               |
| public       | menu_fiches                              | created_at                | timestamp with time zone | YES         | now()              |
| public       | menu_fiches                              | updated_at                | timestamp with time zone | YES         | now()              |
| public       | menu_fiches                              | actif                     | boolean                  | YES         | true               |
| public       | menus                                    | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | menus                                    | mama_id                   | uuid                     | NO          | null               |
| public       | menus                                    | nom                       | text                     | NO          | null               |
| public       | menus                                    | date                      | date                     | YES         | null               |
| public       | menus                                    | created_at                | timestamp with time zone | YES         | now()              |
| public       | menus                                    | updated_at                | timestamp with time zone | YES         | now()              |
| public       | menus                                    | actif                     | boolean                  | YES         | true               |
| public       | mouvements_centres_cout                  | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | mouvements_centres_cout                  | mama_id                   | uuid                     | NO          | null               |
| public       | mouvements_centres_cout                  | mouvement_id              | uuid                     | YES         | null               |
| public       | mouvements_centres_cout                  | centre_cout_id            | uuid                     | NO          | null               |
| public       | mouvements_centres_cout                  | quantite                  | numeric                  | YES         | null               |
| public       | mouvements_centres_cout                  | valeur                    | numeric                  | YES         | null               |
| public       | mouvements_centres_cout                  | created_at                | timestamp with time zone | YES         | now()              |
| public       | mouvements_centres_cout                  | updated_at                | timestamp with time zone | YES         | now()              |
| public       | mouvements_centres_cout                  | actif                     | boolean                  | YES         | true               |
| public       | notifications                            | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | notifications                            | mama_id                   | uuid                     | YES         | null               |
| public       | notifications                            | user_id                   | uuid                     | YES         | null               |
| public       | notifications                            | titre                     | text                     | YES         | null               |
| public       | notifications                            | texte                     | text                     | YES         | null               |
| public       | notifications                            | lien                      | text                     | YES         | null               |
| public       | notifications                            | type                      | text                     | YES         | null               |
| public       | notifications                            | lu                        | boolean                  | YES         | false              |
| public       | notifications                            | created_at                | timestamp with time zone | YES         | now()              |
| public       | parametres                               | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | parametres                               | mama_id                   | uuid                     | NO          | null               |
| public       | parametres                               | nom                       | text                     | YES         | null               |
| public       | parametres                               | logo                      | text                     | YES         | null               |
| public       | parametres                               | contacts                  | jsonb                    | YES         | null               |
| public       | parametres                               | created_at                | timestamp with time zone | YES         | now()              |
| public       | parametres                               | updated_at                | timestamp with time zone | YES         | now()              |
| public       | parametres                               | actif                     | boolean                  | YES         | true               |
| public       | permissions                              | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | permissions                              | mama_id                   | uuid                     | NO          | null               |
| public       | permissions                              | role_id                   | uuid                     | NO          | null               |
| public       | permissions                              | user_id                   | uuid                     | YES         | null               |
| public       | permissions                              | module                    | text                     | YES         | null               |
| public       | permissions                              | droit                     | text                     | YES         | null               |
| public       | permissions                              | created_at                | timestamp with time zone | YES         | now()              |
| public       | permissions                              | updated_at                | timestamp with time zone | YES         | now()              |
| public       | permissions                              | actif                     | boolean                  | YES         | true               |
| public       | pertes                                   | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | pertes                                   | mama_id                   | uuid                     | NO          | null               |
| public       | pertes                                   | produit_id                | uuid                     | NO          | null               |
| public       | pertes                                   | centre_cout_id            | uuid                     | YES         | null               |
| public       | pertes                                   | date_perte                | date                     | YES         | null               |
| public       | pertes                                   | quantite                  | numeric                  | YES         | null               |
| public       | pertes                                   | motif                     | text                     | YES         | null               |
| public       | pertes                                   | created_by                | uuid                     | YES         | null               |
| public       | pertes                                   | created_at                | timestamp with time zone | YES         | now()              |
| public       | pertes                                   | updated_at                | timestamp with time zone | YES         | now()              |
| public       | pertes                                   | actif                     | boolean                  | YES         | true               |
| public       | planning_previsionnel                    | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | planning_previsionnel                    | mama_id                   | uuid                     | YES         | null               |
| public       | planning_previsionnel                    | date_prevue               | date                     | YES         | null               |
| public       | planning_previsionnel                    | quantite                  | numeric                  | YES         | null               |
| public       | planning_previsionnel                    | produit_id                | uuid                     | YES         | null               |
| public       | planning_previsionnel                    | created_at                | timestamp with time zone | YES         | now()              |
| public       | produits                                 | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | produits                                 | mama_id                   | uuid                     | NO          | null               |
| public       | produits                                 | nom                       | text                     | NO          | null               |
| public       | produits                                 | created_at                | timestamp with time zone | YES         | now()              |
| public       | produits                                 | updated_at                | timestamp with time zone | YES         | now()              |
| public       | produits                                 | actif                     | boolean                  | YES         | true               |
| public       | produits                                 | famille_id                | uuid                     | YES         | null               |
| public       | produits                                 | unite_id                  | uuid                     | YES         | null               |
| public       | produits                                 | code                      | text                     | YES         | null               |
| public       | produits                                 | image                     | text                     | YES         | null               |
| public       | produits                                 | allergenes                | text                     | YES         | null               |
| public       | produits                                 | pmp                       | numeric                  | YES         | null               |
| public       | produits                                 | stock_reel                | numeric                  | YES         | null               |
| public       | produits                                 | stock_min                 | numeric                  | YES         | null               |
| public       | produits                                 | stock_theorique           | numeric                  | YES         | null               |
| public       | produits                                 | main_supplier_id          | uuid                     | YES         | null               |
| public       | promotion_produits                       | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | promotion_produits                       | mama_id                   | uuid                     | NO          | null               |
| public       | promotion_produits                       | promotion_id              | uuid                     | NO          | null               |
| public       | promotion_produits                       | produit_id                | uuid                     | NO          | null               |
| public       | promotion_produits                       | discount                  | numeric                  | YES         | null               |
| public       | promotion_produits                       | prix_promo                | numeric                  | YES         | null               |
| public       | promotion_produits                       | created_at                | timestamp with time zone | YES         | now()              |
| public       | promotion_produits                       | updated_at                | timestamp with time zone | YES         | now()              |
| public       | promotion_produits                       | actif                     | boolean                  | YES         | true               |
| public       | promotions                               | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | promotions                               | mama_id                   | uuid                     | NO          | null               |
| public       | promotions                               | nom                       | text                     | YES         | null               |
| public       | promotions                               | description               | text                     | YES         | null               |
| public       | promotions                               | date_debut                | date                     | YES         | null               |
| public       | promotions                               | date_fin                  | date                     | YES         | null               |
| public       | promotions                               | created_at                | timestamp with time zone | YES         | now()              |
| public       | promotions                               | updated_at                | timestamp with time zone | YES         | now()              |
| public       | promotions                               | actif                     | boolean                  | YES         | true               |
| public       | regles_alertes                           | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | regles_alertes                           | mama_id                   | uuid                     | YES         | null               |
| public       | regles_alertes                           | produit_id                | uuid                     | YES         | null               |
| public       | regles_alertes                           | type                      | text                     | YES         | null               |
| public       | regles_alertes                           | seuil                     | numeric                  | YES         | null               |
| public       | regles_alertes                           | actif                     | boolean                  | YES         | true               |
| public       | regles_alertes                           | created_at                | timestamp with time zone | YES         | now()              |
| public       | requisitions                             | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | requisitions                             | mama_id                   | uuid                     | NO          | null               |
| public       | requisitions                             | produit_id                | uuid                     | NO          | null               |
| public       | requisitions                             | zone_id                   | uuid                     | NO          | null               |
| public       | requisitions                             | date_requisition          | date                     | YES         | null               |
| public       | requisitions                             | quantite                  | numeric                  | YES         | null               |
| public       | requisitions                             | type                      | text                     | YES         | null               |
| public       | requisitions                             | commentaire               | text                     | YES         | null               |
| public       | requisitions                             | auteur_id                 | uuid                     | YES         | null               |
| public       | requisitions                             | created_at                | timestamp with time zone | YES         | now()              |
| public       | requisitions                             | updated_at                | timestamp with time zone | YES         | now()              |
| public       | requisitions                             | actif                     | boolean                  | YES         | true               |
| public       | roles                                    | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | roles                                    | nom                       | text                     | NO          | null               |
| public       | roles                                    | created_at                | timestamp with time zone | YES         | now()              |
| public       | roles                                    | updated_at                | timestamp with time zone | YES         | now()              |
| public       | roles                                    | actif                     | boolean                  | YES         | true               |
| public       | roles                                    | mama_id                   | uuid                     | YES         | null               |
| public       | signalements                             | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | signalements                             | mama_id                   | uuid                     | YES         | null               |
| public       | signalements                             | created_by                | uuid                     | YES         | null               |
| public       | signalements                             | type                      | text                     | YES         | null               |
| public       | signalements                             | description               | text                     | YES         | null               |
| public       | signalements                             | date                      | timestamp with time zone | YES         | null               |
| public       | signalements                             | created_at                | timestamp with time zone | YES         | now()              |
| public       | stock_mouvements                         | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | stock_mouvements                         | mama_id                   | uuid                     | NO          | null               |
| public       | stock_mouvements                         | inventaire_id             | uuid                     | NO          | null               |
| public       | stock_mouvements                         | created_at                | timestamp with time zone | YES         | now()              |
| public       | stock_mouvements                         | updated_at                | timestamp with time zone | YES         | now()              |
| public       | stock_mouvements                         | actif                     | boolean                  | YES         | true               |
| public       | stock_mouvements                         | date                      | timestamp with time zone | YES         | null               |
| public       | stock_mouvements                         | type                      | text                     | YES         | null               |
| public       | stock_mouvements                         | quantite                  | numeric                  | YES         | null               |
| public       | stock_mouvements                         | produit_id                | uuid                     | YES         | null               |
| public       | stock_mouvements                         | zone_source_id            | uuid                     | YES         | null               |
| public       | stock_mouvements                         | zone_destination_id       | uuid                     | YES         | null               |
| public       | stock_mouvements                         | commentaire               | text                     | YES         | null               |
| public       | stock_mouvements                         | auteur_id                 | uuid                     | YES         | null               |
| public       | stocks                                   | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | stocks                                   | mama_id                   | uuid                     | NO          | null               |
| public       | stocks                                   | zone_id                   | uuid                     | NO          | null               |
| public       | stocks                                   | produit_id                | uuid                     | NO          | null               |
| public       | stocks                                   | quantite                  | numeric                  | YES         | null               |
| public       | stocks                                   | created_at                | timestamp with time zone | YES         | now()              |
| public       | stocks                                   | updated_at                | timestamp with time zone | YES         | now()              |
| public       | stocks                                   | actif                     | boolean                  | YES         | true               |
| public       | tableaux_de_bord                         | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | tableaux_de_bord                         | mama_id                   | uuid                     | YES         | null               |
| public       | tableaux_de_bord                         | nom                       | text                     | YES         | null               |
| public       | tableaux_de_bord                         | created_at                | timestamp with time zone | YES         | now()              |
| public       | tache_instances                          | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | tache_instances                          | mama_id                   | uuid                     | NO          | null               |
| public       | tache_instances                          | tache_id                  | uuid                     | NO          | null               |
| public       | tache_instances                          | date_echeance             | date                     | YES         | null               |
| public       | tache_instances                          | statut                    | text                     | YES         | null               |
| public       | tache_instances                          | done_by                   | uuid                     | YES         | null               |
| public       | tache_instances                          | created_at                | timestamp with time zone | YES         | now()              |
| public       | tache_instances                          | updated_at                | timestamp with time zone | YES         | now()              |
| public       | tache_instances                          | actif                     | boolean                  | YES         | true               |
| public       | taches                                   | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | taches                                   | mama_id                   | uuid                     | NO          | null               |
| public       | taches                                   | titre                     | text                     | NO          | null               |
| public       | taches                                   | description               | text                     | YES         | null               |
| public       | taches                                   | assignes                  | ARRAY                    | YES         | null               |
| public       | taches                                   | date_debut                | date                     | YES         | null               |
| public       | taches                                   | delai_jours               | integer                  | YES         | null               |
| public       | taches                                   | date_echeance             | date                     | YES         | null               |
| public       | taches                                   | recurrente                | boolean                  | YES         | null               |
| public       | taches                                   | frequence                 | text                     | YES         | null               |
| public       | taches                                   | priorite                  | text                     | YES         | null               |
| public       | taches                                   | statut                    | text                     | YES         | null               |
| public       | taches                                   | created_by                | uuid                     | YES         | null               |
| public       | taches                                   | created_at                | timestamp with time zone | YES         | now()              |
| public       | taches                                   | updated_at                | timestamp with time zone | YES         | now()              |
| public       | taches                                   | actif                     | boolean                  | YES         | true               |
| public       | tooltips                                 | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | tooltips                                 | mama_id                   | uuid                     | YES         | null               |
| public       | tooltips                                 | champ                     | text                     | YES         | null               |
| public       | tooltips                                 | texte                     | text                     | YES         | null               |
| public       | tooltips                                 | created_at                | timestamp with time zone | YES         | now()              |
| public       | transferts                               | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | transferts                               | mama_id                   | uuid                     | NO          | null               |
| public       | transferts                               | produit_id                | uuid                     | NO          | null               |
| public       | transferts                               | quantite                  | numeric                  | YES         | null               |
| public       | transferts                               | zone_depart               | text                     | YES         | null               |
| public       | transferts                               | zone_arrivee              | text                     | YES         | null               |
| public       | transferts                               | motif                     | text                     | YES         | null               |
| public       | transferts                               | date_transfert            | date                     | YES         | null               |
| public       | transferts                               | created_by                | uuid                     | YES         | null               |
| public       | transferts                               | created_at                | timestamp with time zone | YES         | now()              |
| public       | transferts                               | updated_at                | timestamp with time zone | YES         | now()              |
| public       | transferts                               | actif                     | boolean                  | YES         | true               |
| public       | unites                                   | id                        | uuid                     | NO          | uuid_generate_v4() |
| public       | unites                                   | nom                       | text                     | NO          | null               |
| public       | unites                                   | mama_id                   | uuid                     | NO          | null               |
| public       | unites                                   | actif                     | boolean                  | YES         | true               |
| public       | unites                                   | created_at                | timestamp with time zone | YES         | now()              |
| public       | usage_stats                              | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | usage_stats                              | mama_id                   | uuid                     | YES         | null               |
| public       | usage_stats                              | user_id                   | uuid                     | YES         | null               |
| public       | usage_stats                              | module                    | text                     | YES         | null               |
| public       | usage_stats                              | timestamp                 | timestamp with time zone | YES         | now()              |
| public       | users                                    | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | users                                    | username                  | text                     | NO          | null               |
| public       | users                                    | created_at                | timestamp with time zone | YES         | now()              |
| public       | users                                    | updated_at                | timestamp with time zone | YES         | now()              |
| public       | users                                    | actif                     | boolean                  | YES         | true               |
| public       | utilisateurs                             | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | utilisateurs                             | mama_id                   | uuid                     | NO          | null               |
| public       | utilisateurs                             | nom                       | text                     | YES         | null               |
| public       | utilisateurs                             | created_at                | timestamp with time zone | YES         | now()              |
| public       | utilisateurs                             | updated_at                | timestamp with time zone | YES         | now()              |
| public       | utilisateurs                             | actif                     | boolean                  | YES         | true               |
| public       | utilisateurs                             | role_id                   | uuid                     | YES         | null               |
| public       | utilisateurs                             | access_rights             | jsonb                    | YES         | '[]'::jsonb        |
| public       | utilisateurs                             | auth_id                   | uuid                     | YES         | null               |
| public       | utilisateurs_complets                    | id                        | uuid                     | YES         | null               |
| public       | utilisateurs_complets                    | nom                       | text                     | YES         | null               |
| public       | utilisateurs_complets                    | mama_id                   | uuid                     | YES         | null               |
| public       | utilisateurs_complets                    | created_at                | timestamp with time zone | YES         | null               |
| public       | utilisateurs_complets                    | updated_at                | timestamp with time zone | YES         | null               |
| public       | utilisateurs_complets                    | actif                     | boolean                  | YES         | null               |
| public       | utilisateurs_complets                    | role                      | text                     | YES         | null               |
| public       | v_analytique_stock                       | date                      | timestamp with time zone | YES         | null               |
| public       | v_analytique_stock                       | produit_id                | uuid                     | YES         | null               |
| public       | v_analytique_stock                       | famille                   | text                     | YES         | null               |
| public       | v_analytique_stock                       | activite                  | text                     | YES         | null               |
| public       | v_analytique_stock                       | cost_center_id            | uuid                     | YES         | null               |
| public       | v_analytique_stock                       | cost_center_nom           | text                     | YES         | null               |
| public       | v_analytique_stock                       | quantite                  | numeric                  | YES         | null               |
| public       | v_analytique_stock                       | valeur                    | numeric                  | YES         | null               |
| public       | v_analytique_stock                       | mama_id                   | uuid                     | YES         | null               |
| public       | v_besoins_previsionnels                  | mama_id                   | uuid                     | YES         | null               |
| public       | v_besoins_previsionnels                  | menu_id                   | uuid                     | YES         | null               |
| public       | v_besoins_previsionnels                  | produit_id                | uuid                     | YES         | null               |
| public       | v_besoins_previsionnels                  | quantite                  | numeric                  | YES         | null               |
| public       | v_besoins_previsionnels                  | valeur                    | numeric                  | YES         | null               |
| public       | v_cost_center_month                      | mama_id                   | uuid                     | YES         | null               |
| public       | v_cost_center_month                      | cost_center_id            | uuid                     | YES         | null               |
| public       | v_cost_center_month                      | nom                       | text                     | YES         | null               |
| public       | v_cost_center_month                      | mois                      | text                     | YES         | null               |
| public       | v_cost_center_month                      | total                     | numeric                  | YES         | null               |
| public       | v_cost_center_monthly                    | mama_id                   | uuid                     | YES         | null               |
| public       | v_cost_center_monthly                    | nom                       | text                     | YES         | null               |
| public       | v_cost_center_monthly                    | mois                      | text                     | YES         | null               |
| public       | v_cost_center_monthly                    | montant                   | numeric                  | YES         | null               |
| public       | v_ecarts_inventaire                      | mama_id                   | uuid                     | YES         | null               |
| public       | v_ecarts_inventaire                      | produit_id                | uuid                     | YES         | null               |
| public       | v_ecarts_inventaire                      | date                      | date                     | YES         | null               |
| public       | v_ecarts_inventaire                      | zone                      | uuid                     | YES         | null               |
| public       | v_ecarts_inventaire                      | stock_theorique           | numeric                  | YES         | null               |
| public       | v_ecarts_inventaire                      | stock_reel                | numeric                  | YES         | null               |
| public       | v_ecarts_inventaire                      | ecart                     | numeric                  | YES         | null               |
| public       | v_ecarts_inventaire                      | motif                     | text                     | YES         | null               |
| public       | v_evolution_achats                       | mama_id          | uuid                     | YES         | null               |
| public       | v_evolution_achats                       | produit_id       | uuid                     | YES         | null               |
| public       | v_evolution_achats                       | mois             | text                     | YES         | null               |
| public       | v_evolution_achats                       | montant          | numeric                  | YES         | null               |
| public       | v_fournisseurs_inactifs                  | mama_id                   | uuid                     | YES         | null               |
| public       | v_fournisseurs_inactifs                  | fournisseur_id            | uuid                     | YES         | null               |
| public       | v_fournisseurs_inactifs                  | nom                       | text                     | YES         | null               |
| public       | v_fournisseurs_inactifs                  | fournisseur_actif         | boolean                  | YES         | null               |
| public       | v_fournisseurs_inactifs                  | facture_actif             | boolean                  | YES         | null               |
| public       | v_fournisseurs_inactifs                  | dernier_achat             | date                     | YES         | null               |
| public       | v_monthly_purchases                      | mama_id                   | uuid                     | YES         | null               |
| public       | v_monthly_purchases                      | mois                      | text                     | YES         | null               |
| public       | v_monthly_purchases                      | total                     | numeric                  | YES         | null               |
| public       | v_mouvements_centres_cout_stats          | centre_cout_id            | uuid                     | YES         | null               |
| public       | v_mouvements_centres_cout_stats          | centre_cout               | text                     | YES         | null               |
| public       | v_mouvements_centres_cout_stats          | total_quantite            | numeric                  | YES         | null               |
| public       | v_mouvements_centres_cout_stats          | total_valeur              | numeric                  | YES         | null               |
| public       | v_pmp                                    | mama_id                   | uuid                     | YES         | null               |
| public       | v_pmp                                    | produit_id                | uuid                     | YES         | null               |
| public       | v_pmp                                    | produit_actif             | boolean                  | YES         | null               |
| public       | v_pmp                                    | fournisseur_produit_actif | boolean                  | YES         | null               |
| public       | v_pmp                                    | pmp                       | numeric                  | YES         | null               |
| public       | v_produits_dernier_prix                  | id                        | uuid                     | YES         | null               |
| public       | v_produits_dernier_prix                  | mama_id                   | uuid                     | YES         | null               |
| public       | v_produits_dernier_prix                  | nom                       | text                     | YES         | null               |
| public       | v_produits_dernier_prix                  | famille                   | text                     | YES         | null               |
| public       | v_produits_dernier_prix                  | unite                     | text                     | YES         | null               |
| public       | v_produits_dernier_prix                  | pmp                       | numeric                  | YES         | null               |
| public       | v_produits_dernier_prix                  | stock_reel                | numeric                  | YES         | null               |
| public       | v_produits_dernier_prix                  | stock_min                 | numeric                  | YES         | null               |
| public       | v_produits_dernier_prix                  | stock_theorique           | numeric                  | YES         | null               |
| public       | v_produits_dernier_prix                  | dernier_prix              | numeric                  | YES         | null               |
| public       | v_produits_dernier_prix                  | date_dernier_modification | date                     | YES         | null               |
| public       | v_reco_stockmort                         | mama_id                   | uuid                     | YES         | null               |
| public       | v_reco_stockmort                         | produit_id                | uuid                     | YES         | null               |
| public       | v_reco_stockmort                         | nom                       | text                     | YES         | null               |
| public       | v_reco_stockmort                         | jours_inactif             | integer                  | YES         | null               |
| public       | v_reco_surcout                           | mama_id                   | uuid                     | YES         | null               |
| public       | v_reco_surcout                           | produit_id                | uuid                     | YES         | null               |
| public       | v_reco_surcout                           | nom                       | text                     | YES         | null               |
| public       | v_reco_surcout                           | variation_pct             | numeric                  | YES         | null               |
| public       | v_tendance_prix_produit                  | mama_id                   | uuid                     | YES         | null               |
| public       | v_tendance_prix_produit                  | produit_id                | uuid                     | YES         | null               |
| public       | v_tendance_prix_produit                  | mois                      | text                     | YES         | null               |
| public       | v_tendance_prix_produit                  | prix_moyen                | numeric                  | YES         | null               |
| public       | validation_requests                      | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | validation_requests                      | mama_id                   | uuid                     | YES         | null               |
| public       | validation_requests                      | user_id                   | uuid                     | YES         | null               |
| public       | validation_requests                      | module                    | text                     | YES         | null               |
| public       | validation_requests                      | payload                   | jsonb                    | YES         | null               |
| public       | validation_requests                      | statut                    | text                     | YES         | null               |
| public       | validation_requests                      | created_at                | timestamp with time zone | YES         | now()              |
| public       | ventes_boissons                          | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | ventes_boissons                          | mama_id                   | uuid                     | NO          | null               |
| public       | ventes_boissons                          | boisson_id                | uuid                     | YES         | null               |
| public       | ventes_boissons                          | quantite                  | numeric                  | YES         | null               |
| public       | ventes_boissons                          | date_vente                | date                     | YES         | null               |
| public       | ventes_boissons                          | created_by                | uuid                     | YES         | null               |
| public       | ventes_boissons                          | created_at                | timestamp with time zone | YES         | now()              |
| public       | ventes_boissons                          | updated_at                | timestamp with time zone | YES         | now()              |
| public       | ventes_boissons                          | actif                     | boolean                  | YES         | true               |
| public       | ventes_fiches_carte                      | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | ventes_fiches_carte                      | mama_id                   | uuid                     | NO          | null               |
| public       | ventes_fiches_carte                      | fiche_id                  | uuid                     | NO          | null               |
| public       | ventes_fiches_carte                      | periode                   | date                     | YES         | null               |
| public       | ventes_fiches_carte                      | ventes                    | integer                  | YES         | null               |
| public       | ventes_fiches_carte                      | created_at                | timestamp with time zone | YES         | now()              |
| public       | ventes_fiches_carte                      | updated_at                | timestamp with time zone | YES         | now()              |
| public       | ventes_fiches_carte                      | actif                     | boolean                  | YES         | true               |
| public       | vue_stock_disponible_par_produit_et_zone | produit                   | text                     | YES         | null               |
| public       | vue_stock_disponible_par_produit_et_zone | unite                     | text                     | YES         | null               |
| public       | vue_stock_disponible_par_produit_et_zone | famille                   | text                     | YES         | null               |
| public       | vue_stock_disponible_par_produit_et_zone | zone_stock                | text                     | YES         | null               |
| public       | vue_stock_disponible_par_produit_et_zone | quantite                  | numeric                  | YES         | null               |
| public       | vue_stock_disponible_par_produit_et_zone | updated_at                | timestamp with time zone | YES         | null               |
| public       | vue_stock_disponible_par_produit_et_zone | mama_id                   | uuid                     | YES         | null               |
| public       | zones_stock                              | id                        | uuid                     | NO          | gen_random_uuid()  |
| public       | zones_stock                              | mama_id                   | uuid                     | NO          | null               |
| public       | zones_stock                              | nom                       | text                     | NO          | null               |
| public       | zones_stock                              | created_at                | timestamp with time zone | YES         | now()              |
| public       | zones_stock                              | updated_at                | timestamp with time zone | YES         | now()              |
| public       | zones_stock                              | actif                     | boolean                  | YES         | true               |


| table_name                | column_name    | constraint_name                |
| ------------------------- | -------------- | ------------------------------ |
| access_rights             | id             | access_rights_pkey             |
| api_keys                  | id             | api_keys_pkey                  |
| auth_double_facteur       | id             | auth_double_facteur_pkey       |
| bons_livraison            | id             | bons_livraison_pkey            |
| catalogue_updates         | id             | catalogue_updates_pkey         |
| centres_de_cout           | id             | centres_de_cout_pkey           |
| commandes                 | id             | commandes_pkey                 |
| compta_mapping            | id             | compta_mapping_pkey            |
| consentements_utilisateur | id             | consentements_utilisateur_pkey |
| documentation             | id             | documentation_pkey             |
| documents                 | id             | documents_pkey                 |
| etapes_onboarding         | id             | etapes_onboarding_pkey         |
| facture_lignes            | id             | facture_lignes_pkey            |
| factures                  | id             | factures_pkey                  |
| familles                  | id             | familles_pkey                  |
| feedback                  | id             | feedback_pkey                  |
| fiche_cout_history        | id             | fiche_cout_history_pkey        |
| fiche_lignes              | id             | fiche_lignes_pkey              |
| fiche_prix_history        | id             | fiche_prix_history_pkey        |
| fiches                    | id             | fiches_pkey                    |
| fiches_techniques         | id             | fiches_techniques_pkey         |
| fournisseur_contacts      | id             | fournisseur_contacts_pkey      |
| fournisseur_notes         | id             | fournisseur_notes_pkey         |
| fournisseur_produits      | id             | fournisseur_produits_pkey      |
| fournisseurs              | id             | fournisseurs_pkey              |
| fournisseurs_api_config   | fournisseur_id | fournisseurs_api_config_pkey   |
| fournisseurs_api_config   | mama_id        | fournisseurs_api_config_pkey   |
| gadgets                   | id             | gadgets_pkey                   |
| guides_seen               | user_id        | guides_seen_pkey               |
| guides_seen               | module         | guides_seen_pkey               |
| help_articles             | id             | help_articles_pkey             |
| inventaire_lignes         | id             | inventaire_lignes_pkey         |
| inventaire_zones          | id             | inventaire_zones_pkey          |
| inventaires               | id             | inventaires_pkey               |
| journal_audit             | id             | journal_audit_pkey             |
| journaux_utilisateur      | id             | journaux_utilisateur_pkey      |
| lignes_bl                 | id             | lignes_bl_pkey                 |
| logs_securite             | id             | logs_securite_pkey             |
| mamas                     | id             | mamas_pkey                     |
| menu_fiches               | id             | menu_fiches_pkey               |
| menus                     | id             | menus_pkey                     |
| mouvements_centres_cout   | id             | mouvements_centres_cout_pkey   |
| notifications             | id             | notifications_pkey             |
| parametres                | id             | parametres_pkey                |
| permissions               | id             | permissions_pkey               |
| pertes                    | id             | pertes_pkey                    |
| planning_previsionnel     | id             | planning_previsionnel_pkey     |
| produits                  | id             | produits_pkey                  |
| promotion_produits        | id             | promotion_produits_pkey        |
| promotions                | id             | promotions_pkey                |
| regles_alertes            | id             | regles_alertes_pkey            |
| requisitions              | id             | requisitions_pkey              |
| roles                     | id             | roles_pkey                     |
| signalements              | id             | signalements_pkey              |
| stock_mouvements          | id             | stock_mouvements_pkey          |
| stocks                    | id             | stocks_pkey                    |
| tableaux_de_bord          | id             | tableaux_de_bord_pkey          |
| tache_instances           | id             | tache_instances_pkey           |
| taches                    | id             | taches_pkey                    |
| tooltips                  | id             | tooltips_pkey                  |
| transferts                | id             | transferts_pkey                |
| unites                    | id             | unites_pkey                    |
| usage_stats               | id             | usage_stats_pkey               |
| users                     | id             | users_pkey                     |
| users                     | id             | users_pkey                     |
| utilisateurs              | id             | utilisateurs_pkey              |
| validation_requests       | id             | validation_requests_pkey       |
| ventes_boissons           | id             | ventes_boissons_pkey           |
| ventes_fiches_carte       | id             | ventes_fiches_carte_pkey       |
| zones_stock               | id             | zones_stock_pkey               |


| table_name                | column_name         | referenced_table | referenced_column | constraint_name                             |
| ------------------------- | ------------------- | ---------------- | ----------------- | ------------------------------------------- |
| access_rights             | mama_id             | mamas            | id                | access_rights_mama_id_fkey                  |
| access_rights             | role_id             | roles            | id                | access_rights_role_id_fkey                  |
| api_keys                  | mama_id             | mamas            | id                | api_keys_mama_id_fkey                       |
| api_keys                  | user_id             | utilisateurs     | id                | api_keys_user_id_fkey                       |
| bons_livraison            | fournisseur_id      | fournisseurs     | id                | bons_livraison_fournisseur_id_fkey          |
| bons_livraison            | mama_id             | mamas            | id                | bons_livraison_mama_id_fkey                 |
| catalogue_updates         | fournisseur_id      | fournisseurs     | id                | catalogue_updates_fournisseur_id_fkey       |
| catalogue_updates         | mama_id             | mamas            | id                | catalogue_updates_mama_id_fkey              |
| catalogue_updates         | produit_id          | produits         | id                | catalogue_updates_produit_id_fkey           |
| centres_de_cout           | mama_id             | mamas            | id                | centres_de_cout_mama_id_fkey                |
| commandes                 | fournisseur_id      | fournisseurs     | id                | commandes_fournisseur_id_fkey               |
| commandes                 | mama_id             | mamas            | id                | commandes_mama_id_fkey                      |
| compta_mapping            | mama_id             | mamas            | id                | compta_mapping_mama_id_fkey                 |
| consentements_utilisateur | mama_id             | mamas            | id                | consentements_utilisateur_mama_id_fkey      |
| consentements_utilisateur | user_id             | utilisateurs     | id                | consentements_utilisateur_user_id_fkey      |
| documentation             | mama_id             | mamas            | id                | documentation_mama_id_fkey                  |
| documents                 | mama_id             | mamas            | id                | documents_mama_id_fkey                      |
| etapes_onboarding         | mama_id             | mamas            | id                | etapes_onboarding_mama_id_fkey              |
| facture_lignes            | facture_id          | factures         | id                | facture_lignes_facture_id_fkey              |
| facture_lignes            | mama_id             | mamas            | id                | facture_lignes_mama_id_fkey                 |
| facture_lignes            | produit_id          | produits         | id                | facture_lignes_produit_id_fkey              |
| factures                  | fournisseur_id      | fournisseurs     | id                | factures_fournisseur_id_fkey                |
| factures                  | mama_id             | mamas            | id                | factures_mama_id_fkey                       |
| familles                  | mama_id             | mamas            | id                | familles_mama_id_fkey                       |
| feedback                  | mama_id             | mamas            | id                | feedback_mama_id_fkey                       |
| feedback                  | user_id             | utilisateurs     | id                | feedback_user_id_fkey                       |
| fiche_cout_history        | changed_by          | users            | id                | fk_fiche_cout_history_changed_by            |
| fiche_cout_history        | fiche_id            | fiches           | id                | fiche_cout_history_fiche_id_fkey            |
| fiche_cout_history        | mama_id             | mamas            | id                | fiche_cout_history_mama_id_fkey             |
| fiche_lignes              | fiche_id            | fiches           | id                | fiche_lignes_fiche_id_fkey                  |
| fiche_lignes              | mama_id             | mamas            | id                | fiche_lignes_mama_id_fkey                   |
| fiche_lignes              | produit_id          | produits         | id                | fiche_lignes_produit_id_fkey                |
| fiche_prix_history        | changed_by          | users            | id                | fk_fiche_prix_history_changed_by            |
| fiche_prix_history        | fiche_id            | fiches           | id                | fiche_prix_history_fiche_id_fkey            |
| fiche_prix_history        | mama_id             | mamas            | id                | fiche_prix_history_mama_id_fkey             |
| fiches                    | mama_id             | mamas            | id                | fiches_mama_id_fkey                         |
| fiches_techniques         | fiche_id            | fiches           | id                | fiches_techniques_fiche_id_fkey             |
| fiches_techniques         | mama_id             | mamas            | id                | fiches_techniques_mama_id_fkey              |
| fournisseur_contacts      | fournisseur_id      | fournisseurs     | id                | fournisseur_contacts_fournisseur_id_fkey    |
| fournisseur_contacts      | mama_id             | mamas            | id                | fournisseur_contacts_mama_id_fkey           |
| fournisseur_notes         | fournisseur_id      | fournisseurs     | id                | fournisseur_notes_fournisseur_id_fkey       |
| fournisseur_notes         | mama_id             | mamas            | id                | fournisseur_notes_mama_id_fkey              |
| fournisseur_produits      | fournisseur_id      | fournisseurs     | id                | fk_fournisseur_produits_fournisseur_id      |
| fournisseur_produits      | fournisseur_id      | fournisseurs     | id                | fournisseur_produits_fournisseur_id_fkey    |
| fournisseur_produits      | mama_id             | mamas            | id                | fournisseur_produits_mama_id_fkey           |
| fournisseur_produits      | produit_id          | produits         | id                | fournisseur_produits_produit_id_fkey        |
| fournisseur_produits      | produit_id          | produits         | id                | fk_fournisseur_produits_produit_id          |
| fournisseurs              | mama_id             | mamas            | id                | fournisseurs_mama_id_fkey                   |
| fournisseurs_api_config   | fournisseur_id      | fournisseurs     | id                | fournisseurs_api_config_fournisseur_id_fkey |
| fournisseurs_api_config   | mama_id             | mamas            | id                | fournisseurs_api_config_mama_id_fkey        |
| gadgets                   | tableau_id          | tableaux_de_bord | id                | gadgets_tableau_id_fkey                     |
| guides_seen               | mama_id             | mamas            | id                | guides_seen_mama_id_fkey                    |
| guides_seen               | user_id             | utilisateurs     | id                | guides_seen_user_id_fkey                    |
| inventaire_lignes         | inventaire_id       | inventaires      | id                | inventaire_lignes_inventaire_id_fkey        |
| inventaire_lignes         | mama_id             | mamas            | id                | inventaire_lignes_mama_id_fkey              |
| inventaire_lignes         | produit_id          | produits         | id                | inventaire_lignes_produit_id_fkey           |
| inventaire_zones          | mama_id             | mamas            | id                | inventaire_zones_mama_id_fkey               |
| inventaires               | mama_id             | mamas            | id                | inventaires_mama_id_fkey                    |
| journal_audit             | changed_by          | users            | id                | journal_audit_changed_by_fkey               |
| journal_audit             | mama_id             | mamas            | id                | journal_audit_mama_id_fkey                  |
| journaux_utilisateur      | done_by             | users            | id                | journaux_utilisateur_done_by_fkey           |
| journaux_utilisateur      | mama_id             | mamas            | id                | journaux_utilisateur_mama_id_fkey           |
| journaux_utilisateur      | user_id             | users            | id                | journaux_utilisateur_user_id_fkey           |
| lignes_bl                 | bl_id               | bons_livraison   | id                | lignes_bl_bl_id_fkey                        |
| lignes_bl                 | produit_id          | produits         | id                | lignes_bl_produit_id_fkey                   |
| logs_securite             | mama_id             | mamas            | id                | logs_securite_mama_id_fkey                  |
| logs_securite             | user_id             | utilisateurs     | id                | logs_securite_user_id_fkey                  |
| menu_fiches               | fiche_id            | fiches           | id                | menu_fiches_fiche_id_fkey                   |
| menu_fiches               | mama_id             | mamas            | id                | menu_fiches_mama_id_fkey                    |
| menu_fiches               | menu_id             | menus            | id                | menu_fiches_menu_id_fkey                    |
| menus                     | mama_id             | mamas            | id                | menus_mama_id_fkey                          |
| mouvements_centres_cout   | centre_cout_id      | centres_de_cout  | id                | mouvements_centres_cout_centre_cout_id_fkey |
| mouvements_centres_cout   | mama_id             | mamas            | id                | mouvements_centres_cout_mama_id_fkey        |
| notifications             | mama_id             | mamas            | id                | notifications_mama_id_fkey                  |
| notifications             | user_id             | utilisateurs     | id                | notifications_user_id_fkey                  |
| parametres                | mama_id             | mamas            | id                | parametres_mama_id_fkey                     |
| permissions               | mama_id             | mamas            | id                | permissions_mama_id_fkey                    |
| permissions               | role_id             | roles            | id                | fk_permissions_role                         |
| permissions               | user_id             | users            | id                | fk_permissions_user                         |
| pertes                    | centre_cout_id      | centres_de_cout  | id                | pertes_centre_cout_id_fkey                  |
| pertes                    | created_by          | users            | id                | pertes_created_by_fkey                      |
| pertes                    | mama_id             | mamas            | id                | pertes_mama_id_fkey                         |
| pertes                    | produit_id          | produits         | id                | pertes_produit_id_fkey                      |
| planning_previsionnel     | mama_id             | mamas            | id                | planning_previsionnel_mama_id_fkey          |
| planning_previsionnel     | produit_id          | produits         | id                | planning_previsionnel_produit_id_fkey       |
| produits                  | famille_id          | familles         | id                | produits_famille_id_fkey                    |
| produits                  | main_supplier_id    | fournisseurs     | id                | produits_main_supplier_id_fkey              |
| produits                  | mama_id             | mamas            | id                | produits_mama_id_fkey                       |
| produits                  | unite_id            | unites           | id                | produits_unite_id_fkey                      |
| promotion_produits        | mama_id             | mamas            | id                | promotion_produits_mama_id_fkey             |
| promotion_produits        | produit_id          | produits         | id                | promotion_produits_produit_id_fkey          |
| promotion_produits        | promotion_id        | promotions       | id                | promotion_produits_promotion_id_fkey        |
| promotions                | mama_id             | mamas            | id                | promotions_mama_id_fkey                     |
| regles_alertes            | mama_id             | mamas            | id                | regles_alertes_mama_id_fkey                 |
| regles_alertes            | produit_id          | produits         | id                | regles_alertes_produit_id_fkey              |
| requisitions              | auteur_id           | users            | id                | requisitions_auteur_id_fkey                 |
| requisitions              | mama_id             | mamas            | id                | requisitions_mama_id_fkey                   |
| requisitions              | produit_id          | produits         | id                | requisitions_produit_id_fkey                |
| requisitions              | zone_id             | zones_stock      | id                | requisitions_zone_id_fkey                   |
| roles                     | mama_id             | mamas            | id                | roles_mama_id_fkey                          |
| signalements              | created_by          | utilisateurs     | id                | signalements_created_by_fkey                |
| signalements              | mama_id             | mamas            | id                | signalements_mama_id_fkey                   |
| stock_mouvements          | auteur_id           | utilisateurs     | id                | stock_mouvements_auteur_id_fkey             |
| stock_mouvements          | inventaire_id       | inventaires      | id                | stock_mouvements_inventaire_id_fkey         |
| stock_mouvements          | mama_id             | mamas            | id                | stock_mouvements_mama_id_fkey               |
| stock_mouvements          | produit_id          | produits         | id                | stock_mouvements_produit_id_fkey            |
| stock_mouvements          | zone_destination_id | zones_stock      | id                | stock_mouvements_zone_destination_id_fkey   |
| stock_mouvements          | zone_source_id      | zones_stock      | id                | stock_mouvements_zone_source_id_fkey        |
| stocks                    | mama_id             | mamas            | id                | stocks_mama_id_fkey                         |
| stocks                    | produit_id          | produits         | id                | stocks_produit_id_fkey                      |
| stocks                    | zone_id             | zones_stock      | id                | stocks_zone_id_fkey                         |
| tableaux_de_bord          | mama_id             | mamas            | id                | tableaux_de_bord_mama_id_fkey               |
| tache_instances           | done_by             | users            | id                | tache_instances_done_by_fkey                |
| tache_instances           | mama_id             | mamas            | id                | tache_instances_mama_id_fkey                |
| tache_instances           | tache_id            | taches           | id                | tache_instances_tache_id_fkey               |
| taches                    | created_by          | users            | id                | taches_created_by_fkey                      |
| taches                    | mama_id             | mamas            | id                | taches_mama_id_fkey                         |
| tooltips                  | mama_id             | mamas            | id                | tooltips_mama_id_fkey                       |
| transferts                | created_by          | users            | id                | transferts_created_by_fkey                  |
| transferts                | mama_id             | mamas            | id                | transferts_mama_id_fkey                     |
| transferts                | produit_id          | produits         | id                | transferts_produit_id_fkey                  |
| unites                    | mama_id             | mamas            | id                | unites_mama_id_fkey                         |
| usage_stats               | mama_id             | mamas            | id                | usage_stats_mama_id_fkey                    |
| usage_stats               | user_id             | utilisateurs     | id                | usage_stats_user_id_fkey                    |
| utilisateurs              | mama_id             | mamas            | id                | utilisateurs_mama_id_fkey                   |
| utilisateurs              | role_id             | roles            | id                | utilisateurs_role_id_fkey                   |
| validation_requests       | mama_id             | mamas            | id                | validation_requests_mama_id_fkey            |
| validation_requests       | user_id             | utilisateurs     | id                | validation_requests_user_id_fkey            |
| ventes_boissons           | boisson_id          | produits         | id                | ventes_boissons_boisson_id_fkey             |
| ventes_boissons           | created_by          | users            | id                | ventes_boissons_created_by_fkey             |
| ventes_boissons           | mama_id             | mamas            | id                | ventes_boissons_mama_id_fkey                |
| ventes_fiches_carte       | fiche_id            | fiches           | id                | ventes_fiches_carte_fiche_id_fkey           |
| ventes_fiches_carte       | mama_id             | mamas            | id                | ventes_fiches_carte_mama_id_fkey            |
| zones_stock               | mama_id             | mamas            | id                | zones_stock_mama_id_fkey                    |



| view_name                                | view_definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ---------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| utilisateurs_complets                    |  SELECT u.id,
    u.nom,
    u.mama_id,
    u.created_at,
    u.updated_at,
    u.actif,
    r.nom AS role
   FROM (utilisateurs u
     LEFT JOIN roles r ON ((u.role_id = r.id)));                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| v_analytique_stock                       |  SELECT m.date,
    m.produit_id,
    fam.nom AS famille,
    cc.activite,
    mc.centre_cout_id AS cost_center_id,
    cc.nom AS cost_center_nom,
    m.quantite,
    mc.valeur,
    m.mama_id
   FROM ((((stock_mouvements m
     LEFT JOIN produits p ON ((p.id = m.produit_id)))
     LEFT JOIN familles fam ON (((fam.id = p.famille_id) AND (fam.mama_id = p.mama_id))))
     LEFT JOIN mouvements_centres_cout mc ON ((mc.mouvement_id = m.id)))
     LEFT JOIN centres_de_cout cc ON ((cc.id = mc.centre_cout_id)));                                                                                                                                                                                                                                                                                                                                                                                        |
| v_besoins_previsionnels                  |  SELECT m.mama_id,
    m.id AS menu_id,
    fl.produit_id,
    sum((fl.quantite * COALESCE(f.portions, (1)::numeric))) AS quantite,
    sum(((fl.quantite * COALESCE(f.portions, (1)::numeric)) * COALESCE(p.pmp, (0)::numeric))) AS valeur
   FROM ((((menus m
     JOIN menu_fiches mf ON ((mf.menu_id = m.id)))
     JOIN fiches f ON ((f.id = mf.fiche_id)))
     JOIN fiche_lignes fl ON ((fl.fiche_id = f.id)))
     LEFT JOIN produits p ON ((p.id = fl.produit_id)))
  GROUP BY m.mama_id, m.id, fl.produit_id;                                                                                                                                                                                                                                                                                                                                                                                             |
| v_cost_center_month                      |  SELECT NULL::uuid AS mama_id,
    NULL::uuid AS cost_center_id,
    NULL::text AS nom,
    NULL::text AS mois,
    NULL::numeric AS total;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| v_cost_center_monthly                    |  SELECT NULL::uuid AS mama_id,
    NULL::text AS nom,
    NULL::text AS mois,
    NULL::numeric AS montant;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| v_ecarts_inventaire                      |  SELECT NULL::uuid AS mama_id,
    NULL::uuid AS produit_id,
    NULL::date AS date,
    NULL::uuid AS zone,
    NULL::numeric AS stock_theorique,
    NULL::numeric AS stock_reel,
    NULL::numeric AS ecart,
    NULL::text AS motif;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| v_fournisseurs_inactifs                  |  SELECT f.mama_id,
    f.id AS fournisseur_id,
    f.nom,
    f.actif AS fournisseur_actif,
    bool_or(fc.actif) AS facture_actif,
    max(fc.date_facture) AS dernier_achat
   FROM (fournisseurs f
     LEFT JOIN factures fc ON ((fc.fournisseur_id = f.id)))
  WHERE (f.mama_id IS NOT NULL)
  GROUP BY f.mama_id, f.id, f.nom
 HAVING (COALESCE((max(fc.date_facture))::timestamp without time zone, (CURRENT_DATE - '83 years 3 mons'::interval)) < (CURRENT_DATE - '6 mons'::interval));                                                                                                                                                                                                                                                                                                                                                                                                                    |
| v_monthly_purchases                      |  SELECT NULL::uuid AS mama_id,
    NULL::text AS mois,
    NULL::numeric AS total;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| v_mouvements_centres_cout_stats          |  SELECT c.id AS centre_cout_id,
    c.nom AS centre_cout,
    sum(m.quantite) AS total_quantite,
    sum(m.valeur) AS total_valeur
   FROM (mouvements_centres_cout m
     JOIN centres_de_cout c ON ((m.centre_cout_id = c.id)))
  WHERE ((m.actif = true) AND (c.actif = true))
  GROUP BY c.id, c.nom;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| v_pmp                                    |  SELECT p.mama_id,
    p.id AS produit_id,
    p.actif AS produit_actif,
    bool_or(sp.actif) AS fournisseur_produit_actif,
    COALESCE(avg(sp.prix_achat), (0)::numeric) AS pmp
   FROM (produits p
     LEFT JOIN fournisseur_produits sp ON (((sp.produit_id = p.id) AND (sp.mama_id = p.mama_id))))
  GROUP BY p.mama_id, p.id, p.actif;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| v_produits_dernier_prix                  |  SELECT p.id,
    p.mama_id,
    p.nom,
    f.nom AS famille,
    u.nom AS unite,
    p.pmp,
    p.stock_reel,
    p.stock_min,
    p.stock_theorique,
    fp.prix_achat AS dernier_prix,
    fp.date_livraison AS date_dernier_modification
   FROM (((produits p
     LEFT JOIN unites u ON ((p.unite_id = u.id)))
     LEFT JOIN familles f ON ((p.famille_id = f.id)))
     LEFT JOIN ( SELECT sub.produit_id,
            sub.date_livraison,
            sub.prix_achat
           FROM ( SELECT fournisseur_produits.produit_id,
                    fournisseur_produits.date_livraison,
                    fournisseur_produits.prix_achat,
                    row_number() OVER (PARTITION BY fournisseur_produits.produit_id ORDER BY fournisseur_produits.date_livraison DESC) AS rn
                   FROM fournisseur_produits) sub
          WHERE (sub.rn = 1)) fp ON ((fp.produit_id = p.id))); |
| v_reco_stockmort                         |  SELECT NULL::uuid AS mama_id,
    NULL::uuid AS produit_id,
    NULL::text AS nom,
    NULL::integer AS jours_inactif;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| v_reco_surcout                           |  SELECT NULL::uuid AS mama_id,
    NULL::uuid AS produit_id,
    NULL::text AS nom,
    NULL::numeric AS variation_pct;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| v_tendance_prix_produit                  |  SELECT NULL::uuid AS mama_id,
    NULL::uuid AS produit_id,
    NULL::text AS mois,
    NULL::numeric AS prix_moyen;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| vue_stock_disponible_par_produit_et_zone |  SELECT p.nom AS produit,
    un.nom AS unite,
    f.nom AS famille,
    zs.nom AS zone_stock,
    s.quantite,
    s.updated_at,
    s.mama_id
   FROM ((((stocks s
     JOIN produits p ON ((s.produit_id = p.id)))
     LEFT JOIN familles f ON ((p.famille_id = f.id)))
     LEFT JOIN unites un ON ((p.unite_id = un.id)))
     LEFT JOIN zones_stock zs ON ((s.zone_id = zs.id)))
  WHERE (s.actif = true);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |


  | routine_name               | routine_definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| -------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| advanced_stats             | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| apply_stock_from_achat     | 
BEGIN
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| calcul_ecarts_inventaire   | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| compare_fiche              | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| consolidated_stats         | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| current_user_mama_id       | 
  SELECT mama_id FROM utilisateurs WHERE id = auth.uid() LIMIT 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| dashboard_stats            | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| disable_two_fa             | 
BEGIN
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| enable_two_fa              | 
BEGIN
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| fn_calc_budgets            | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| import_invoice             | 
DECLARE
  fac_id uuid;
  supp_id uuid;
BEGIN
  SELECT id INTO supp_id
    FROM fournisseurs
   WHERE nom = payload->>'supplier_name'
     AND mama_id = current_user_mama_id()
   LIMIT 1;

  INSERT INTO factures(reference, date_facture, fournisseur_id, montant, statut, mama_id)
    VALUES (
      payload->>'reference',
      (payload->>'date')::date,
      supp_id,
      (payload->>'total')::numeric,
      'en attente',
      current_user_mama_id()
    )
    RETURNING id INTO fac_id;

  INSERT INTO facture_lignes(facture_id, produit_id, quantite, prix, mama_id)
  SELECT fac_id,
         p.id,
         (l->>'quantity')::numeric,
         (l->>'unit_price')::numeric,
         current_user_mama_id()
    FROM jsonb_array_elements(payload->'lines') AS l
    LEFT JOIN produits p
      ON p.code = l->>'product_code'
     AND p.mama_id = current_user_mama_id();

  RETURN fac_id;
END;
 |
| journaliser_modifs_produit | 
BEGIN
  -- TODO: stub pour log des modifications
  RETURN NEW;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| maj_stock_produit          | 
BEGIN
  -- TODO: implémentation future
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| mettre_a_jour_pmp_produit  | 
BEGIN
  -- TODO: implémentation future
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| rafraichir_cout_fiche      | 
BEGIN
  -- TODO: implémentation future
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| rafraichir_total_facture   | 
BEGIN
  -- TODO: implémentation future
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| send_email_notification    | 
BEGIN
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| send_notification_webhook  | 
BEGIN
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| set_updated_at             | 
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| stats_achats_fournisseur   | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| stats_achats_fournisseurs  | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| stats_cost_centers         | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| stats_multi_mamas          | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| stats_rotation_produit     | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| suggest_cost_centers       | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| top_produits               | 
BEGIN
  RETURN '{}'::jsonb;
END;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |


| table_name                | index_name                                 | index_method | indexdef                                                                                                                              |
| ------------------------- | ------------------------------------------ | ------------ | ------------------------------------------------------------------------------------------------------------------------------------- |
| access_rights             | access_rights_pkey                         | btree        | CREATE UNIQUE INDEX access_rights_pkey ON public.access_rights USING btree (id)                                                       |
| access_rights             | idx_access_rights_mama_id                  | btree        | CREATE INDEX idx_access_rights_mama_id ON public.access_rights USING btree (mama_id)                                                  |
| access_rights             | idx_access_rights_mama_role_module         | btree        | CREATE INDEX idx_access_rights_mama_role_module ON public.access_rights USING btree (mama_id, role_id, module)                        |
| access_rights             | uniq_access_rights_mama_role_module        | btree        | CREATE UNIQUE INDEX uniq_access_rights_mama_role_module ON public.access_rights USING btree (mama_id, role_id, module)                |
| api_keys                  | api_keys_pkey                              | btree        | CREATE UNIQUE INDEX api_keys_pkey ON public.api_keys USING btree (id)                                                                 |
| api_keys                  | idx_api_keys_mama_id                       | btree        | CREATE INDEX idx_api_keys_mama_id ON public.api_keys USING btree (mama_id)                                                            |
| auth_double_facteur       | auth_double_facteur_pkey                   | btree        | CREATE UNIQUE INDEX auth_double_facteur_pkey ON public.auth_double_facteur USING btree (id)                                           |
| bons_livraison            | bons_livraison_pkey                        | btree        | CREATE UNIQUE INDEX bons_livraison_pkey ON public.bons_livraison USING btree (id)                                                     |
| bons_livraison            | idx_bons_livraison_mama_id                 | btree        | CREATE INDEX idx_bons_livraison_mama_id ON public.bons_livraison USING btree (mama_id)                                                |
| catalogue_updates         | catalogue_updates_pkey                     | btree        | CREATE UNIQUE INDEX catalogue_updates_pkey ON public.catalogue_updates USING btree (id)                                               |
| catalogue_updates         | idx_catalogue_updates_mama_id              | btree        | CREATE INDEX idx_catalogue_updates_mama_id ON public.catalogue_updates USING btree (mama_id)                                          |
| centres_de_cout           | centres_de_cout_pkey                       | btree        | CREATE UNIQUE INDEX centres_de_cout_pkey ON public.centres_de_cout USING btree (id)                                                   |
| centres_de_cout           | idx_centres_de_cout_created_at             | btree        | CREATE INDEX idx_centres_de_cout_created_at ON public.centres_de_cout USING btree (created_at)                                        |
| centres_de_cout           | idx_centres_de_cout_mama_id                | btree        | CREATE INDEX idx_centres_de_cout_mama_id ON public.centres_de_cout USING btree (mama_id)                                              |
| commandes                 | commandes_pkey                             | btree        | CREATE UNIQUE INDEX commandes_pkey ON public.commandes USING btree (id)                                                               |
| commandes                 | idx_commandes_mama_id                      | btree        | CREATE INDEX idx_commandes_mama_id ON public.commandes USING btree (mama_id)                                                          |
| compta_mapping            | compta_mapping_pkey                        | btree        | CREATE UNIQUE INDEX compta_mapping_pkey ON public.compta_mapping USING btree (id)                                                     |
| compta_mapping            | idx_compta_mapping_mama_id                 | btree        | CREATE INDEX idx_compta_mapping_mama_id ON public.compta_mapping USING btree (mama_id)                                                |
| consentements_utilisateur | consentements_utilisateur_pkey             | btree        | CREATE UNIQUE INDEX consentements_utilisateur_pkey ON public.consentements_utilisateur USING btree (id)                               |
| consentements_utilisateur | idx_consentements_utilisateur_mama         | btree        | CREATE INDEX idx_consentements_utilisateur_mama ON public.consentements_utilisateur USING btree (mama_id)                             |
| consentements_utilisateur | idx_consentements_utilisateur_mama_id      | btree        | CREATE INDEX idx_consentements_utilisateur_mama_id ON public.consentements_utilisateur USING btree (mama_id)                          |
| consentements_utilisateur | idx_consentements_utilisateur_user         | btree        | CREATE INDEX idx_consentements_utilisateur_user ON public.consentements_utilisateur USING btree (user_id)                             |
| documentation             | documentation_pkey                         | btree        | CREATE UNIQUE INDEX documentation_pkey ON public.documentation USING btree (id)                                                       |
| documentation             | idx_documentation_mama_id                  | btree        | CREATE INDEX idx_documentation_mama_id ON public.documentation USING btree (mama_id)                                                  |
| documents                 | documents_pkey                             | btree        | CREATE UNIQUE INDEX documents_pkey ON public.documents USING btree (id)                                                               |
| documents                 | idx_documents_mama_id                      | btree        | CREATE INDEX idx_documents_mama_id ON public.documents USING btree (mama_id)                                                          |
| etapes_onboarding         | etapes_onboarding_pkey                     | btree        | CREATE UNIQUE INDEX etapes_onboarding_pkey ON public.etapes_onboarding USING btree (id)                                               |
| etapes_onboarding         | idx_etapes_onboarding_mama_id              | btree        | CREATE INDEX idx_etapes_onboarding_mama_id ON public.etapes_onboarding USING btree (mama_id)                                          |
| facture_lignes            | facture_lignes_pkey                        | btree        | CREATE UNIQUE INDEX facture_lignes_pkey ON public.facture_lignes USING btree (id)                                                     |
| facture_lignes            | idx_facture_lignes_mama_id                 | btree        | CREATE INDEX idx_facture_lignes_mama_id ON public.facture_lignes USING btree (mama_id)                                                |
| factures                  | factures_pkey                              | btree        | CREATE UNIQUE INDEX factures_pkey ON public.factures USING btree (id)                                                                 |
| factures                  | idx_factures_created_at                    | btree        | CREATE INDEX idx_factures_created_at ON public.factures USING btree (created_at)                                                      |
| factures                  | idx_factures_fournisseur_id                | btree        | CREATE INDEX idx_factures_fournisseur_id ON public.factures USING btree (fournisseur_id)                                              |
| factures                  | idx_factures_mama_id                       | btree        | CREATE INDEX idx_factures_mama_id ON public.factures USING btree (mama_id)                                                            |
| factures                  | uniq_factures_numero                       | btree        | CREATE UNIQUE INDEX uniq_factures_numero ON public.factures USING btree (mama_id, fournisseur_id, numero, date_facture)               |
| familles                  | familles_pkey                              | btree        | CREATE UNIQUE INDEX familles_pkey ON public.familles USING btree (id)                                                                 |
| familles                  | idx_familles_mama_id                       | btree        | CREATE INDEX idx_familles_mama_id ON public.familles USING btree (mama_id)                                                            |
| feedback                  | feedback_pkey                              | btree        | CREATE UNIQUE INDEX feedback_pkey ON public.feedback USING btree (id)                                                                 |
| feedback                  | idx_feedback_mama_id                       | btree        | CREATE INDEX idx_feedback_mama_id ON public.feedback USING btree (mama_id)                                                            |
| fiche_cout_history        | fiche_cout_history_pkey                    | btree        | CREATE UNIQUE INDEX fiche_cout_history_pkey ON public.fiche_cout_history USING btree (id)                                             |
| fiche_cout_history        | idx_fiche_cout_history_mama_id             | btree        | CREATE INDEX idx_fiche_cout_history_mama_id ON public.fiche_cout_history USING btree (mama_id)                                        |
| fiche_lignes              | fiche_lignes_pkey                          | btree        | CREATE UNIQUE INDEX fiche_lignes_pkey ON public.fiche_lignes USING btree (id)                                                         |
| fiche_lignes              | idx_fiche_lignes_mama_id                   | btree        | CREATE INDEX idx_fiche_lignes_mama_id ON public.fiche_lignes USING btree (mama_id)                                                    |
| fiche_lignes              | idx_fiche_lignes_produit_id                | btree        | CREATE INDEX idx_fiche_lignes_produit_id ON public.fiche_lignes USING btree (produit_id)                                              |
| fiche_prix_history        | fiche_prix_history_pkey                    | btree        | CREATE UNIQUE INDEX fiche_prix_history_pkey ON public.fiche_prix_history USING btree (id)                                             |
| fiche_prix_history        | idx_fiche_prix_history_mama_id             | btree        | CREATE INDEX idx_fiche_prix_history_mama_id ON public.fiche_prix_history USING btree (mama_id)                                        |
| fiches                    | fiches_pkey                                | btree        | CREATE UNIQUE INDEX fiches_pkey ON public.fiches USING btree (id)                                                                     |
| fiches                    | idx_fiches_created_at                      | btree        | CREATE INDEX idx_fiches_created_at ON public.fiches USING btree (created_at)                                                          |
| fiches                    | idx_fiches_mama_id                         | btree        | CREATE INDEX idx_fiches_mama_id ON public.fiches USING btree (mama_id)                                                                |
| fiches_techniques         | fiches_techniques_pkey                     | btree        | CREATE UNIQUE INDEX fiches_techniques_pkey ON public.fiches_techniques USING btree (id)                                               |
| fiches_techniques         | idx_fiches_techniques_mama_id              | btree        | CREATE INDEX idx_fiches_techniques_mama_id ON public.fiches_techniques USING btree (mama_id)                                          |
| fournisseur_contacts      | fournisseur_contacts_pkey                  | btree        | CREATE UNIQUE INDEX fournisseur_contacts_pkey ON public.fournisseur_contacts USING btree (id)                                         |
| fournisseur_contacts      | idx_fournisseur_contacts_mama_id           | btree        | CREATE INDEX idx_fournisseur_contacts_mama_id ON public.fournisseur_contacts USING btree (mama_id)                                    |
| fournisseur_notes         | fournisseur_notes_pkey                     | btree        | CREATE UNIQUE INDEX fournisseur_notes_pkey ON public.fournisseur_notes USING btree (id)                                               |
| fournisseur_notes         | idx_fournisseur_notes_mama_id              | btree        | CREATE INDEX idx_fournisseur_notes_mama_id ON public.fournisseur_notes USING btree (mama_id)                                          |
| fournisseur_produits      | fournisseur_produits_pkey                  | btree        | CREATE UNIQUE INDEX fournisseur_produits_pkey ON public.fournisseur_produits USING btree (id)                                         |
| fournisseur_produits      | idx_fournisseur_produits_mama_id           | btree        | CREATE INDEX idx_fournisseur_produits_mama_id ON public.fournisseur_produits USING btree (mama_id)                                    |
| fournisseur_produits      | idx_fp_date                                | btree        | CREATE INDEX idx_fp_date ON public.fournisseur_produits USING btree (date_livraison)                                                  |
| fournisseur_produits      | idx_fp_fournisseur                         | btree        | CREATE INDEX idx_fp_fournisseur ON public.fournisseur_produits USING btree (fournisseur_id)                                           |
| fournisseur_produits      | idx_fp_produit                             | btree        | CREATE INDEX idx_fp_produit ON public.fournisseur_produits USING btree (produit_id)                                                   |
| fournisseur_produits      | uniq_fournisseur_produits                  | btree        | CREATE UNIQUE INDEX uniq_fournisseur_produits ON public.fournisseur_produits USING btree (produit_id, fournisseur_id, date_livraison) |
| fournisseurs              | fournisseurs_pkey                          | btree        | CREATE UNIQUE INDEX fournisseurs_pkey ON public.fournisseurs USING btree (id)                                                         |
| fournisseurs              | idx_fournisseurs_created_at                | btree        | CREATE INDEX idx_fournisseurs_created_at ON public.fournisseurs USING btree (created_at)                                              |
| fournisseurs              | idx_fournisseurs_mama_id                   | btree        | CREATE INDEX idx_fournisseurs_mama_id ON public.fournisseurs USING btree (mama_id)                                                    |
| fournisseurs_api_config   | fournisseurs_api_config_pkey               | btree        | CREATE UNIQUE INDEX fournisseurs_api_config_pkey ON public.fournisseurs_api_config USING btree (fournisseur_id, mama_id)              |
| fournisseurs_api_config   | idx_fournisseurs_api_config_fournisseur_id | btree        | CREATE INDEX idx_fournisseurs_api_config_fournisseur_id ON public.fournisseurs_api_config USING btree (fournisseur_id)                |
| fournisseurs_api_config   | idx_fournisseurs_api_config_mama_id        | btree        | CREATE INDEX idx_fournisseurs_api_config_mama_id ON public.fournisseurs_api_config USING btree (mama_id)                              |
| gadgets                   | gadgets_pkey                               | btree        | CREATE UNIQUE INDEX gadgets_pkey ON public.gadgets USING btree (id)                                                                   |
| guides_seen               | guides_seen_pkey                           | btree        | CREATE UNIQUE INDEX guides_seen_pkey ON public.guides_seen USING btree (user_id, module)                                              |
| guides_seen               | idx_guides_seen_mama_id                    | btree        | CREATE INDEX idx_guides_seen_mama_id ON public.guides_seen USING btree (mama_id)                                                      |
| help_articles             | help_articles_pkey                         | btree        | CREATE UNIQUE INDEX help_articles_pkey ON public.help_articles USING btree (id)                                                       |
| inventaire_lignes         | idx_inventaire_lignes_mama_id              | btree        | CREATE INDEX idx_inventaire_lignes_mama_id ON public.inventaire_lignes USING btree (mama_id)                                          |
| inventaire_lignes         | inventaire_lignes_pkey                     | btree        | CREATE UNIQUE INDEX inventaire_lignes_pkey ON public.inventaire_lignes USING btree (id)                                               |
| inventaire_zones          | idx_inventaire_zones_mama_id               | btree        | CREATE INDEX idx_inventaire_zones_mama_id ON public.inventaire_zones USING btree (mama_id)                                            |
| inventaire_zones          | inventaire_zones_pkey                      | btree        | CREATE UNIQUE INDEX inventaire_zones_pkey ON public.inventaire_zones USING btree (id)                                                 |
| inventaires               | idx_inventaires_created_at                 | btree        | CREATE INDEX idx_inventaires_created_at ON public.inventaires USING btree (created_at)                                                |
| inventaires               | idx_inventaires_mama_id                    | btree        | CREATE INDEX idx_inventaires_mama_id ON public.inventaires USING btree (mama_id)                                                      |
| inventaires               | inventaires_pkey                           | btree        | CREATE UNIQUE INDEX inventaires_pkey ON public.inventaires USING btree (id)                                                           |
| journal_audit             | idx_journal_audit_mama_id                  | btree        | CREATE INDEX idx_journal_audit_mama_id ON public.journal_audit USING btree (mama_id)                                                  |
| journal_audit             | journal_audit_pkey                         | btree        | CREATE UNIQUE INDEX journal_audit_pkey ON public.journal_audit USING btree (id)                                                       |
| journaux_utilisateur      | idx_journaux_utilisateur_mama_id           | btree        | CREATE INDEX idx_journaux_utilisateur_mama_id ON public.journaux_utilisateur USING btree (mama_id)                                    |
| journaux_utilisateur      | journaux_utilisateur_pkey                  | btree        | CREATE UNIQUE INDEX journaux_utilisateur_pkey ON public.journaux_utilisateur USING btree (id)                                         |
| lignes_bl                 | lignes_bl_pkey                             | btree        | CREATE UNIQUE INDEX lignes_bl_pkey ON public.lignes_bl USING btree (id)                                                               |
| logs_securite             | idx_logs_securite_mama_id                  | btree        | CREATE INDEX idx_logs_securite_mama_id ON public.logs_securite USING btree (mama_id)                                                  |
| logs_securite             | logs_securite_pkey                         | btree        | CREATE UNIQUE INDEX logs_securite_pkey ON public.logs_securite USING btree (id)                                                       |
| mamas                     | mamas_pkey                                 | btree        | CREATE UNIQUE INDEX mamas_pkey ON public.mamas USING btree (id)                                                                       |
| menu_fiches               | idx_menu_fiches_fiche_id                   | btree        | CREATE INDEX idx_menu_fiches_fiche_id ON public.menu_fiches USING btree (fiche_id)                                                    |
| menu_fiches               | idx_menu_fiches_mama_id                    | btree        | CREATE INDEX idx_menu_fiches_mama_id ON public.menu_fiches USING btree (mama_id)                                                      |
| menu_fiches               | menu_fiches_pkey                           | btree        | CREATE UNIQUE INDEX menu_fiches_pkey ON public.menu_fiches USING btree (id)                                                           |
| menus                     | idx_menus_mama_id                          | btree        | CREATE INDEX idx_menus_mama_id ON public.menus USING btree (mama_id)                                                                  |
| menus                     | menus_pkey                                 | btree        | CREATE UNIQUE INDEX menus_pkey ON public.menus USING btree (id)                                                                       |
| mouvements_centres_cout   | idx_mouvements_centres_cout_mama_id        | btree        | CREATE INDEX idx_mouvements_centres_cout_mama_id ON public.mouvements_centres_cout USING btree (mama_id)                              |
| mouvements_centres_cout   | mouvements_centres_cout_pkey               | btree        | CREATE UNIQUE INDEX mouvements_centres_cout_pkey ON public.mouvements_centres_cout USING btree (id)                                   |
| notifications             | idx_notifications_mama_id                  | btree        | CREATE INDEX idx_notifications_mama_id ON public.notifications USING btree (mama_id)                                                  |
| notifications             | notifications_pkey                         | btree        | CREATE UNIQUE INDEX notifications_pkey ON public.notifications USING btree (id)                                                       |
| parametres                | idx_parametres_mama_id                     | btree        | CREATE INDEX idx_parametres_mama_id ON public.parametres USING btree (mama_id)                                                        |
| parametres                | parametres_pkey                            | btree        | CREATE UNIQUE INDEX parametres_pkey ON public.parametres USING btree (id)                                                             |
| permissions               | idx_permissions_mama_id                    | btree        | CREATE INDEX idx_permissions_mama_id ON public.permissions USING btree (mama_id)                                                      |
| permissions               | permissions_pkey                           | btree        | CREATE UNIQUE INDEX permissions_pkey ON public.permissions USING btree (id)                                                           |
| pertes                    | idx_pertes_mama_id                         | btree        | CREATE INDEX idx_pertes_mama_id ON public.pertes USING btree (mama_id)                                                                |
| pertes                    | pertes_pkey                                | btree        | CREATE UNIQUE INDEX pertes_pkey ON public.pertes USING btree (id)                                                                     |
| planning_previsionnel     | idx_planning_previsionnel_mama_id          | btree        | CREATE INDEX idx_planning_previsionnel_mama_id ON public.planning_previsionnel USING btree (mama_id)                                  |
| planning_previsionnel     | planning_previsionnel_pkey                 | btree        | CREATE UNIQUE INDEX planning_previsionnel_pkey ON public.planning_previsionnel USING btree (id)                                       |
| produits                  | idx_produits_created_at                    | btree        | CREATE INDEX idx_produits_created_at ON public.produits USING btree (created_at)                                                      |
| produits                  | idx_produits_famille_id                    | btree        | CREATE INDEX idx_produits_famille_id ON public.produits USING btree (famille_id)                                                      |
| produits                  | idx_produits_main_supplier                 | btree        | CREATE INDEX idx_produits_main_supplier ON public.produits USING btree (main_supplier_id)                                             |
| produits                  | idx_produits_mama_id                       | btree        | CREATE INDEX idx_produits_mama_id ON public.produits USING btree (mama_id)                                                            |
| produits                  | idx_produits_unite_id                      | btree        | CREATE INDEX idx_produits_unite_id ON public.produits USING btree (unite_id)                                                          |
| produits                  | produits_pkey                              | btree        | CREATE UNIQUE INDEX produits_pkey ON public.produits USING btree (id)                                                                 |
| promotion_produits        | idx_promotion_produits_mama_id             | btree        | CREATE INDEX idx_promotion_produits_mama_id ON public.promotion_produits USING btree (mama_id)                                        |
| promotion_produits        | promotion_produits_pkey                    | btree        | CREATE UNIQUE INDEX promotion_produits_pkey ON public.promotion_produits USING btree (id)                                             |
| promotions                | idx_promotions_created_at                  | btree        | CREATE INDEX idx_promotions_created_at ON public.promotions USING btree (created_at)                                                  |
| promotions                | idx_promotions_mama_id                     | btree        | CREATE INDEX idx_promotions_mama_id ON public.promotions USING btree (mama_id)                                                        |
| promotions                | promotions_pkey                            | btree        | CREATE UNIQUE INDEX promotions_pkey ON public.promotions USING btree (id)                                                             |
| regles_alertes            | idx_regles_alertes_mama_id                 | btree        | CREATE INDEX idx_regles_alertes_mama_id ON public.regles_alertes USING btree (mama_id)                                                |
| regles_alertes            | regles_alertes_pkey                        | btree        | CREATE UNIQUE INDEX regles_alertes_pkey ON public.regles_alertes USING btree (id)                                                     |
| requisitions              | idx_requisitions_mama_id                   | btree        | CREATE INDEX idx_requisitions_mama_id ON public.requisitions USING btree (mama_id)                                                    |
| requisitions              | requisitions_pkey                          | btree        | CREATE UNIQUE INDEX requisitions_pkey ON public.requisitions USING btree (id)                                                         |
| roles                     | idx_roles_mama_id                          | btree        | CREATE INDEX idx_roles_mama_id ON public.roles USING btree (mama_id)                                                                  |
| roles                     | roles_pkey                                 | btree        | CREATE UNIQUE INDEX roles_pkey ON public.roles USING btree (id)                                                                       |
| signalements              | idx_signalements_mama_id                   | btree        | CREATE INDEX idx_signalements_mama_id ON public.signalements USING btree (mama_id)                                                    |
| signalements              | signalements_pkey                          | btree        | CREATE UNIQUE INDEX signalements_pkey ON public.signalements USING btree (id)                                                         |
| stock_mouvements          | idx_stock_mouvements_created_at            | btree        | CREATE INDEX idx_stock_mouvements_created_at ON public.stock_mouvements USING btree (created_at)                                      |
| stock_mouvements          | idx_stock_mouvements_date                  | btree        | CREATE INDEX idx_stock_mouvements_date ON public.stock_mouvements USING btree (date)                                                  |
| stock_mouvements          | idx_stock_mouvements_mama_id               | btree        | CREATE INDEX idx_stock_mouvements_mama_id ON public.stock_mouvements USING btree (mama_id)                                            |
| stock_mouvements          | idx_stock_mouvements_produit               | btree        | CREATE INDEX idx_stock_mouvements_produit ON public.stock_mouvements USING btree (produit_id)                                         |
| stock_mouvements          | stock_mouvements_pkey                      | btree        | CREATE UNIQUE INDEX stock_mouvements_pkey ON public.stock_mouvements USING btree (id)                                                 |
| stocks                    | idx_stocks_mama_id                         | btree        | CREATE INDEX idx_stocks_mama_id ON public.stocks USING btree (mama_id)                                                                |
| stocks                    | stocks_pkey                                | btree        | CREATE UNIQUE INDEX stocks_pkey ON public.stocks USING btree (id)                                                                     |
| tableaux_de_bord          | idx_tableaux_de_bord_mama_id               | btree        | CREATE INDEX idx_tableaux_de_bord_mama_id ON public.tableaux_de_bord USING btree (mama_id)                                            |
| tableaux_de_bord          | tableaux_de_bord_pkey                      | btree        | CREATE UNIQUE INDEX tableaux_de_bord_pkey ON public.tableaux_de_bord USING btree (id)                                                 |
| tache_instances           | idx_tache_instances_mama_id                | btree        | CREATE INDEX idx_tache_instances_mama_id ON public.tache_instances USING btree (mama_id)                                              |
| tache_instances           | tache_instances_pkey                       | btree        | CREATE UNIQUE INDEX tache_instances_pkey ON public.tache_instances USING btree (id)                                                   |
| taches                    | idx_taches_created_at                      | btree        | CREATE INDEX idx_taches_created_at ON public.taches USING btree (created_at)                                                          |
| taches                    | idx_taches_mama_id                         | btree        | CREATE INDEX idx_taches_mama_id ON public.taches USING btree (mama_id)                                                                |
| taches                    | taches_pkey                                | btree        | CREATE UNIQUE INDEX taches_pkey ON public.taches USING btree (id)                                                                     |
| tooltips                  | idx_tooltips_mama_id                       | btree        | CREATE INDEX idx_tooltips_mama_id ON public.tooltips USING btree (mama_id)                                                            |
| tooltips                  | tooltips_pkey                              | btree        | CREATE UNIQUE INDEX tooltips_pkey ON public.tooltips USING btree (id)                                                                 |
| transferts                | idx_transferts_mama_id                     | btree        | CREATE INDEX idx_transferts_mama_id ON public.transferts USING btree (mama_id)                                                        |
| transferts                | transferts_pkey                            | btree        | CREATE UNIQUE INDEX transferts_pkey ON public.transferts USING btree (id)                                                             |
| unites                    | idx_unites_mama_id                         | btree        | CREATE INDEX idx_unites_mama_id ON public.unites USING btree (mama_id)                                                                |
| unites                    | unites_pkey                                | btree        | CREATE UNIQUE INDEX unites_pkey ON public.unites USING btree (id)                                                                     |
| usage_stats               | idx_usage_stats_mama_id                    | btree        | CREATE INDEX idx_usage_stats_mama_id ON public.usage_stats USING btree (mama_id)                                                      |
| usage_stats               | usage_stats_pkey                           | btree        | CREATE UNIQUE INDEX usage_stats_pkey ON public.usage_stats USING btree (id)                                                           |
| users                     | users_pkey                                 | btree        | CREATE UNIQUE INDEX users_pkey ON public.users USING btree (id)                                                                       |
| utilisateurs              | idx_utilisateurs_auth_id                   | btree        | CREATE INDEX idx_utilisateurs_auth_id ON public.utilisateurs USING btree (auth_id)                                                    |
| utilisateurs              | idx_utilisateurs_mama_id                   | btree        | CREATE INDEX idx_utilisateurs_mama_id ON public.utilisateurs USING btree (mama_id)                                                    |
| utilisateurs              | utilisateurs_pkey                          | btree        | CREATE UNIQUE INDEX utilisateurs_pkey ON public.utilisateurs USING btree (id)                                                         |
| validation_requests       | idx_validation_requests_mama_id            | btree        | CREATE INDEX idx_validation_requests_mama_id ON public.validation_requests USING btree (mama_id)                                      |
| validation_requests       | validation_requests_pkey                   | btree        | CREATE UNIQUE INDEX validation_requests_pkey ON public.validation_requests USING btree (id)                                           |
| ventes_boissons           | idx_ventes_boissons_mama_id                | btree        | CREATE INDEX idx_ventes_boissons_mama_id ON public.ventes_boissons USING btree (mama_id)                                              |
| ventes_boissons           | ventes_boissons_pkey                       | btree        | CREATE UNIQUE INDEX ventes_boissons_pkey ON public.ventes_boissons USING btree (id)                                                   |
| ventes_fiches_carte       | idx_ventes_fiches_carte_mama_id            | btree        | CREATE INDEX idx_ventes_fiches_carte_mama_id ON public.ventes_fiches_carte USING btree (mama_id)                                      |
| ventes_fiches_carte       | ventes_fiches_carte_pkey                   | btree        | CREATE UNIQUE INDEX ventes_fiches_carte_pkey ON public.ventes_fiches_carte USING btree (id)                                           |
| zones_stock               | idx_zones_stock_mama_id                    | btree        | CREATE INDEX idx_zones_stock_mama_id ON public.zones_stock USING btree (mama_id)                                                      |
| zones_stock               | zones_stock_pkey                           | btree        | CREATE UNIQUE INDEX zones_stock_pkey ON public.zones_stock USING btree (id)                                                           |


| table_name          | trigger_name                           | action_timing | event_manipulation | action_statement                              |
| ------------------- | -------------------------------------- | ------------- | ------------------ | --------------------------------------------- |
| produits            | trg_journal_produit                    | AFTER         | INSERT             | EXECUTE FUNCTION journaliser_modifs_produit() |
| produits            | trg_journal_produit                    | AFTER         | DELETE             | EXECUTE FUNCTION journaliser_modifs_produit() |
| produits            | trg_journal_produit                    | AFTER         | UPDATE             | EXECUTE FUNCTION journaliser_modifs_produit() |
| taches              | trg_set_updated_at_taches              | BEFORE        | UPDATE             | EXECUTE FUNCTION set_updated_at()             |
| ventes_fiches_carte | trg_set_updated_at_ventes_fiches_carte | BEFORE        | UPDATE             | EXECUTE FUNCTION set_updated_at()             |

| v_evolution_achats                      |  SELECT f.mama_id,
    fl.produit_id,
    to_char(date_trunc('month', f.date_facture), 'YYYY-MM') AS mois,
    sum(fl.prix_unitaire * fl.quantite) AS montant
   FROM (facture_lignes fl
     JOIN factures f ON ((fl.facture_id = f.id)))
  WHERE ((fl.actif = true) AND (f.actif = true))
  GROUP BY f.mama_id, fl.produit_id, to_char(date_trunc('month', f.date_facture), 'YYYY-MM');
