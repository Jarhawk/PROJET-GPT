=== ‚úÖ MODULE : Dashboard.jsx ===
- Route : /dashboard
- Objectif : synth√®se rapide des stocks et factures
- Fonctions : chargement des stats via useDashboard, filtres par p√©riode
- S√©curit√© : queries filtr√©es par mama_id
- Tests simul√©s : navigation initiale vers /dashboard apr√®s login
- Routes li√©es : ProtectedRoute dans router.jsx
- Affichages dynamiques : cartes de stats
- D√©pendances : hooks useDashboardStats, AuthContext

=== ‚úÖ MODULE : Produits.jsx ===
- Route : /produits
- Objectif : afficher la liste des produits stock√©s avec pagination
- Fonctions : recherche, filtre famille, filtre actif/inactif, tri par colonnes, import/export Excel, cr√©ation/duplication de produit
- S√©curit√© : supabase policies sur table products (mama_id)
- Tests simul√©s : duplication via test/Produits.test.jsx
- Routes : priv√© /produits et /produits/:id
- Stats : historique prix via ProduitDetail modal
- D√©pendances : hook useProducts, composants ProduitFormModal, ProduitDetail

=== ‚úÖ MODULE : ProduitDetail.jsx ===
- Route : /produits/:id
- Objectif : afficher les informations d√©taill√©es et l'historique du produit
- Fonctions : graphique d'√©volution des prix, duplication et archivage
- S√©curit√© : requ√™te Supabase filtr√©e par mama_id

=== ‚úÖ MODULE : Stock.jsx ===
- Route : /stock
- Objectif : consulter stocks en zones et lancer mouvements
- Fonctions : recherche, filtre zone, export Excel, cr√©ation mouvement, d√©tail rotation
- S√©curit√© : useStock v√©rifie user.mama_id
- Tests : StockDetail.test.jsx pour stats rotation
- Routes : prot√©g√© /stock
- Stats dynamiques : valorisation stock
- D√©pendances : StockMouvementForm, StockDetail, hook useStock

=== ‚úÖ MODULE : Fournisseurs.jsx ===
- Route : /fournisseurs
- Objectif : gestion des fournisseurs
- Fonctions : recherche, filtre actif, import/export Excel, cr√©ation/modif
- S√©curit√© : RLS fournisseurs via mama_id
- Routes : /fournisseurs et detail
- D√©pendances : hook useFournisseurs

=== ‚úÖ MODULE : Factures.jsx ===
- Route : /factures
- Objectif : suivi des factures fournisseurs
- Fonctions : filtres statut/fournisseur, export Excel, cr√©ation, consultation d√©tail
- S√©curit√© : policies factures et lignes filtr√©es sur mama_id
- D√©pendances : hooks useInvoices, useSuppliers

=== ‚úÖ MODULE : Fiches.jsx ===
- Route : /fiches
- Objectif : fiches techniques (recettes)
- Fonctions : ajout/√©dition lignes dynamiques, calcul co√ªt total et par portion, upload image Storage, export Excel/PDF
- S√©curit√© : table fiches RLS sur mama_id
- Routes : /fiches, /fiches/:id
- D√©pendances : hook useFiches, useProducts
- Affichages dynamiques : calcul co√ªts en temps r√©el

=== ‚úÖ MODULE : Menus.jsx ===
- Route : /menus
- Objectif : planification menus et liens fiches
- Fonctions : filtre date, recherche nom, export Excel, ajout/modif/suppression, affichage d√©tail
- S√©curit√© : table menus RLS
- D√©pendances : hook useMenus, useFiches

=== ‚úÖ MODULE : Inventaire.jsx ===
- Route : /inventaire
- Objectif : r√©alisation d'inventaires p√©riodiques
- Fonctions : cr√©ation compl√®te avec lignes, cl√¥ture, export Excel, mouvements li√©s
- S√©curit√© : v√©rification mama_id dans useInventaires
- D√©pendances : hook useInventaires, composants InventaireForm

=== ‚úÖ MODULE : Mouvements.jsx ===
- Route : /mouvements
- Objectif : historique mouvements de stock
- Fonctions : filtre date/produit, ventilation centres de co√ªts via CostCenterAllocationModal
- S√©curit√© : table mouvements_stock RLS

=== ‚úÖ MODULE : Taches.jsx ===
- Route : /taches
- Objectif : gestionnaire de t√¢ches planifi√©es
- Fonctions : cr√©ation, √©ch√©ances, assignation, suivi de statut
- S√©curit√© : hooks useTasks filtre par mama_id

=== ‚úÖ MODULE : Promotions.jsx ===
- Route : /promotions
- Objectif : op√©rations commerciales sur produits
- Fonctions : cr√©ation promotion, application prix remis√©
- S√©curit√© : table promotions RLS

=== ‚úÖ MODULE : Reporting.jsx ===
- Route : /reporting
- Objectif : statistiques et graphiques consolid√©s
- Fonctions : s√©lection de p√©riode, vues multi-sites, graphes via GraphMultiZone
- S√©curit√© : vues SQL prot√©g√©es

=== ‚úÖ MODULE : Auth ===
- Pages : Login.jsx, UpdatePassword.jsx, ResetPassword.jsx, TwoFactorSetup.jsx
- Objectif : authentification Supabase avec 2FA optionnel
- Fonctions : login par email/password, setup TOTP, v√©rification code
- S√©curit√© : AuthContext r√©cup√®re role, mama_id, access_rights
- Redirection automatique Router.jsx si non authentifi√©

Login.jsx : formulaire d'authentification principal
UpdatePassword.jsx : permet de changer son mot de passe
ResetPassword.jsx : r√©initialisation via lien envoy√© par email
TwoFactorSetup.jsx : configuration de la double authentification

=== ‚úÖ MODULE : Login.jsx ===
- Route : /login
- Objectif : formulaire de connexion Supabase

=== ‚úÖ MODULE : UpdatePassword.jsx ===
- Route : /update-password
- Objectif : changement de mot de passe apr√®s connexion

=== ‚úÖ MODULE : ResetPassword.jsx ===
- Route : /reset-password
- Objectif : r√©initialiser le mot de passe via token

=== ‚úÖ MODULE : Param√©trage ===
- Pages : AccessRights.jsx, Roles.jsx, Permissions.jsx, Mamas.jsx, InviteUser.jsx
- Objectif : configuration des r√¥les, acc√®s et param√®tres mama
- S√©curit√© : hooks correspondants filtrent mama_id et r√¥le

=== ‚úÖ MODULE : AuditTrail.jsx ===
- Route : /audit-trail
- Objectif : suivre modifications importantes (audit_entries)
- Fonction : filtrage par table/p√©riode

=== ‚úÖ MODULE : Alertes.jsx ===
- Route : /alertes
- Objectif : configurer des seuils de stock
- Fonctions : ajout/suppression de r√®gle, recherche produit
- S√©curit√© : useAlerts filtre mama_id
- D√©pendances : useAlerts, useProducts

=== ‚úÖ MODULE : Documents.jsx ===
- Route : /documents
- Objectif : centraliser fichiers et liens
- Fonctions : ajout document, recherche
- S√©curit√© : table documents RLS
- D√©pendances : useDocuments

=== ‚úÖ MODULE : Onboarding.jsx ===
- Route : /onboarding
- Objectif : guider l'initialisation
- Fonctions : suivi √©tapes via useOnboarding

=== ‚úÖ MODULE : Planning.jsx ===
- Route : /planning
- Objectif : planning pr√©visionnel
- Fonctions : cr√©ation entr√©e, listing
- S√©curit√© : usePlanning filtre mama_id

=== ‚úÖ MODULE : Pertes.jsx ===
- Route : /pertes
- Objectif : enregistrer pertes et dons
- Fonctions : saisie produit/quantit√©, suppression
- S√©curit√© : usePertes filtre mama_id

=== ‚úÖ MODULE : Requisitions.jsx ===
- Route : /requisitions
- Objectif : sorties de stock planifi√©es
- Fonctions : cr√©ation, export Excel/PDF, filtres
- S√©curit√© : table requisitions RLS

=== ‚úÖ MODULE : Transferts.jsx ===
- Route : /transferts
- Objectif : transferts inter-zones ou sites
- Fonctions : cr√©ation transfert, historique
- S√©curit√© : table transferts RLS

=== ‚úÖ MODULE : Stats & Reporting avanc√© ===
- Routes : /stats/*
- Objectif : analyses statistiques d√©taill√©es
- Fonctions : graphiques, export Excel, filtres dynamiques
- S√©curit√© : vues SQL s√©curis√©es

=== ‚úÖ MODULE : BarManager.jsx ===
- Route : /bar-manager
- Objectif : analyse ventes boissons
- Fonctions : top ventes, export, graphique
- S√©curit√© : requ√™tes filtr√©es sur mama_id

=== ‚úÖ MODULE : Validations.jsx ===
- Route : /validations
- Objectif : demandes d'approbation
- Fonctions : envoi et mise √† jour statut
- S√©curit√© : useValidations et r√¥le admin

=== ‚úÖ MODULE : Mobile ===
- Pages : MobileAccueil.jsx, MobileInventaire.jsx, MobileMouvement.jsx, MobileRequisition.jsx
- Objectif : fonctionnalit√©s cl√© en mobilit√©
- S√©curit√© : m√™mes contr√¥les AuthContext

=== ‚úÖ MODULE : Utilisateurs.jsx ===
- Route : /parametrage/utilisateurs
- Objectif : gestion des comptes utilisateurs
- Fonctions : recherche email, filtre actif/inactif, export Excel, activation/d√©sactivation
- S√©curit√© : hook useUsers applique RLS par mama_id (admins seulement)
- D√©pendances : useUsers, AuthContext

=== ‚úÖ MODULE : HelpCenter / AideContextuelle ===
- Route : /aide
- Objectif : articles d'aide et FAQ
- Fonctions : chargement des articles via useHelpArticles
- S√©curit√© : accessible apr√®s authentification

=== ‚úÖ MODULE : Carte.jsx ===
- Route : /carte
- Objectif : gestion rapide des fiches √† la carte (nourriture/boisson)
- Fonctions : modification prix vente, food cost en temps r√©el
- S√©curit√© : requ√™tes filtr√©es sur mama_id via useCarte

=== ‚úÖ MODULE : CartePlats.jsx ===
- Route : /carte-plats
- Objectif : ajuster le prix de vente des fiches actives
- Fonctions : saisie prix, calcul food cost
- S√©curit√© : policies fiches RLS

=== ‚úÖ MODULE : MenuEngineering.jsx ===
- Route : /menu-engineering
- Objectif : analyser les performances des plats
- Fonctions : saisie ventes, classification Star/Puzzle/Dog/Plow Horse
- S√©curit√© : useMenuEngineering filtre mama_id

=== ‚úÖ MODULE : Journal.jsx ===
- Route : /journal
- Objectif : journal d'audit des actions
- Fonctions : recherche texte, filtre dates, export Excel
- S√©curit√© : useLogs filtre mama_id

=== ‚úÖ MODULE : CostBoisson.jsx ===
- Route : /costboisson
- Objectif : suivi du co√ªt des boissons
- Fonctions : export Excel/PDF, saisie ventes, graphique top ventes
- S√©curit√© : acc√®s filtr√© sur mama_id

=== ‚úÖ MODULE : Signalements.jsx ===
- Route : /signalements
- Objectif : affichage des signalements utilisateurs
- Fonctions : listing simple
- S√©curit√© : useSignalements filtre mama_id

=== ‚úÖ MODULE : Simulation.jsx ===
- Route : /simulation
- Objectif : d√©monstration front bas√©e sur les signalements
- Fonctions : chargement supabase et rendu cartes
- S√©curit√© : prot√©g√© par AuthContext

=== ‚úÖ MODULE : Ecarts.jsx ===
- Route : /ecarts
- Objectif : visualiser les √©carts d'inventaire
- Fonctions : recherche produit, export CSV
- S√©curit√© : useEcartsInventaire filtre mama_id

=== ‚úÖ MODULE : Pages Stats d√©taill√©es ===
- Routes : /stats/stock, /stats/cost-centers, /stats/cost-centers-pivot, /stats/fiches, /stats/consolidation, /stats/advanced
- Objectif : analyses pr√©cises du stock et des co√ªts
- Fonctions : graphiques recharts, export Excel, filtres p√©riode
- S√©curit√© : vues SQL prot√©g√©es

=== ‚úÖ MODULE : Debug ===
- Pages : /debug/auth, Debug.jsx, DebugUser.jsx
- Objectif : inspection de l'AuthContext pour les d√©veloppeurs
- S√©curit√© : r√©serv√© r√¥le admin via access_rights

=== ‚úÖ MODULE : AuthDebug.jsx ===
- Route : /debug/auth
- Objectif : tester la connexion Supabase et afficher les claims

=== ‚úÖ MODULE : DebugUser.jsx ===
- Route : /debug/user
- Objectif : visualiser l'objet utilisateur en temps r√©el

=== ‚úÖ MODULE : FactureForm.jsx / FactureDetail.jsx ===
- Routes : /factures/nouveau, /factures/:id
- Objectif : cr√©ation et √©dition de factures fournisseurs
- Fonctions : upload PDF, OCR texte, modification statut
- S√©curit√© : hooks useInvoices filtrent mama_id

=== ‚úÖ MODULE : ImportFactures.jsx ===
- Route : /factures/import
- Objectif : importer des factures via CSV ou OCR
- Fonctions : pr√©visualisation des lignes, validation en masse

=== ‚úÖ MODULE : FicheForm.jsx / FicheDetail.jsx ===
- Routes : /fiches/nouveau, /fiches/:id
- Objectif : composer ou modifier une fiche technique
- Fonctions : ajout dynamique de lignes, upload image, calcul co√ªt
- S√©curit√© : useFiches applique RLS mama_id

=== ‚úÖ MODULE : FournisseurDetail.jsx ===
- Route : /fournisseurs/:id
- Objectif : consultation d√©taill√©e d'un fournisseur
- Fonctions : historique factures, contacts, notes

=== ‚úÖ MODULE : ComparatifPrix.jsx / PrixFournisseurs.jsx ===
- Routes : /fournisseurs/comparatif, /fournisseurs/prix
- Objectif : comparer les prix fournisseurs pour un produit
- Fonctions : tableau dynamique, export Excel

=== ‚úÖ MODULE : InventaireForm.jsx / EcartInventaire.jsx ===
- Routes : /inventaire/nouveau, /inventaire/ecart/:id
- Objectif : pr√©parer l'inventaire et analyser les √©carts
- Fonctions : saisie lignes, cl√¥ture, calcul √©cart th√©orique

=== ‚úÖ MODULE : MenuForm.jsx / MenuDetail.jsx ===
- Routes : /menus/nouveau, /menus/:id
- Objectif : g√©rer les menus du jour ou √† th√®me
- Fonctions : s√©lection de fiches, g√©n√©ration PDF

=== ‚úÖ MODULE : MenuDuJour.jsx / MenuDuJourForm.jsx / MenuDuJourDetail.jsx ===
- Routes : /menus/jour, /menus/jour/nouveau, /menus/jour/:id
- Objectif : planifier le menu quotidien
- Fonctions : choix des plats, duplication d'un jour √† l'autre

=== ‚úÖ MODULE : MenuPDF.jsx ===
- Route : /menus/pdf/:id
- Objectif : g√©n√©ration de carte PDF imprimable

=== ‚úÖ MODULE : MobileAccueil.jsx / MobileInventaire.jsx / MobileMouvement.jsx / MobileRequisition.jsx ===
- Routes : /mobile/*
- Objectif : permettre les op√©rations principales sur smartphone
- Fonctions : scan code-barres, saisie rapide, navigation √©pur√©e

=== ‚úÖ MODULE : Param√©trage d√©taill√© ===
- Pages : AccessRights.jsx, Roles.jsx, RoleForm.jsx, Permissions.jsx, PermissionsForm.jsx, PermissionsAdmin.jsx, Mamas.jsx, MamaForm.jsx, InvitationsEnAttente.jsx, InviteUser.jsx, Parametrage.jsx
- Objectif : g√©rer les r√¥les, droits et param√®tres des organisations
- S√©curit√© : r√©serv√© aux admins, hooks filtr√©s par mama_id
- InvitationsEnAttente.jsx liste les utilisateurs en attente avec relance par e-mail
- InviteUser.jsx envoie une invitation via une Edge Function `send-invite`

- AccessRights.jsx : liste tous les droits applicables avec recherche et export
- Roles.jsx : g√®re les r√¥les standard avec ajout/suppression
- RoleForm.jsx : formulaire de cr√©ation ou √©dition d'un r√¥le
- Permissions.jsx : tableau de correspondance r√¥le -> droits
- PermissionsForm.jsx : √©dition fine des permissions d'un r√¥le
- PermissionsAdmin.jsx : page d'administration des r√®gles avanc√©es
- Mamas.jsx : affiche les organisations configur√©es
- MamaForm.jsx : cr√©ation ou mise √† jour d'une organisation
- Parametrage.jsx : point d'entr√©e avec navigation vers toutes les pages

=== ‚úÖ MODULE : AccessRights.jsx ===
- Route : /parametrage/access-rights
- Objectif : g√©rer la liste des droits disponibles
- Fonctions : recherche, export CSV

=== ‚úÖ MODULE : Roles.jsx ===
- Route : /parametrage/roles
- Objectif : cr√©er et assigner des r√¥les
- Fonctions : ajout, suppression et duplication

=== ‚úÖ MODULE : RoleForm.jsx ===
- Route : /parametrage/roles/:id
- Objectif : formulaire complet pour un r√¥le

=== ‚úÖ MODULE : Permissions.jsx ===
- Route : /parametrage/permissions
- Objectif : visualiser la table r√¥le/droits

=== ‚úÖ MODULE : PermissionsForm.jsx ===
- Route : /parametrage/permissions/:id
- Objectif : modifier les permissions d'un r√¥le donn√©

=== ‚úÖ MODULE : PermissionsAdmin.jsx ===
- Route : /parametrage/permissions-admin
- Objectif : r√®gles avanc√©es et h√©ritage de droits

=== ‚úÖ MODULE : Mamas.jsx ===
- Route : /parametrage/mamas
- Objectif : listes des organisations

=== ‚úÖ MODULE : MamaForm.jsx ===
- Route : /parametrage/mamas/:id
- Objectif : √©dition d'une organisation

=== ‚úÖ MODULE : InvitationsEnAttente.jsx ===
- Route : /parametrage/invitations
- Objectif : relancer les utilisateurs invit√©s

=== ‚úÖ MODULE : InviteUser.jsx ===
- Route : /parametrage/invite
- Objectif : envoyer une invitation par email

=== ‚úÖ MODULE : Parametrage.jsx ===
- Route : /parametrage
- Objectif : page d'accueil des param√®tres

=== ‚úÖ MODULE : RequisitionForm.jsx / RequisitionDetail.jsx ===
- Routes : /requisitions/nouveau, /requisitions/:id
- Objectif : planifier et suivre les sorties de stock
- Fonctions : g√©n√©ration PDF, validation, affectation cost center

=== ‚úÖ MODULE : ReportingPDF.jsx / GraphCost.jsx ===
- Routes : /reporting/pdf, /reporting/graph-cost
- Objectif : exporter les statistiques et co√ªts au format PDF ou graphique

=== ‚úÖ MODULE : Stats pages ===
- Pages : StatsStock.jsx, StatsCostCenters.jsx, StatsCostCentersPivot.jsx, StatsFiches.jsx, StatsConsolidation.jsx, StatsAdvanced.jsx
- Objectif : visualiser toutes les analyses disponibles
- Fonctions : appels RPC Supabase, graphiques Recharts, export Excel
  - StatsStock.jsx : statistiques globales de stock
  - StatsCostCenters.jsx : r√©partition par centre de co√ªt
  - StatsCostCentersPivot.jsx : pivot dynamique des co√ªts
  - StatsFiches.jsx : suivi des fiches techniques et co√ªts
  - StatsConsolidation.jsx : consolidation multi-sites
  - StatsAdvanced.jsx : analyses personnalis√©es via options avanc√©es

=== ‚úÖ MODULE : StatsStock.jsx ===
- Route : /stats/stock
- Objectif : suivi des valorisations et rotations

=== ‚úÖ MODULE : StatsCostCenters.jsx ===
- Route : /stats/cost-centers
- Objectif : r√©partition des co√ªts par centre

=== ‚úÖ MODULE : StatsCostCentersPivot.jsx ===
- Route : /stats/cost-centers/pivot
- Objectif : vue pivot pour analyses crois√©es

=== ‚úÖ MODULE : StatsFiches.jsx ===
- Route : /stats/fiches
- Objectif : co√ªt et marge des fiches techniques

=== ‚úÖ MODULE : StatsConsolidation.jsx ===
- Route : /stats/consolidation
- Objectif : cumul multi-sites

=== ‚úÖ MODULE : StatsAdvanced.jsx ===
- Route : /stats/advanced
- Objectif : requ√™tes personnalis√©es

=== ‚úÖ MODULE : TacheDetail.jsx / TacheNew.jsx ===
- Routes : /taches/:id, /taches/nouveau
- Objectif : d√©tails et cr√©ation de t√¢ches planifi√©es
- Fonctions : assignation utilisateurs, checklist

=== ‚úÖ MODULE : SignalementDetail.jsx / SignalementForm.jsx ===
- Routes : /signalements/:id, /signalements/nouveau
- Objectif : g√©rer le suivi des tickets utilisateurs
- S√©curit√© : useSignalements filtre mama_id

=== ‚úÖ MODULE : SimulationForm.jsx / SimulationMenu.jsx / SimulationResult.jsx ===
- Routes : /simulation/form, /simulation/menu, /simulation/result
- Objectif : √©tapes de la d√©monstration front
- S√©curit√© : prot√©g√© par AuthContext

=== ‚úÖ MODULE : NotFound.jsx ===
- Route : *
- Objectif : page 404 par d√©faut

=== ‚úÖ MODULE : Scripts Node ===
- Fichiers : backup_db.js, export_accounting.js, weekly_report.js, reallocate_history.js
- Objectif : utilitaires CLI (backup, export compta, statistiques)
- backup_db.js : exporte les tables filtr√©es par mama_id dans un JSON
- export_accounting.js : extrait les lignes de factures du mois en CSV
- weekly_report.js : g√©n√®re un XLSX des stats par centre de co√ªt
- reallocate_history.js : ventile l'historique des mouvements via RPC
- N√©cessitent variables d'environnement Supabase et Node 18

=== ‚ö†Ô∏è MODULE : Analyse.jsx / AnalyseCostCenter.jsx ===
- Routes : /analyse et /analyse/cost-centers
- Statut : pages en construction (placeholders)
=== ‚ö†Ô∏è S√âCURIT√â RLS ===
- environ 170 policies cr√©√©es dans `sql/rls.sql` et `sql/mama_stock_patch.sql`
- Toutes les tables principales (products, fournisseurs, factures, fiches, inventaires, menus, etc.) v√©rifient `mama_id = current_user_mama_id()`
- Table users limit√©e par id (= auth.uid())

=== ‚ö†Ô∏è TESTS ===
- Unit tests vitest pr√©sents pour produits, fournisseurs, stock, scripts
- Playwright e2e minimal (`e2e/home.spec.js`)

=== ‚ùå POINTS FRAGILES / MANQUANTS ===
- Certains champs obligatoires dans les forms pourraient √™tre optionnels (ex: fournisseur principal dans ProduitForm)
- Login.jsx n'affiche l'erreur qu'apr√®s toast, pas de compteur d'√©chec
- Sidebar.jsx limite parfois l'affichage malgr√© access_rights corrects
- RLS : policy `documents_all` (mama_id) definie dans `mama_stock_patch.sql`
- Plusieurs composants modaux utilisent Dialog sans fermeture par touche ESC
- Les hooks useUnites et useFamilles n'appliquent pas de filtre mama_id sur toutes les requ√™tes
- E2E tests tr√®s basiques, pas de sc√©nario complet navigation
- Scripts node (backup_db.js, export_accounting.js) n√©cessitent variables d'environnement mais pas fournies


=== ‚úÖ MODULE : Logout.jsx ===
- Route : /logout
- Objectif : d√©connecter l'utilisateur de Supabase puis rediriger vers /login
- Fonctions : supabase.auth.signOut(), navigation useNavigate
- S√©curit√© : accessible uniquement via un bouton prot√©g√©

=== ‚úÖ MODULE : Unauthorized.jsx ===
- Route : /unauthorized
- Objectif : avertir l'utilisateur qu'il n'a pas les droits
- Fonctions : bouton retour vers l'accueil
- S√©curit√© : aucune donn√©e sensible, affichage public

=== ‚úÖ SCRIPT : check_browsers.cjs ===
- Objectif : v√©rifier que les navigateurs Playwright sont install√©s avant les tests e2e
- Utilis√© par : npm run test:e2e
- Comportement : si absent, affiche un message et exit 1 pour ignorer les tests

=== ‚úÖ LAYOUT & LIB ===
- Layout.jsx, AdminLayout.jsx, ViewerLayout.jsx, Navbar.jsx, Sidebar.jsx
- Objectif : structure globale de l'application et navigation prot√©g√©e
- S√©curit√© : lecture du contexte Auth pour afficher ou masquer les routes
- D√©pendances : lib/supabase.js pour toutes les requ√™tes

=== ‚úÖ HOOKS PRINCIPAUX ===
- Liste : useAdvancedStats, useAlerts, useAuditLog, useAuditTrail, useCarte,
  useComparatif, useConsolidatedStats, useCostCenterMonthlyStats,
  useCostCenterStats, useCostCenterSuggestions, useCostCenters, useDashboard,
  useDashboardStats, useDocuments, useEnrichedProducts, useFactureProduits,
  useFamilles, useFicheCoutHistory, useFiches, useFichesTechniques,
  useFournisseurNotes, useFournisseurStats, useFournisseurs,
  useFournisseursInactifs, useGlobalSearch, useGraphiquesMultiZone,
  useHelpArticles, useInventaires, useInvoiceImport, useInvoiceOcr,
  useInvoices, useLogs, useMama, useMamas, useMenuDuJour, useMenuEngineering,
  useMenus, useMouvementCostCenters, useMouvements, useMouvementsStock,
  useOnboarding, usePermissions, usePertes, usePlanning, usePriceTrends,
  useProducts, usePromotions, useReporting, useRequisitions, useRoles,
  useSignalements, useSimulation, useStats, useStock, useStorage,
  useSupplierProducts, useSuppliers, useSwipe, useTasks, useTopProducts,
  useTwoFactorAuth, useUnites, useUsers, useUtilisateurs, useValidations
- Tous appliquent le filtre `mama_id` et encapsulent les requ√™tes Supabase

=== üéÅ PRIORIT√âS & SUGGESTIONS ===
- Confirmer la policy `documents_all` et v√©rifier les vues manquantes
- Compl√©ter les tests end-to-end Playwright pour couvrir la navigation et les op√©rations critiques
- Fournir un fichier `.env.example` listant les variables requises pour les scripts Node
- Am√©liorer la validation des formulaires (champs optionnels, messages d‚Äôerreur)
- Centraliser la fermeture des modaux (ESC, clic ext√©rieur) pour tous les composants Dialog


=== ‚úÖ SQL FUNCTIONS & TRIGGERS ===
- stats_cost_centers(mama_id, debut, fin) : stats par centre de co√ªt
- log_cost_centers_changes() / log_mouvement_cc_changes() : triggers vers user_logs
- log_pertes_changes() : enregistrement automatique des pertes
- suggest_cost_centers(product_id) : propose une r√©partition automatique
- enable_two_fa(p_secret) / disable_two_fa() : active ou d√©sactive la 2FA
- top_products(mama_id, debut, fin, limit) : top consommations produits
- mouvements_without_alloc(limit) : mouvements sans ventilation cost center
- dashboard_stats(mama_id) : KPI du tableau de bord
- consolidated_stats() : statistiques multi-sites
- add_audit_entry() : utilis√©e par les triggers sur products, factures et planning
- check_stock_alert() : cr√©e une alerte quand le stock passe sous le seuil
- import_invoice(payload) : importe les factures √©lectroniques
- advanced_stats(start_date, end_date) : stats avanc√©es par p√©riode

- update_product_pmp() : met √† jour le PMP apr√®s une facture
- refresh_facture_total() : recalcule le total de facture
- update_stock_theorique() : remet √† jour le stock th√©orique
- apply_inventaire_line() : applique une ligne d'inventaire au stock
- refresh_fiche_cost() : recalcule le co√ªt d'une fiche technique
- stats_achats_fournisseurs(mama_id) : cumule les achats par fournisseur
- stats_achats_fournisseur(mama_id, fournisseur_id) : d√©tail d'un fournisseur
- stats_rotation_produit(mama_id, product_id) : rotation mensuelle d'un produit
- log_fiche_prix_change() : historise les variations de prix des fiches
- log_promotions_changes() : enregistre les modifications de promotions
- current_user_role() : retourne le r√¥le courant pour la s√©curit√©
=== üõ†Ô∏è ENVIRONNEMENT ===
- Variables charg√©es depuis `.env` (non suivi par Git)
- Pas de fichier `.env.example` pr√©sent dans le d√©p√¥t
- Scripts Node et tests Playwright n√©cessitent `VITE_SUPABASE_URL`, `VITE_SUPABASE_ANON_KEY` et `MAMA_ID`
- `public/manifest.json` inclut une ic√¥ne maskable
- Dockerfile multi-stage avec Node 18 pour builder puis servir `dist`
- `supabase/config.toml` expose l'API locale sur le port 54321
- `.github/workflows/ci.yml` ex√©cute lint, tests et e2e sur Node 18
- `vite.config.js` active le plugin PWA pour g√©n√©rer le service worker


=== ‚úÖ FONCTIONNALIT√âS TRANSVERSES ===
- Barre de recherche globale via useGlobalSearch dans la Navbar
- Toggle mode sombre/clair avec classe `dark`
- PWA installable avec service worker pour un usage hors ligne
- Gestes tactiles sur mobile g√©r√©s par useSwipe pour ouvrir la sidebar

=== ‚öôÔ∏è INDEXES & OPTIMISATIONS ===
- Plus de 100 index dans full_setup.sql pour acc√©l√©rer les filtres sur produits, factures, mouvements et t√¢ches
- Triggers update_product_pmp et refresh_facture_total maintiennent les totaux calcul√©s
- apply_inventaire_line() et update_stock_theorique() ajustent automatiquement les stocks

=== üé® DESIGN SYSTEM & TAILWIND ===
- Palette : mamastockBg `#0f1c2e`, mamastockText `#f0f0f5`, mamastockGold `#bfa14d`
- Police Inter charg√©e via Google Fonts dans `index.html`
- Plugins Tailwind : utilitaire `.text-shadow`, classes glass avec `backdrop-blur`
- `globals.css` applique un d√©grad√© sombre et des liens dor√©s
- UI : composants Card, Button, Input et TableContainer stylis√©s de fa√ßon coh√©rente

=== üì± PWA & ACCESSIBILIT√â ===
- `index.html` configure le service worker et les splash screens Apple
- Manifest complet avec ic√¥nes 192/512 et version maskable
- Le site est installable et utilisable hors ligne

=== FIN AUDIT ===
