# STRUCTURE DE BASE DE DONNÉES — MAMASTOCK

| table_name |
| ------------------------- |
| tache_instances |
| menus |
| menu_fiches |
| requisitions |
| lignes_bl |
| familles |
| unites |
| mamas |
| roles |
| users |
| utilisateurs |
| permissions |
| parametres |
| fournisseurs |
| fournisseur_contacts |
| fournisseur_notes |
| factures |
| facture_lignes |
| fiches |
| fiche_lignes |
| fiches_techniques |
| fiche_prix_history |
| fiche_cout_history |
| zones_stock |
| stocks |
| inventaire_lignes |
| centres_de_cout |
| pertes |
| transferts |
| ventes_fiches_carte |
| ventes_boissons |
| mouvements_centres_cout |
| taches |
| journal_audit |
| journaux_utilisateur |
| promotions |
| promotion_produits |
| access_rights |
| documents |
| etapes_onboarding |
| fournisseurs_api_config |
| tableaux_de_bord |
| gadgets |
| help_articles |
| regles_alertes |
| auth_double_facteur |
| notifications |
| bons_livraison |
| inventaire_zones |
| usage_stats |
| logs_securite |
| stock_mouvements |
| catalogue_updates |
| commandes |
| planning_previsionnel |
| signalements |
| validation_requests |
| produits |
| api_keys |
| compta_mapping |
| fournisseur_produits |
| inventaires |
| feedback |
| tooltips |
| documentation |
| guides_seen |
| consentements_utilisateur |

| table_name | column_name | data_type | is_nullable | column_default |
| ---------------------------------------- | ------------------------- | ------------------------ | ----------- | ------------------ |
| access_rights | id | uuid | NO | gen_random_uuid() |
| access_rights | mama_id | uuid | NO | null |
| access_rights | role_id | uuid | NO | null |
| access_rights | module | text | NO | null |
| access_rights | peut_voir | boolean | NO | false |
| access_rights | peut_modifier | boolean | NO | false |
| access_rights | created_at | timestamp with time zone | YES | now() |
| api_keys | id | uuid | NO | gen_random_uuid() |
| api_keys | mama_id | uuid | YES | null |
| api_keys | user_id | uuid | YES | null |
| api_keys | name | text | YES | null |
| api_keys | scopes | jsonb | YES | null |
| api_keys | role | text | YES | null |
| api_keys | expiration | date | YES | null |
| api_keys | revoked | boolean | YES | false |
| api_keys | created_at | timestamp with time zone | YES | now() |
| auth_double_facteur | id | uuid | NO | null |
| auth_double_facteur | secret | text | YES | null |
| auth_double_facteur | enabled | boolean | YES | false |
| auth_double_facteur | created_at | timestamp with time zone | YES | now() |
| bons_livraison | id | uuid | NO | gen_random_uuid() |
| bons_livraison | mama_id | uuid | YES | null |
| bons_livraison | fournisseur_id | uuid | YES | null |
| bons_livraison | numero_bl | text | YES | null |
| bons_livraison | date_livraison | date | YES | null |
| bons_livraison | created_at | timestamp with time zone | YES | now() |
| catalogue_updates | id | uuid | NO | gen_random_uuid() |
| catalogue_updates | mama_id | uuid | YES | null |
| catalogue_updates | fournisseur_id | uuid | YES | null |
| catalogue_updates | produit_id | uuid | YES | null |
| catalogue_updates | ancienne_valeur | numeric | YES | null |
| catalogue_updates | nouvelle_valeur | numeric | YES | null |
| catalogue_updates | modification | jsonb | YES | null |
| catalogue_updates | created_at | timestamp with time zone | YES | now() |
| centres_de_cout | id | uuid | NO | gen_random_uuid() |
| centres_de_cout | mama_id | uuid | NO | null |
| centres_de_cout | nom | text | NO | null |
| centres_de_cout | created_at | timestamp with time zone | YES | now() |
| centres_de_cout | updated_at | timestamp with time zone | YES | now() |
| centres_de_cout | actif | boolean | YES | true |
| commandes | id | uuid | NO | gen_random_uuid() |
| commandes | mama_id | uuid | YES | null |
| commandes | fournisseur_id | uuid | YES | null |
| commandes | statut | text | YES | null |
| commandes | created_at | timestamp with time zone | YES | now() |
| compta_mapping | id | uuid | NO | gen_random_uuid() |
| compta_mapping | mama_id | uuid | YES | null |
| compta_mapping | cle | text | YES | null |
| compta_mapping | compte | text | YES | null |
| compta_mapping | type | text | YES | null |
| compta_mapping | created_at | timestamp with time zone | YES | now() |
| consentements_utilisateur | id | uuid | NO | gen_random_uuid() |
| consentements_utilisateur | user_id | uuid | YES | null |
| consentements_utilisateur | mama_id | uuid | YES | null |
| consentements_utilisateur | consentement | boolean | YES | null |
| consentements_utilisateur | date_consentement | timestamp with time zone | YES | null |
| consentements_utilisateur | actif | boolean | YES | true |
| consentements_utilisateur | created_at | timestamp with time zone | YES | now() |
| documentation | id | uuid | NO | gen_random_uuid() |
| documentation | mama_id | uuid | YES | null |
| documentation | titre | text | YES | null |
| documentation | contenu | text | YES | null |
| documentation | categorie | text | YES | null |
| documentation | created_at | timestamp with time zone | YES | now() |
| documents | id | uuid | NO | gen_random_uuid() |
| documents | mama_id | uuid | YES | null |
| documents | chemin | text | YES | null |
| documents | type | text | YES | null |
| documents | created_at | timestamp with time zone | YES | now() |
| etapes_onboarding | id | uuid | NO | gen_random_uuid() |
| etapes_onboarding | mama_id | uuid | YES | null |
| etapes_onboarding | etape | text | YES | null |
| etapes_onboarding | terminee | boolean | YES | false |
| etapes_onboarding | created_at | timestamp with time zone | YES | now() |
| facture_lignes | id | uuid | NO | gen_random_uuid() |
| facture_lignes | mama_id | uuid | NO | null |
| facture_lignes | facture_id | uuid | NO | null |
| facture_lignes | produit_id | uuid | NO | null |
| facture_lignes | quantite | numeric | YES | null |
| facture_lignes | prix | numeric | YES | null |
| facture_lignes | created_at | timestamp with time zone | YES | now() |
| facture_lignes | updated_at | timestamp with time zone | YES | now() |
| facture_lignes | actif | boolean | YES | true |
| factures | id | uuid | NO | gen_random_uuid() |
| factures | mama_id | uuid | NO | null |
| factures | fournisseur_id | uuid | YES | null |
| factures | numero | text | YES | null |
| factures | date_facture | date | YES | null |
| factures | created_at | timestamp with time zone | YES | now() |
| factures | updated_at | timestamp with time zone | YES | now() |
| factures | actif | boolean | YES | true |
| factures | total_ht | numeric | YES | null |
| factures | total_tva | numeric | YES | null |
| factures | total_ttc | numeric | YES | null |
| factures | statut | text | YES | null |
| familles | id | uuid | NO | uuid_generate_v4() |
| familles | nom | text | NO | null |
| familles | mama_id | uuid | NO | null |
| familles | actif | boolean | YES | true |
| familles | created_at | timestamp with time zone | YES | now() |
| feedback | id | uuid | NO | gen_random_uuid() |
| feedback | mama_id | uuid | YES | null |
| feedback | user_id | uuid | YES | null |
| feedback | module | text | YES | null |
| feedback | message | text | YES | null |
| feedback | urgence | text | YES | null |
| feedback | created_at | timestamp with time zone | YES | now() |
| fiche_cout_history | id | uuid | NO | gen_random_uuid() |
| fiche_cout_history | mama_id | uuid | NO | null |
| fiche_cout_history | fiche_id | uuid | NO | null |
| fiche_cout_history | old_cout | numeric | YES | null |
| fiche_cout_history | new_cout | numeric | YES | null |
| fiche_cout_history | changed_by | uuid | YES | null |
| fiche_cout_history | changed_at | timestamp with time zone | YES | null |
| fiche_cout_history | created_at | timestamp with time zone | YES | now() |
| fiche_cout_history | updated_at | timestamp with time zone | YES | now() |
| fiche_cout_history | actif | boolean | YES | true |
| fiche_lignes | id | uuid | NO | gen_random_uuid() |
| fiche_lignes | mama_id | uuid | NO | null |
| fiche_lignes | fiche_id | uuid | NO | null |
| fiche_lignes | description | text | YES | null |
| fiche_lignes | quantite | numeric | YES | null |
| fiche_lignes | created_at | timestamp with time zone | YES | now() |
| fiche_lignes | updated_at | timestamp with time zone | YES | now() |
| fiche_lignes | actif | boolean | YES | true |
| fiche_prix_history | id | uuid | NO | gen_random_uuid() |
| fiche_prix_history | mama_id | uuid | NO | null |
| fiche_prix_history | fiche_id | uuid | NO | null |
| fiche_prix_history | old_prix | numeric | YES | null |
| fiche_prix_history | new_prix | numeric | YES | null |
| fiche_prix_history | changed_by | uuid | YES | null |
| fiche_prix_history | changed_at | timestamp with time zone | YES | null |
| fiche_prix_history | created_at | timestamp with time zone | YES | now() |
| fiche_prix_history | updated_at | timestamp with time zone | YES | now() |
| fiche_prix_history | actif | boolean | YES | true |
| fiches | id | uuid | NO | gen_random_uuid() |
| fiches | mama_id | uuid | NO | null |
| fiches | titre | text | NO | null |
| fiches | created_at | timestamp with time zone | YES | now() |
| fiches | updated_at | timestamp with time zone | YES | now() |
| fiches | actif | boolean | YES | true |
| fiches_techniques | id | uuid | NO | gen_random_uuid() |
| fiches_techniques | mama_id | uuid | NO | null |
| fiches_techniques | fiche_id | uuid | NO | null |
| fiches_techniques | technique | text | YES | null |
| fiches_techniques | created_at | timestamp with time zone | YES | now() |
| fiches_techniques | updated_at | timestamp with time zone | YES | now() |
| fiches_techniques | actif | boolean | YES | true |
| fournisseur_contacts | id | uuid | NO | gen_random_uuid() |
| fournisseur_contacts | mama_id | uuid | NO | null |
| fournisseur_contacts | fournisseur_id | uuid | NO | null |
| fournisseur_contacts | nom | text | YES | null |
| fournisseur_contacts | email | text | YES | null |
| fournisseur_contacts | tel | text | YES | null |
| fournisseur_contacts | created_at | timestamp with time zone | YES | now() |
| fournisseur_contacts | updated_at | timestamp with time zone | YES | now() |
| fournisseur_contacts | actif | boolean | YES | true |
| fournisseur_notes | id | uuid | NO | gen_random_uuid() |
| fournisseur_notes | mama_id | uuid | NO | null |
| fournisseur_notes | fournisseur_id | uuid | NO | null |
| fournisseur_notes | note | text | YES | null |
| fournisseur_notes | date | date | YES | null |
| fournisseur_notes | created_at | timestamp with time zone | YES | now() |
| fournisseur_notes | updated_at | timestamp with time zone | YES | now() |
| fournisseur_notes | actif | boolean | YES | true |
| fournisseur_produits | id | uuid | NO | gen_random_uuid() |
| fournisseur_produits | mama_id | uuid | NO | null |
| fournisseur_produits | fournisseur_id | uuid | NO | null |
| fournisseur_produits | produit_id | uuid | NO | null |
| fournisseur_produits | created_at | timestamp with time zone | YES | now() |
| fournisseur_produits | updated_at | timestamp with time zone | YES | now() |
| fournisseur_produits | actif | boolean | YES | true |
| fournisseur_produits | prix_achat | numeric | YES | null |
| fournisseur_produits | date_livraison | date | YES | null |
| fournisseurs | id | uuid | NO | gen_random_uuid() |
| fournisseurs | mama_id | uuid | NO | null |
| fournisseurs | nom | text | NO | null |
| fournisseurs | created_at | timestamp with time zone | YES | now() |
| fournisseurs | updated_at | timestamp with time zone | YES | now() |
| fournisseurs | actif | boolean | YES | true |
| fournisseurs_api_config | fournisseur_id | uuid | NO | null |
| fournisseurs_api_config | mama_id | uuid | NO | null |
| fournisseurs_api_config | url | text | YES | null |
| fournisseurs_api_config | type_api | text | YES | 'rest'::text |
| fournisseurs_api_config | token | text | YES | null |
| fournisseurs_api_config | format_facture | text | YES | 'json'::text |
| fournisseurs_api_config | actif | boolean | YES | true |
| fournisseurs_api_config | created_at | timestamp with time zone | YES | now() |
| gadgets | id | uuid | NO | gen_random_uuid() |
| gadgets | tableau_id | uuid | YES | null |
| gadgets | type | text | YES | null |
| gadgets | config | jsonb | YES | null |
| gadgets | created_at | timestamp with time zone | YES | now() |
| guides_seen | user_id | uuid | NO | null |
| guides_seen | mama_id | uuid | YES | null |
| guides_seen | module | text | NO | null |
| guides_seen | seen | boolean | YES | false |
| help_articles | id | uuid | NO | gen_random_uuid() |
| help_articles | titre | text | YES | null |
| help_articles | contenu | text | YES | null |
| help_articles | created_at | timestamp with time zone | YES | now() |
| inventaire_lignes | id | uuid | NO | gen_random_uuid() |
| inventaire_lignes | mama_id | uuid | NO | null |
| inventaire_lignes | inventaire_id | uuid | NO | null |
| inventaire_lignes | produit_id | uuid | NO | null |
| inventaire_lignes | quantite | numeric | YES | null |
| inventaire_lignes | created_at | timestamp with time zone | YES | now() |
| inventaire_lignes | updated_at | timestamp with time zone | YES | now() |
| inventaire_lignes | actif | boolean | YES | true |
| inventaire_zones | id | uuid | NO | gen_random_uuid() |
| inventaire_zones | mama_id | uuid | YES | null |
| inventaire_zones | nom | text | YES | null |
| inventaire_zones | created_at | timestamp with time zone | YES | now() |
| inventaires | id | uuid | NO | gen_random_uuid() |
| inventaires | mama_id | uuid | NO | null |
| inventaires | date_inventaire | date | YES | null |
| inventaires | created_at | timestamp with time zone | YES | now() |
| inventaires | updated_at | timestamp with time zone | YES | now() |
| inventaires | actif | boolean | YES | true |
| inventaires | reference | text | YES | null |
| inventaires | zone | text | YES | null |
| inventaires | date_debut | date | YES | null |
| inventaires | cloture | boolean | YES | false |
| journal_audit | id | uuid | NO | gen_random_uuid() |
| journal_audit | mama_id | uuid | NO | null |
| journal_audit | table_name | text | YES | null |
| journal_audit | row_id | uuid | YES | null |
| journal_audit | operation | text | YES | null |
| journal_audit | old_data | jsonb | YES | null |
| journal_audit | new_data | jsonb | YES | null |
| journal_audit | changed_by | uuid | YES | null |
| journal_audit | created_at | timestamp with time zone | YES | now() |
| journal_audit | updated_at | timestamp with time zone | YES | now() |
| journal_audit | actif | boolean | YES | true |
| journal_audit | changed_at | timestamp with time zone | YES | null |
| journaux_utilisateur | id | uuid | NO | gen_random_uuid() |
| journaux_utilisateur | mama_id | uuid | NO | null |
| journaux_utilisateur | user_id | uuid | NO | null |
| journaux_utilisateur | action | text | YES | null |
| journaux_utilisateur | details | jsonb | YES | null |
| journaux_utilisateur | done_by | uuid | YES | null |
| journaux_utilisateur | created_at | timestamp with time zone | YES | now() |
| journaux_utilisateur | updated_at | timestamp with time zone | YES | now() |
| journaux_utilisateur | actif | boolean | YES | true |
| lignes_bl | id | uuid | NO | gen_random_uuid() |
| lignes_bl | bl_id | uuid | YES | null |
| lignes_bl | produit_id | uuid | YES | null |
| lignes_bl | quantite | numeric | YES | null |
| lignes_bl | prix | numeric | YES | null |
| lignes_bl | tva | numeric | YES | null |
| lignes_bl | created_at | timestamp with time zone | YES | now() |
| logs_securite | id | uuid | NO | gen_random_uuid() |
| logs_securite | mama_id | uuid | YES | null |
| logs_securite | user_id | uuid | YES | null |
| logs_securite | type | text | YES | null |
| logs_securite | ip | text | YES | null |
| logs_securite | navigateur | text | YES | null |
| logs_securite | description | text | YES | null |
| logs_securite | created_at | timestamp with time zone | YES | now() |
| mamas | id | uuid | NO | gen_random_uuid() |
| mamas | created_at | timestamp with time zone | YES | now() |
| mamas | updated_at | timestamp with time zone | YES | now() |
| mamas | actif | boolean | YES | true |
| menu_fiches | id | uuid | NO | gen_random_uuid() |
| menu_fiches | mama_id | uuid | NO | null |
| menu_fiches | menu_id | uuid | NO | null |
| menu_fiches | fiche_id | uuid | NO | null |
| menu_fiches | created_at | timestamp with time zone | YES | now() |
| menu_fiches | updated_at | timestamp with time zone | YES | now() |
| menu_fiches | actif | boolean | YES | true |
| menus | id | uuid | NO | gen_random_uuid() |
| menus | mama_id | uuid | NO | null |
| menus | nom | text | NO | null |
| menus | date | date | YES | null |
| menus | created_at | timestamp with time zone | YES | now() |
| menus | updated_at | timestamp with time zone | YES | now() |
| menus | actif | boolean | YES | true |
| mouvements_centres_cout | id | uuid | NO | gen_random_uuid() |
| mouvements_centres_cout | mama_id | uuid | NO | null |
| mouvements_centres_cout | mouvement_id | uuid | YES | null |
| mouvements_centres_cout | centre_cout_id | uuid | NO | null |
| mouvements_centres_cout | quantite | numeric | YES | null |
| mouvements_centres_cout | valeur | numeric | YES | null |
| mouvements_centres_cout | created_at | timestamp with time zone | YES | now() |
| mouvements_centres_cout | updated_at | timestamp with time zone | YES | now() |
| mouvements_centres_cout | actif | boolean | YES | true |
| notifications | id | uuid | NO | gen_random_uuid() |
| notifications | mama_id | uuid | YES | null |
| notifications | user_id | uuid | YES | null |
| notifications | titre | text | YES | null |
| notifications | texte | text | YES | null |
| notifications | lien | text | YES | null |
| notifications | type | text | YES | null |
| notifications | lu | boolean | YES | false |
| notifications | created_at | timestamp with time zone | YES | now() |
| parametres | id | uuid | NO | gen_random_uuid() |
| parametres | mama_id | uuid | NO | null |
| parametres | nom | text | YES | null |
| parametres | logo | text | YES | null |
| parametres | contacts | jsonb | YES | null |
| parametres | created_at | timestamp with time zone | YES | now() |
| parametres | updated_at | timestamp with time zone | YES | now() |
| parametres | actif | boolean | YES | true |
| permissions | id | uuid | NO | gen_random_uuid() |
| permissions | mama_id | uuid | NO | null |
| permissions | role_id | uuid | NO | null |
| permissions | user_id | uuid | YES | null |
| permissions | module | text | YES | null |
| permissions | droit | text | YES | null |
| permissions | created_at | timestamp with time zone | YES | now() |
| permissions | updated_at | timestamp with time zone | YES | now() |
| permissions | actif | boolean | YES | true |
| pertes | id | uuid | NO | gen_random_uuid() |
| pertes | mama_id | uuid | NO | null |
| pertes | produit_id | uuid | NO | null |
| pertes | centre_cout_id | uuid | YES | null |
| pertes | date_perte | date | YES | null |
| pertes | quantite | numeric | YES | null |
| pertes | motif | text | YES | null |
| pertes | created_by | uuid | YES | null |
| pertes | created_at | timestamp with time zone | YES | now() |
| pertes | updated_at | timestamp with time zone | YES | now() |
| pertes | actif | boolean | YES | true |
| planning_previsionnel | id | uuid | NO | gen_random_uuid() |
| planning_previsionnel | mama_id | uuid | YES | null |
| planning_previsionnel | date_prevue | date | YES | null |
| planning_previsionnel | quantite | numeric | YES | null |
| planning_previsionnel | produit_id | uuid | YES | null |
| planning_previsionnel | created_at | timestamp with time zone | YES | now() |
| produits | id | uuid | NO | gen_random_uuid() |
| produits | mama_id | uuid | NO | null |
| produits | nom | text | NO | null |
| produits | created_at | timestamp with time zone | YES | now() |
| produits | updated_at | timestamp with time zone | YES | now() |
| produits | actif | boolean | YES | true |
| produits | famille_id | uuid | YES | null |
| produits | unite_id | uuid | YES | null |
| produits | code | text | YES | null |
| produits | image | text | YES | null |
| produits | allergenes | text | YES | null |
| produits | pmp | numeric | YES | null |
| produits | stock_reel | numeric | YES | null |
| produits | stock_min | numeric | YES | null |
| produits | stock_theorique | numeric | YES | null |
| produits | main_supplier_id | uuid | YES | null |
| promotion_produits | id | uuid | NO | gen_random_uuid() |
| promotion_produits | mama_id | uuid | NO | null |
| promotion_produits | promotion_id | uuid | NO | null |
| promotion_produits | produit_id | uuid | NO | null |
| promotion_produits | discount | numeric | YES | null |
| promotion_produits | prix_promo | numeric | YES | null |
| promotion_produits | created_at | timestamp with time zone | YES | now() |
| promotion_produits | updated_at | timestamp with time zone | YES | now() |
| promotion_produits | actif | boolean | YES | true |
| promotions | id | uuid | NO | gen_random_uuid() |
| promotions | mama_id | uuid | NO | null |
| promotions | nom | text | YES | null |
| promotions | description | text | YES | null |
| promotions | date_debut | date | YES | null |
| promotions | date_fin | date | YES | null |
| promotions | created_at | timestamp with time zone | YES | now() |
| promotions | updated_at | timestamp with time zone | YES | now() |
| promotions | actif | boolean | YES | true |
| regles_alertes | id | uuid | NO | gen_random_uuid() |
| regles_alertes | mama_id | uuid | YES | null |
| regles_alertes | produit_id | uuid | YES | null |
| regles_alertes | type | text | YES | null |
| regles_alertes | seuil | numeric | YES | null |
| regles_alertes | actif | boolean | YES | true |
| regles_alertes | created_at | timestamp with time zone | YES | now() |
| requisitions | id | uuid | NO | gen_random_uuid() |
| requisitions | mama_id | uuid | NO | null |
| requisitions | produit_id | uuid | NO | null |
| requisitions | zone_id | uuid | NO | null |
| requisitions | date_requisition | date | YES | null |
| requisitions | quantite | numeric | YES | null |
| requisitions | type | text | YES | null |
| requisitions | commentaire | text | YES | null |
| requisitions | auteur_id | uuid | YES | null |
| requisitions | created_at | timestamp with time zone | YES | now() |
| requisitions | updated_at | timestamp with time zone | YES | now() |
| requisitions | actif | boolean | YES | true |
| roles | id | uuid | NO | gen_random_uuid() |
| roles | nom | text | NO | null |
| roles | created_at | timestamp with time zone | YES | now() |
| roles | updated_at | timestamp with time zone | YES | now() |
| roles | actif | boolean | YES | true |
| roles | mama_id | uuid | YES | null |
| signalements | id | uuid | NO | gen_random_uuid() |
| signalements | mama_id | uuid | YES | null |
| signalements | created_by | uuid | YES | null |
| signalements | type | text | YES | null |
| signalements | description | text | YES | null |
| signalements | date | timestamp with time zone | YES | null |
| signalements | created_at | timestamp with time zone | YES | now() |
| stock_mouvements | id | uuid | NO | gen_random_uuid() |
| stock_mouvements | mama_id | uuid | NO | null |
| stock_mouvements | inventaire_id | uuid | NO | null |
| stock_mouvements | created_at | timestamp with time zone | YES | now() |
| stock_mouvements | updated_at | timestamp with time zone | YES | now() |
| stock_mouvements | actif | boolean | YES | true |
| stock_mouvements | date | timestamp with time zone | YES | null |
| stock_mouvements | type | text | YES | null |
| stock_mouvements | quantite | numeric | YES | null |
| stock_mouvements | produit_id | uuid | YES | null |
| stock_mouvements | zone_source_id | uuid | YES | null |
| stock_mouvements | zone_destination_id | uuid | YES | null |
| stock_mouvements | commentaire | text | YES | null |
| stock_mouvements | auteur_id | uuid | YES | null |
| stocks | id | uuid | NO | gen_random_uuid() |
| stocks | mama_id | uuid | NO | null |
| stocks | zone_id | uuid | NO | null |
| stocks | produit_id | uuid | NO | null |
| stocks | quantite | numeric | YES | null |
| stocks | created_at | timestamp with time zone | YES | now() |
| stocks | updated_at | timestamp with time zone | YES | now() |
| stocks | actif | boolean | YES | true |
| tableaux_de_bord | id | uuid | NO | gen_random_uuid() |
| tableaux_de_bord | mama_id | uuid | YES | null |
| tableaux_de_bord | nom | text | YES | null |
| tableaux_de_bord | created_at | timestamp with time zone | YES | now() |
| tache_instances | id | uuid | NO | gen_random_uuid() |
| tache_instances | mama_id | uuid | NO | null |
| tache_instances | tache_id | uuid | NO | null |
| tache_instances | date_echeance | date | YES | null |
| tache_instances | statut | text | YES | null |
| tache_instances | done_by | uuid | YES | null |
| tache_instances | created_at | timestamp with time zone | YES | now() |
| tache_instances | updated_at | timestamp with time zone | YES | now() |
| tache_instances | actif | boolean | YES | true |
| taches | id | uuid | NO | gen_random_uuid() |
| taches | mama_id | uuid | NO | null |
| taches | titre | text | NO | null |
| taches | description | text | YES | null |
| taches | assignes | ARRAY | YES | null |
| taches | date_debut | date | YES | null |
| taches | delai_jours | integer | YES | null |
| taches | date_echeance | date | YES | null |
| taches | recurrente | boolean | YES | null |
| taches | frequence | text | YES | null |
| taches | priorite | text | YES | null |
| taches | statut | text | YES | null |
| taches | created_by | uuid | YES | null |
| taches | created_at | timestamp with time zone | YES | now() |
| taches | updated_at | timestamp with time zone | YES | now() |
| taches | actif | boolean | YES | true |
| tooltips | id | uuid | NO | gen_random_uuid() |
| tooltips | mama_id | uuid | YES | null |
| tooltips | champ | text | YES | null |
| tooltips | texte | text | YES | null |
| tooltips | created_at | timestamp with time zone | YES | now() |
| transferts | id | uuid | NO | gen_random_uuid() |
| transferts | mama_id | uuid | NO | null |
| transferts | produit_id | uuid | NO | null |
| transferts | quantite | numeric | YES | null |
| transferts | zone_depart | text | YES | null |
| transferts | zone_arrivee | text | YES | null |
| transferts | motif | text | YES | null |
| transferts | date_transfert | date | YES | null |
| transferts | created_by | uuid | YES | null |
| transferts | created_at | timestamp with time zone | YES | now() |
| transferts | updated_at | timestamp with time zone | YES | now() |
| transferts | actif | boolean | YES | true |
| unites | id | uuid | NO | uuid_generate_v4() |
| unites | nom | text | NO | null |
| unites | mama_id | uuid | NO | null |
| unites | actif | boolean | YES | true |
| unites | created_at | timestamp with time zone | YES | now() |
| usage_stats | id | uuid | NO | gen_random_uuid() |
| usage_stats | mama_id | uuid | YES | null |
| usage_stats | user_id | uuid | YES | null |
| usage_stats | module | text | YES | null |
| usage_stats | timestamp | timestamp with time zone | YES | now() |
| users | id | uuid | NO | gen_random_uuid() |
| users | username | text | NO | null |
| users | created_at | timestamp with time zone | YES | now() |
| users | updated_at | timestamp with time zone | YES | now() |
| users | actif | boolean | YES | true |
| utilisateurs | id | uuid | NO | gen_random_uuid() |
| utilisateurs | mama_id | uuid | NO | null |
| utilisateurs | nom | text | YES | null |
| utilisateurs | created_at | timestamp with time zone | YES | now() |
| utilisateurs | updated_at | timestamp with time zone | YES | now() |
| utilisateurs | actif | boolean | YES | true |
| utilisateurs | role_id | uuid | YES | null |
| utilisateurs | access_rights | jsonb | YES | '[]'::jsonb |
| utilisateurs | auth_id | uuid | YES | null |
| utilisateurs_complets | id | uuid | YES | null |
| utilisateurs_complets | nom | text | YES | null |
| utilisateurs_complets | mama_id | uuid | YES | null |
| utilisateurs_complets | created_at | timestamp with time zone | YES | null |
| utilisateurs_complets | updated_at | timestamp with time zone | YES | null |
| utilisateurs_complets | actif | boolean | YES | null |
| utilisateurs_complets | role | text | YES | null |
| v_analytique_stock | mama_id | uuid | YES | null |
| v_analytique_stock | produit_id | uuid | YES | null |
| v_analytique_stock | famille | text | YES | null |
| v_analytique_stock | activite | text | YES | null |
| v_analytique_stock | cost_center_id | uuid | YES | null |
| v_analytique_stock | cost_center_nom | text | YES | null |
| v_analytique_stock | quantite | numeric | YES | null |
| v_analytique_stock | valeur | numeric | YES | null |
| v_analytique_stock | date | date | YES | null |
| v_besoins_previsionnels | mama_id | uuid | YES | null |
| v_besoins_previsionnels | menu_id | uuid | YES | null |
| v_besoins_previsionnels | produit_id | uuid | YES | null |
| v_besoins_previsionnels | quantite | numeric | YES | null |
| v_cost_center_month | mama_id | uuid | YES | null |
| v_cost_center_month | cost_center_id | uuid | YES | null |
| v_cost_center_month | nom | text | YES | null |
| v_cost_center_month | mois | text | YES | null |
| v_cost_center_month | total | numeric | YES | null |
| v_cost_center_monthly | mama_id | uuid | YES | null |
| v_cost_center_monthly | nom | text | YES | null |
| v_cost_center_monthly | mois | text | YES | null |
| v_cost_center_monthly | montant | numeric | YES | null |
| v_ecarts_inventaire | mama_id | uuid | YES | null |
| v_ecarts_inventaire | produit_id | uuid | YES | null |
| v_ecarts_inventaire | date | date | YES | null |
| v_ecarts_inventaire | zone | uuid | YES | null |
| v_ecarts_inventaire | stock_theorique | numeric | YES | null |
| v_ecarts_inventaire | stock_reel | numeric | YES | null |
| v_ecarts_inventaire | ecart | numeric | YES | null |
| v_ecarts_inventaire | motif | text | YES | null |
| v_fournisseurs_inactifs | mama_id | uuid | YES | null |
| v_fournisseurs_inactifs | fournisseur_id | uuid | YES | null |
| v_fournisseurs_inactifs | nom | text | YES | null |
| v_fournisseurs_inactifs | dernier_achat | date | YES | null |
| v_monthly_purchases | mama_id | uuid | YES | null |
| v_monthly_purchases | mois | text | YES | null |
| v_monthly_purchases | total | numeric | YES | null |
| v_mouvements_centres_cout_stats | centre_cout_id | uuid | YES | null |
| v_mouvements_centres_cout_stats | centre_cout | text | YES | null |
| v_mouvements_centres_cout_stats | total_quantite | numeric | YES | null |
| v_mouvements_centres_cout_stats | total_valeur | numeric | YES | null |
| v_pmp | mama_id | uuid | YES | null |
| v_pmp | produit_id | uuid | YES | null |
| v_pmp | mois | text | YES | null |
| v_pmp | pmp | numeric | YES | null |
| v_produits_dernier_prix | id | uuid | YES | null |
| v_produits_dernier_prix | mama_id | uuid | YES | null |
| v_produits_dernier_prix | nom | text | YES | null |
| v_produits_dernier_prix | famille | text | YES | null |
| v_produits_dernier_prix | unite | text | YES | null |
| v_produits_dernier_prix | pmp | numeric | YES | null |
| v_produits_dernier_prix | stock_reel | numeric | YES | null |
| v_produits_dernier_prix | stock_min | numeric | YES | null |
| v_produits_dernier_prix | stock_theorique | numeric | YES | null |
| v_produits_dernier_prix | dernier_prix | numeric | YES | null |
| v_produits_dernier_prix | date_dernier_modification | date | YES | null |
| v_reco_stockmort | mama_id | uuid | YES | null |
| v_reco_stockmort | produit_id | uuid | YES | null |
| v_reco_stockmort | nom | text | YES | null |
| v_reco_stockmort | jours_inactif | integer | YES | null |
| v_reco_surcout | mama_id | uuid | YES | null |
| v_reco_surcout | produit_id | uuid | YES | null |
| v_reco_surcout | nom | text | YES | null |
| v_reco_surcout | variation_pct | numeric | YES | null |
| v_tendance_prix_produit | mama_id | uuid | YES | null |
| v_tendance_prix_produit | produit_id | uuid | YES | null |
| v_tendance_prix_produit | mois | text | YES | null |
| v_tendance_prix_produit | prix_moyen | numeric | YES | null |
| validation_requests | id | uuid | NO | gen_random_uuid() |
| validation_requests | mama_id | uuid | YES | null |
| validation_requests | user_id | uuid | YES | null |
| validation_requests | module | text | YES | null |
| validation_requests | payload | jsonb | YES | null |
| validation_requests | statut | text | YES | null |
| validation_requests | created_at | timestamp with time zone | YES | now() |
| ventes_boissons | id | uuid | NO | gen_random_uuid() |
| ventes_boissons | mama_id | uuid | NO | null |
| ventes_boissons | boisson_id | uuid | YES | null |
| ventes_boissons | quantite | numeric | YES | null |
| ventes_boissons | date_vente | date | YES | null |
| ventes_boissons | created_by | uuid | YES | null |
| ventes_boissons | created_at | timestamp with time zone | YES | now() |
| ventes_boissons | updated_at | timestamp with time zone | YES | now() |
| ventes_boissons | actif | boolean | YES | true |
| ventes_fiches_carte | id | uuid | NO | gen_random_uuid() |
| ventes_fiches_carte | mama_id | uuid | NO | null |
| ventes_fiches_carte | fiche_id | uuid | NO | null |
| ventes_fiches_carte | periode | date | YES | null |
| ventes_fiches_carte | ventes | integer | YES | null |
| ventes_fiches_carte | created_at | timestamp with time zone | YES | now() |
| ventes_fiches_carte | updated_at | timestamp with time zone | YES | now() |
| ventes_fiches_carte | actif | boolean | YES | true |
| vue_stock_disponible_par_produit_et_zone | produit | text | YES | null |
| vue_stock_disponible_par_produit_et_zone | unite | text | YES | null |
| vue_stock_disponible_par_produit_et_zone | famille | text | YES | null |
| vue_stock_disponible_par_produit_et_zone | zone_stock | text | YES | null |
| vue_stock_disponible_par_produit_et_zone | quantite | numeric | YES | null |
| vue_stock_disponible_par_produit_et_zone | updated_at | timestamp with time zone | YES | null |
| vue_stock_disponible_par_produit_et_zone | mama_id | uuid | YES | null |
| zones_stock | id | uuid | NO | gen_random_uuid() |
| zones_stock | mama_id | uuid | NO | null |
| zones_stock | nom | text | NO | null |
| zones_stock | created_at | timestamp with time zone | YES | now() |
| zones_stock | updated_at | timestamp with time zone | YES | now() |
| zones_stock | actif | boolean | YES | true |

| table_name | column_name | constraint_name |
| ------------------------- | -------------- | ------------------------------ |
| users | id | users_pkey |
| familles | id | familles_pkey |
| regles_alertes | id | regles_alertes_pkey |
| unites | id | unites_pkey |
| auth_double_facteur | id | auth_double_facteur_pkey |
| notifications | id | notifications_pkey |
| bons_livraison | id | bons_livraison_pkey |
| inventaire_zones | id | inventaire_zones_pkey |
| usage_stats | id | usage_stats_pkey |
| logs_securite | id | logs_securite_pkey |
| catalogue_updates | id | catalogue_updates_pkey |
| commandes | id | commandes_pkey |
| documents | id | documents_pkey |
| etapes_onboarding | id | etapes_onboarding_pkey |
| fournisseurs_api_config | fournisseur_id | fournisseurs_api_config_pkey |
| fournisseurs_api_config | mama_id | fournisseurs_api_config_pkey |
| tableaux_de_bord | id | tableaux_de_bord_pkey |
| gadgets | id | gadgets_pkey |
| help_articles | id | help_articles_pkey |
| lignes_bl | id | lignes_bl_pkey |
| planning_previsionnel | id | planning_previsionnel_pkey |
| signalements | id | signalements_pkey |
| validation_requests | id | validation_requests_pkey |
| api_keys | id | api_keys_pkey |
| compta_mapping | id | compta_mapping_pkey |
| feedback | id | feedback_pkey |
| tooltips | id | tooltips_pkey |
| documentation | id | documentation_pkey |
| guides_seen | user_id | guides_seen_pkey |
| guides_seen | module | guides_seen_pkey |
| consentements_utilisateur | id | consentements_utilisateur_pkey |
| access_rights | id | access_rights_pkey |
| mamas | id | mamas_pkey |
| roles | id | roles_pkey |
| users | id | users_pkey |
| utilisateurs | id | utilisateurs_pkey |
| permissions | id | permissions_pkey |
| parametres | id | parametres_pkey |
| produits | id | produits_pkey |
| fournisseurs | id | fournisseurs_pkey |
| fournisseur_produits | id | fournisseur_produits_pkey |
| fournisseur_contacts | id | fournisseur_contacts_pkey |
| fournisseur_notes | id | fournisseur_notes_pkey |
| factures | id | factures_pkey |
| facture_lignes | id | facture_lignes_pkey |
| fiches | id | fiches_pkey |
| fiche_lignes | id | fiche_lignes_pkey |
| fiches_techniques | id | fiches_techniques_pkey |
| fiche_prix_history | id | fiche_prix_history_pkey |
| fiche_cout_history | id | fiche_cout_history_pkey |
| zones_stock | id | zones_stock_pkey |
| stocks | id | stocks_pkey |
| inventaires | id | inventaires_pkey |
| inventaire_lignes | id | inventaire_lignes_pkey |
| stock_mouvements | id | stock_mouvements_pkey |
| centres_de_cout | id | centres_de_cout_pkey |
| pertes | id | pertes_pkey |
| transferts | id | transferts_pkey |
| requisitions | id | requisitions_pkey |
| menus | id | menus_pkey |
| menu_fiches | id | menu_fiches_pkey |
| ventes_fiches_carte | id | ventes_fiches_carte_pkey |
| ventes_boissons | id | ventes_boissons_pkey |
| mouvements_centres_cout | id | mouvements_centres_cout_pkey |
| taches | id | taches_pkey |
| tache_instances | id | tache_instances_pkey |
| journal_audit | id | journal_audit_pkey |
| journaux_utilisateur | id | journaux_utilisateur_pkey |
| promotions | id | promotions_pkey |
| promotion_produits | id | promotion_produits_pkey |

| table_name | column_name | foreign_table_name | foreign_column_name | constraint_name |
| ------------------------- | ------------------- | ------------------ | ------------------- | ------------------------------------------- |
| familles | mama_id | mamas | id | familles_mama_id_fkey |
| regles_alertes | mama_id | mamas | id | regles_alertes_mama_id_fkey |
| unites | mama_id | mamas | id | unites_mama_id_fkey |
| regles_alertes | produit_id | produits | id | regles_alertes_produit_id_fkey |
| notifications | mama_id | mamas | id | notifications_mama_id_fkey |
| notifications | user_id | utilisateurs | id | notifications_user_id_fkey |
| bons_livraison | mama_id | mamas | id | bons_livraison_mama_id_fkey |
| bons_livraison | fournisseur_id | fournisseurs | id | bons_livraison_fournisseur_id_fkey |
| inventaire_zones | mama_id | mamas | id | inventaire_zones_mama_id_fkey |
| usage_stats | mama_id | mamas | id | usage_stats_mama_id_fkey |
| produits | famille_id | familles | id | produits_famille_id_fkey |
| produits | unite_id | unites | id | produits_unite_id_fkey |
| usage_stats | user_id | utilisateurs | id | usage_stats_user_id_fkey |
| logs_securite | mama_id | mamas | id | logs_securite_mama_id_fkey |
| logs_securite | user_id | utilisateurs | id | logs_securite_user_id_fkey |
| stock_mouvements | produit_id | produits | id | stock_mouvements_produit_id_fkey |
| stock_mouvements | zone_source_id | zones_stock | id | stock_mouvements_zone_source_id_fkey |
| stock_mouvements | zone_destination_id | zones_stock | id | stock_mouvements_zone_destination_id_fkey |
| stock_mouvements | auteur_id | utilisateurs | id | stock_mouvements_auteur_id_fkey |
| catalogue_updates | mama_id | mamas | id | catalogue_updates_mama_id_fkey |
| catalogue_updates | fournisseur_id | fournisseurs | id | catalogue_updates_fournisseur_id_fkey |
| catalogue_updates | produit_id | produits | id | catalogue_updates_produit_id_fkey |
| commandes | mama_id | mamas | id | commandes_mama_id_fkey |
| commandes | fournisseur_id | fournisseurs | id | commandes_fournisseur_id_fkey |
| documents | mama_id | mamas | id | documents_mama_id_fkey |
| etapes_onboarding | mama_id | mamas | id | etapes_onboarding_mama_id_fkey |
| fournisseurs_api_config | fournisseur_id | fournisseurs | id | fournisseurs_api_config_fournisseur_id_fkey |
| fournisseurs_api_config | mama_id | mamas | id | fournisseurs_api_config_mama_id_fkey |
| tableaux_de_bord | mama_id | mamas | id | tableaux_de_bord_mama_id_fkey |
| gadgets | tableau_id | tableaux_de_bord | id | gadgets_tableau_id_fkey |
| lignes_bl | bl_id | bons_livraison | id | lignes_bl_bl_id_fkey |
| lignes_bl | produit_id | produits | id | lignes_bl_produit_id_fkey |
| planning_previsionnel | mama_id | mamas | id | planning_previsionnel_mama_id_fkey |
| utilisateurs | role_id | roles | id | utilisateurs_role_id_fkey |
| planning_previsionnel | produit_id | produits | id | planning_previsionnel_produit_id_fkey |
| signalements | mama_id | mamas | id | signalements_mama_id_fkey |
| signalements | created_by | utilisateurs | id | signalements_created_by_fkey |
| validation_requests | mama_id | mamas | id | validation_requests_mama_id_fkey |
| validation_requests | user_id | utilisateurs | id | validation_requests_user_id_fkey |
| produits | main_supplier_id | fournisseurs | id | produits_main_supplier_id_fkey |
| api_keys | mama_id | mamas | id | api_keys_mama_id_fkey |
| api_keys | user_id | utilisateurs | id | api_keys_user_id_fkey |
| compta_mapping | mama_id | mamas | id | compta_mapping_mama_id_fkey |
| feedback | mama_id | mamas | id | feedback_mama_id_fkey |
| feedback | user_id | utilisateurs | id | feedback_user_id_fkey |
| tooltips | mama_id | mamas | id | tooltips_mama_id_fkey |
| documentation | mama_id | mamas | id | documentation_mama_id_fkey |
| guides_seen | user_id | utilisateurs | id | guides_seen_user_id_fkey |
| guides_seen | mama_id | mamas | id | guides_seen_mama_id_fkey |
| consentements_utilisateur | user_id | utilisateurs | id | consentements_utilisateur_user_id_fkey |
| consentements_utilisateur | mama_id | mamas | id | consentements_utilisateur_mama_id_fkey |
| roles | mama_id | mamas | id | roles_mama_id_fkey |
| access_rights | mama_id | mamas | id | access_rights_mama_id_fkey |
| access_rights | role_id | roles | id | access_rights_role_id_fkey |
| utilisateurs | mama_id | mamas | id | utilisateurs_mama_id_fkey |
| permissions | mama_id | mamas | id | permissions_mama_id_fkey |
| permissions | role_id | roles | id | fk_permissions_role |
| permissions | user_id | users | id | fk_permissions_user |
| parametres | mama_id | mamas | id | parametres_mama_id_fkey |
| produits | mama_id | mamas | id | produits_mama_id_fkey |
| fournisseurs | mama_id | mamas | id | fournisseurs_mama_id_fkey |
| fournisseur_produits | mama_id | mamas | id | fournisseur_produits_mama_id_fkey |
| fournisseur_produits | fournisseur_id | fournisseurs | id | fournisseur_produits_fournisseur_id_fkey |
| fournisseur_produits | produit_id | produits | id | fournisseur_produits_produit_id_fkey |
| fournisseur_contacts | mama_id | mamas | id | fournisseur_contacts_mama_id_fkey |
| fournisseur_contacts | fournisseur_id | fournisseurs | id | fournisseur_contacts_fournisseur_id_fkey |
| fournisseur_notes | mama_id | mamas | id | fournisseur_notes_mama_id_fkey |
| fournisseur_notes | fournisseur_id | fournisseurs | id | fournisseur_notes_fournisseur_id_fkey |
| factures | mama_id | mamas | id | factures_mama_id_fkey |
| factures | fournisseur_id | fournisseurs | id | factures_fournisseur_id_fkey |
| facture_lignes | mama_id | mamas | id | facture_lignes_mama_id_fkey |
| facture_lignes | facture_id | factures | id | facture_lignes_facture_id_fkey |
| facture_lignes | produit_id | produits | id | facture_lignes_produit_id_fkey |
| fiches | mama_id | mamas | id | fiches_mama_id_fkey |
| fiche_lignes | mama_id | mamas | id | fiche_lignes_mama_id_fkey |
| fiche_lignes | fiche_id | fiches | id | fiche_lignes_fiche_id_fkey |
| fiches_techniques | mama_id | mamas | id | fiches_techniques_mama_id_fkey |
| fiches_techniques | fiche_id | fiches | id | fiches_techniques_fiche_id_fkey |
| fiche_prix_history | mama_id | mamas | id | fiche_prix_history_mama_id_fkey |
| fiche_prix_history | fiche_id | fiches | id | fiche_prix_history_fiche_id_fkey |
| fiche_prix_history | changed_by | users | id | fk_fiche_prix_history_changed_by |
| fiche_cout_history | mama_id | mamas | id | fiche_cout_history_mama_id_fkey |
| fiche_cout_history | fiche_id | fiches | id | fiche_cout_history_fiche_id_fkey |
| fiche_cout_history | changed_by | users | id | fk_fiche_cout_history_changed_by |
| zones_stock | mama_id | mamas | id | zones_stock_mama_id_fkey |
| stocks | mama_id | mamas | id | stocks_mama_id_fkey |
| stocks | zone_id | zones_stock | id | stocks_zone_id_fkey |
| stocks | produit_id | produits | id | stocks_produit_id_fkey |
| inventaires | mama_id | mamas | id | inventaires_mama_id_fkey |
| inventaire_lignes | mama_id | mamas | id | inventaire_lignes_mama_id_fkey |
| inventaire_lignes | inventaire_id | inventaires | id | inventaire_lignes_inventaire_id_fkey |
| inventaire_lignes | produit_id | produits | id | inventaire_lignes_produit_id_fkey |
| stock_mouvements | mama_id | mamas | id | stock_mouvements_mama_id_fkey |
| stock_mouvements | inventaire_id | inventaires | id | stock_mouvements_inventaire_id_fkey |
| centres_de_cout | mama_id | mamas | id | centres_de_cout_mama_id_fkey |
| pertes | mama_id | mamas | id | pertes_mama_id_fkey |
| pertes | produit_id | produits | id | pertes_produit_id_fkey |
| pertes | centre_cout_id | centres_de_cout | id | pertes_centre_cout_id_fkey |
| pertes | created_by | users | id | pertes_created_by_fkey |
| transferts | mama_id | mamas | id | transferts_mama_id_fkey |
| transferts | produit_id | produits | id | transferts_produit_id_fkey |
| transferts | created_by | users | id | transferts_created_by_fkey |
| requisitions | mama_id | mamas | id | requisitions_mama_id_fkey |
| requisitions | produit_id | produits | id | requisitions_produit_id_fkey |
| requisitions | zone_id | zones_stock | id | requisitions_zone_id_fkey |
| requisitions | auteur_id | users | id | requisitions_auteur_id_fkey |
| menus | mama_id | mamas | id | menus_mama_id_fkey |
| menu_fiches | mama_id | mamas | id | menu_fiches_mama_id_fkey |
| menu_fiches | menu_id | menus | id | menu_fiches_menu_id_fkey |
| menu_fiches | fiche_id | fiches | id | menu_fiches_fiche_id_fkey |
| ventes_fiches_carte | mama_id | mamas | id | ventes_fiches_carte_mama_id_fkey |
| ventes_fiches_carte | fiche_id | fiches | id | ventes_fiches_carte_fiche_id_fkey |
| ventes_boissons | mama_id | mamas | id | ventes_boissons_mama_id_fkey |
| ventes_boissons | boisson_id | produits | id | ventes_boissons_boisson_id_fkey |
| ventes_boissons | created_by | users | id | ventes_boissons_created_by_fkey |
| mouvements_centres_cout | mama_id | mamas | id | mouvements_centres_cout_mama_id_fkey |
| mouvements_centres_cout | centre_cout_id | centres_de_cout | id | mouvements_centres_cout_centre_cout_id_fkey |
| taches | mama_id | mamas | id | taches_mama_id_fkey |
| taches | created_by | users | id | taches_created_by_fkey |
| tache_instances | mama_id | mamas | id | tache_instances_mama_id_fkey |
| tache_instances | tache_id | taches | id | tache_instances_tache_id_fkey |
| tache_instances | done_by | users | id | tache_instances_done_by_fkey |
| journal_audit | mama_id | mamas | id | journal_audit_mama_id_fkey |
| journal_audit | changed_by | users | id | journal_audit_changed_by_fkey |
| journaux_utilisateur | mama_id | mamas | id | journaux_utilisateur_mama_id_fkey |
| journaux_utilisateur | user_id | users | id | journaux_utilisateur_user_id_fkey |
| journaux_utilisateur | done_by | users | id | journaux_utilisateur_done_by_fkey |
| promotions | mama_id | mamas | id | promotions_mama_id_fkey |
| promotion_produits | mama_id | mamas | id | promotion_produits_mama_id_fkey |
| promotion_produits | promotion_id | promotions | id | promotion_produits_promotion_id_fkey |
| promotion_produits | produit_id | produits | id | promotion_produits_produit_id_fkey |

| table_name |
| ---------------------------------------- |
| v_mouvements_centres_cout_stats |
| vue_stock_disponible_par_produit_et_zone |
| utilisateurs_complets |
| v_analytique_stock |
| v_besoins_previsionnels |
| v_cost_center_month |
| v_ecarts_inventaire |
| v_reco_stockmort |
| v_reco_surcout |
| v_cost_center_monthly |
| v_fournisseurs_inactifs |
| v_monthly_purchases |
| v_pmp |
| v_produits_dernier_prix |
| v_tendance_prix_produit |

| routine_name | routine_type | data_type |
| -------------------------- | ------------ | --------- |
| mettre_a_jour_pmp_produit | FUNCTION | void |
| maj_stock_produit | FUNCTION | void |
| rafraichir_cout_fiche | FUNCTION | void |
| journaliser_modifs_produit | FUNCTION | trigger |
| set_updated_at | FUNCTION | trigger |
| rafraichir_total_facture | FUNCTION | void |
| dashboard_stats | FUNCTION | jsonb |
| consolidated_stats | FUNCTION | jsonb |
| advanced_stats | FUNCTION | jsonb |
| fn_calc_budgets | FUNCTION | jsonb |
| send_email_notification | FUNCTION | void |
| send_notification_webhook | FUNCTION | void |
| stats_cost_centers | FUNCTION | jsonb |
| apply_stock_from_achat | FUNCTION | void |
| import_invoice | FUNCTION | jsonb |
| suggest_cost_centers | FUNCTION | jsonb |
| top_produits | FUNCTION | jsonb |
| compare_fiche | FUNCTION | jsonb |
| stats_multi_mamas | FUNCTION | jsonb |
| calcul_ecarts_inventaire | FUNCTION | jsonb |
| enable_two_fa | FUNCTION | void |
| disable_two_fa | FUNCTION | void |
| stats_achats_fournisseurs | FUNCTION | jsonb |
| stats_achats_fournisseur | FUNCTION | jsonb |
| stats_rotation_produit | FUNCTION | jsonb |
| current_user_mama_id | FUNCTION | uuid |

| table_name | index_name | index_definition |
| ------------------------- | ------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------- |
| produits | idx_produits_mama_id | CREATE INDEX idx_produits_mama_id ON public.produits USING btree (mama_id) |
| produits | idx_produits_created_at | CREATE INDEX idx_produits_created_at ON public.produits USING btree (created_at) |
| fournisseurs | idx_fournisseurs_mama_id | CREATE INDEX idx_fournisseurs_mama_id ON public.fournisseurs USING btree (mama_id) |
| fournisseurs | idx_fournisseurs_created_at | CREATE INDEX idx_fournisseurs_created_at ON public.fournisseurs USING btree (created_at) |
| factures | idx_factures_mama_id | CREATE INDEX idx_factures_mama_id ON public.factures USING btree (mama_id) |
| factures | idx_factures_created_at | CREATE INDEX idx_factures_created_at ON public.factures USING btree (created_at) |
| fiches | idx_fiches_mama_id | CREATE INDEX idx_fiches_mama_id ON public.fiches USING btree (mama_id) |
| fiches | idx_fiches_created_at | CREATE INDEX idx_fiches_created_at ON public.fiches USING btree (created_at) |
| inventaires | idx_inventaires_mama_id | CREATE INDEX idx_inventaires_mama_id ON public.inventaires USING btree (mama_id) |
| inventaires | idx_inventaires_created_at | CREATE INDEX idx_inventaires_created_at ON public.inventaires USING btree (created_at) |
| stock_mouvements | idx_stock_mouvements_mama_id | CREATE INDEX idx_stock_mouvements_mama_id ON public.stock_mouvements USING btree (mama_id) |
| stock_mouvements | idx_stock_mouvements_created_at | CREATE INDEX idx_stock_mouvements_created_at ON public.stock_mouvements USING btree (created_at) |
| taches | idx_taches_mama_id | CREATE INDEX idx_taches_mama_id ON public.taches USING btree (mama_id) |
| taches | idx_taches_created_at | CREATE INDEX idx_taches_created_at ON public.taches USING btree (created_at) |
| centres_de_cout | idx_centres_de_cout_mama_id | CREATE INDEX idx_centres_de_cout_mama_id ON public.centres_de_cout USING btree (mama_id) |
| centres_de_cout | idx_centres_de_cout_created_at | CREATE INDEX idx_centres_de_cout_created_at ON public.centres_de_cout USING btree (created_at) |
| promotions | idx_promotions_mama_id | CREATE INDEX idx_promotions_mama_id ON public.promotions USING btree (mama_id) |
| promotions | idx_promotions_created_at | CREATE INDEX idx_promotions_created_at ON public.promotions USING btree (created_at) |
| familles | familles_pkey | CREATE UNIQUE INDEX familles_pkey ON public.familles USING btree (id) |
| unites | unites_pkey | CREATE UNIQUE INDEX unites_pkey ON public.unites USING btree (id) |
| utilisateurs | idx_utilisateurs_auth_id | CREATE INDEX idx_utilisateurs_auth_id ON public.utilisateurs USING btree (auth_id) |
| access_rights | access_rights_pkey | CREATE UNIQUE INDEX access_rights_pkey ON public.access_rights USING btree (id) |
| access_rights | idx_access_rights_mama_role_module | CREATE INDEX idx_access_rights_mama_role_module ON public.access_rights USING btree (mama_id, role_id, module) |
| access_rights | uniq_access_rights_mama_role_module | CREATE UNIQUE INDEX uniq_access_rights_mama_role_module ON public.access_rights USING btree (mama_id, role_id, module) |
| regles_alertes | regles_alertes_pkey | CREATE UNIQUE INDEX regles_alertes_pkey ON public.regles_alertes USING btree (id) |
| auth_double_facteur | auth_double_facteur_pkey | CREATE UNIQUE INDEX auth_double_facteur_pkey ON public.auth_double_facteur USING btree (id) |
| notifications | notifications_pkey | CREATE UNIQUE INDEX notifications_pkey ON public.notifications USING btree (id) |
| bons_livraison | bons_livraison_pkey | CREATE UNIQUE INDEX bons_livraison_pkey ON public.bons_livraison USING btree (id) |
| inventaire_zones | inventaire_zones_pkey | CREATE UNIQUE INDEX inventaire_zones_pkey ON public.inventaire_zones USING btree (id) |
| usage_stats | usage_stats_pkey | CREATE UNIQUE INDEX usage_stats_pkey ON public.usage_stats USING btree (id) |
| logs_securite | logs_securite_pkey | CREATE UNIQUE INDEX logs_securite_pkey ON public.logs_securite USING btree (id) |
| stock_mouvements | idx_stock_mouvements_date | CREATE INDEX idx_stock_mouvements_date ON public.stock_mouvements USING btree (date) |
| stock_mouvements | idx_stock_mouvements_produit | CREATE INDEX idx_stock_mouvements_produit ON public.stock_mouvements USING btree (produit_id) |
| catalogue_updates | catalogue_updates_pkey | CREATE UNIQUE INDEX catalogue_updates_pkey ON public.catalogue_updates USING btree (id) |
| commandes | commandes_pkey | CREATE UNIQUE INDEX commandes_pkey ON public.commandes USING btree (id) |
| documents | documents_pkey | CREATE UNIQUE INDEX documents_pkey ON public.documents USING btree (id) |
| etapes_onboarding | etapes_onboarding_pkey | CREATE UNIQUE INDEX etapes_onboarding_pkey ON public.etapes_onboarding USING btree (id) |
| fournisseurs_api_config | fournisseurs_api_config_pkey | CREATE UNIQUE INDEX fournisseurs_api_config_pkey ON public.fournisseurs_api_config USING btree (fournisseur_id, mama_id) |
| fournisseurs_api_config | idx_fournisseurs_api_config_fournisseur_id | CREATE INDEX idx_fournisseurs_api_config_fournisseur_id ON public.fournisseurs_api_config USING btree (fournisseur_id) |
| fournisseurs_api_config | idx_fournisseurs_api_config_mama_id | CREATE INDEX idx_fournisseurs_api_config_mama_id ON public.fournisseurs_api_config USING btree (mama_id) |
| tableaux_de_bord | tableaux_de_bord_pkey | CREATE UNIQUE INDEX tableaux_de_bord_pkey ON public.tableaux_de_bord USING btree (id) |
| gadgets | gadgets_pkey | CREATE UNIQUE INDEX gadgets_pkey ON public.gadgets USING btree (id) |
| help_articles | help_articles_pkey | CREATE UNIQUE INDEX help_articles_pkey ON public.help_articles USING btree (id) |
| lignes_bl | lignes_bl_pkey | CREATE UNIQUE INDEX lignes_bl_pkey ON public.lignes_bl USING btree (id) |
| planning_previsionnel | planning_previsionnel_pkey | CREATE UNIQUE INDEX planning_previsionnel_pkey ON public.planning_previsionnel USING btree (id) |
| signalements | signalements_pkey | CREATE UNIQUE INDEX signalements_pkey ON public.signalements USING btree (id) |
| validation_requests | validation_requests_pkey | CREATE UNIQUE INDEX validation_requests_pkey ON public.validation_requests USING btree (id) |
| factures | uniq_factures_numero | CREATE UNIQUE INDEX uniq_factures_numero ON public.factures USING btree (mama_id, fournisseur_id, numero, date_facture) |
| produits | idx_produits_main_supplier | CREATE INDEX idx_produits_main_supplier ON public.produits USING btree (main_supplier_id) |
| api_keys | api_keys_pkey | CREATE UNIQUE INDEX api_keys_pkey ON public.api_keys USING btree (id) |
| compta_mapping | compta_mapping_pkey | CREATE UNIQUE INDEX compta_mapping_pkey ON public.compta_mapping USING btree (id) |
| feedback | feedback_pkey | CREATE UNIQUE INDEX feedback_pkey ON public.feedback USING btree (id) |
| fournisseur_produits | uniq_fournisseur_produits | CREATE UNIQUE INDEX uniq_fournisseur_produits ON public.fournisseur_produits USING btree (produit_id, fournisseur_id, date_livraison) |
| fournisseur_produits | idx_fp_produit | CREATE INDEX idx_fp_produit ON public.fournisseur_produits USING btree (produit_id) |
| fournisseur_produits | idx_fp_fournisseur | CREATE INDEX idx_fp_fournisseur ON public.fournisseur_produits USING btree (fournisseur_id) |
| fournisseur_produits | idx_fp_date | CREATE INDEX idx_fp_date ON public.fournisseur_produits USING btree (date_livraison) |
| tooltips | tooltips_pkey | CREATE UNIQUE INDEX tooltips_pkey ON public.tooltips USING btree (id) |
| documentation | documentation_pkey | CREATE UNIQUE INDEX documentation_pkey ON public.documentation USING btree (id) |
| guides_seen | guides_seen_pkey | CREATE UNIQUE INDEX guides_seen_pkey ON public.guides_seen USING btree (user_id, module) |
| consentements_utilisateur | consentements_utilisateur_pkey | CREATE UNIQUE INDEX consentements_utilisateur_pkey ON public.consentements_utilisateur USING btree (id) |
| consentements_utilisateur | idx_consentements_utilisateur_user | CREATE INDEX idx_consentements_utilisateur_user ON public.consentements_utilisateur USING btree (user_id) |
| consentements_utilisateur | idx_consentements_utilisateur_mama | CREATE INDEX idx_consentements_utilisateur_mama ON public.consentements_utilisateur USING btree (mama_id) |
| mamas | mamas_pkey | CREATE UNIQUE INDEX mamas_pkey ON public.mamas USING btree (id) |
| roles | roles_pkey | CREATE UNIQUE INDEX roles_pkey ON public.roles USING btree (id) |
| users | users_pkey | CREATE UNIQUE INDEX users_pkey ON public.users USING btree (id) |
| utilisateurs | utilisateurs_pkey | CREATE UNIQUE INDEX utilisateurs_pkey ON public.utilisateurs USING btree (id) |
| permissions | permissions_pkey | CREATE UNIQUE INDEX permissions_pkey ON public.permissions USING btree (id) |
| parametres | parametres_pkey | CREATE UNIQUE INDEX parametres_pkey ON public.parametres USING btree (id) |
| produits | produits_pkey | CREATE UNIQUE INDEX produits_pkey ON public.produits USING btree (id) |
| fournisseurs | fournisseurs_pkey | CREATE UNIQUE INDEX fournisseurs_pkey ON public.fournisseurs USING btree (id) |
| fournisseur_produits | fournisseur_produits_pkey | CREATE UNIQUE INDEX fournisseur_produits_pkey ON public.fournisseur_produits USING btree (id) |
| fournisseur_contacts | fournisseur_contacts_pkey | CREATE UNIQUE INDEX fournisseur_contacts_pkey ON public.fournisseur_contacts USING btree (id) |
| fournisseur_notes | fournisseur_notes_pkey | CREATE UNIQUE INDEX fournisseur_notes_pkey ON public.fournisseur_notes USING btree (id) |
| factures | factures_pkey | CREATE UNIQUE INDEX factures_pkey ON public.factures USING btree (id) |
| facture_lignes | facture_lignes_pkey | CREATE UNIQUE INDEX facture_lignes_pkey ON public.facture_lignes USING btree (id) |
| fiches | fiches_pkey | CREATE UNIQUE INDEX fiches_pkey ON public.fiches USING btree (id) |
| fiche_lignes | fiche_lignes_pkey | CREATE UNIQUE INDEX fiche_lignes_pkey ON public.fiche_lignes USING btree (id) |
| fiches_techniques | fiches_techniques_pkey | CREATE UNIQUE INDEX fiches_techniques_pkey ON public.fiches_techniques USING btree (id) |
| fiche_prix_history | fiche_prix_history_pkey | CREATE UNIQUE INDEX fiche_prix_history_pkey ON public.fiche_prix_history USING btree (id) |
| fiche_cout_history | fiche_cout_history_pkey | CREATE UNIQUE INDEX fiche_cout_history_pkey ON public.fiche_cout_history USING btree (id) |
| zones_stock | zones_stock_pkey | CREATE UNIQUE INDEX zones_stock_pkey ON public.zones_stock USING btree (id) |
| stocks | stocks_pkey | CREATE UNIQUE INDEX stocks_pkey ON public.stocks USING btree (id) |
| inventaires | inventaires_pkey | CREATE UNIQUE INDEX inventaires_pkey ON public.inventaires USING btree (id) |
| inventaire_lignes | inventaire_lignes_pkey | CREATE UNIQUE INDEX inventaire_lignes_pkey ON public.inventaire_lignes USING btree (id) |
| stock_mouvements | stock_mouvements_pkey | CREATE UNIQUE INDEX stock_mouvements_pkey ON public.stock_mouvements USING btree (id) |
| centres_de_cout | centres_de_cout_pkey | CREATE UNIQUE INDEX centres_de_cout_pkey ON public.centres_de_cout USING btree (id) |
| pertes | pertes_pkey | CREATE UNIQUE INDEX pertes_pkey ON public.pertes USING btree (id) |
| transferts | transferts_pkey | CREATE UNIQUE INDEX transferts_pkey ON public.transferts USING btree (id) |
| requisitions | requisitions_pkey | CREATE UNIQUE INDEX requisitions_pkey ON public.requisitions USING btree (id) |
| menus | menus_pkey | CREATE UNIQUE INDEX menus_pkey ON public.menus USING btree (id) |
| menu_fiches | menu_fiches_pkey | CREATE UNIQUE INDEX menu_fiches_pkey ON public.menu_fiches USING btree (id) |
| ventes_fiches_carte | ventes_fiches_carte_pkey | CREATE UNIQUE INDEX ventes_fiches_carte_pkey ON public.ventes_fiches_carte USING btree (id) |
| ventes_boissons | ventes_boissons_pkey | CREATE UNIQUE INDEX ventes_boissons_pkey ON public.ventes_boissons USING btree (id) |
| mouvements_centres_cout | mouvements_centres_cout_pkey | CREATE UNIQUE INDEX mouvements_centres_cout_pkey ON public.mouvements_centres_cout USING btree (id) |
| taches | taches_pkey | CREATE UNIQUE INDEX taches_pkey ON public.taches USING btree (id) |
| tache_instances | tache_instances_pkey | CREATE UNIQUE INDEX tache_instances_pkey ON public.tache_instances USING btree (id) |
| journal_audit | journal_audit_pkey | CREATE UNIQUE INDEX journal_audit_pkey ON public.journal_audit USING btree (id) |
| journaux_utilisateur | journaux_utilisateur_pkey | CREATE UNIQUE INDEX journaux_utilisateur_pkey ON public.journaux_utilisateur USING btree (id) |
| promotions | promotions_pkey | CREATE UNIQUE INDEX promotions_pkey ON public.promotions USING btree (id) |
| promotion_produits | promotion_produits_pkey | CREATE UNIQUE INDEX promotion_produits_pkey ON public.promotion_produits USING btree (id) |

| table_name | trigger_name | action_timing | event | action_statement |
| ------------------- | -------------------------------------- | ------------- | ------ | --------------------------------------------- |
| taches | trg_set_updated_at_taches | BEFORE | UPDATE | EXECUTE FUNCTION set_updated_at() |
| ventes_fiches_carte | trg_set_updated_at_ventes_fiches_carte | BEFORE | UPDATE | EXECUTE FUNCTION set_updated_at() |
| produits | trg_journal_produit | AFTER | INSERT | EXECUTE FUNCTION journaliser_modifs_produit() |
| produits | trg_journal_produit | AFTER | DELETE | EXECUTE FUNCTION journaliser_modifs_produit() |
| produits | trg_journal_produit | AFTER | UPDATE | EXECUTE FUNCTION journaliser_modifs_produit() |

| table_name | rls_enabled | rls_forced |
| ------------------------- | ----------- | ---------- |
| tache_instances | false | false |
| menus | true | false |
| menu_fiches | true | false |
| requisitions | true | false |
| lignes_bl | false | false |
| familles | false | false |
| unites | false | false |
| mamas | false | false |
| permissions | true | false |
| parametres | true | false |
| users | false | false |
| roles | false | false |
| utilisateurs | false | false |
| fournisseur_contacts | true | false |
| fournisseurs | false | false |
| fournisseur_notes | true | false |
| facture_lignes | false | false |
| fiches | false | false |
| fiche_lignes | false | false |
| fiches_techniques | false | false |
| fiche_cout_history | false | false |
| fiche_prix_history | true | false |
| factures | false | false |
| transferts | true | false |
| centres_de_cout | true | false |
| pertes | true | false |
| zones_stock | false | false |
| stocks | false | false |
| inventaire_lignes | false | false |
| ventes_boissons | true | false |
| mouvements_centres_cout | true | false |
| taches | true | false |
| ventes_fiches_carte | true | false |
| journal_audit | true | false |
| promotions | true | false |
| promotion_produits | true | false |
| journaux_utilisateur | true | false |
| access_rights | true | false |
| documents | false | false |
| etapes_onboarding | false | false |
| fournisseurs_api_config | false | false |
| tableaux_de_bord | false | false |
| gadgets | false | false |
| help_articles | false | false |
| regles_alertes | false | false |
| auth_double_facteur | false | false |
| notifications | false | false |
| bons_livraison | false | false |
| inventaire_zones | false | false |
| usage_stats | false | false |
| logs_securite | false | false |
| stock_mouvements | true | false |
| catalogue_updates | false | false |
| commandes | false | false |
| planning_previsionnel | false | false |
| signalements | false | false |
| validation_requests | false | false |
| produits | false | false |
| api_keys | false | false |
| compta_mapping | false | false |
| fournisseur_produits | false | false |
| inventaires | false | false |
| feedback | false | false |
| tooltips | false | false |
| documentation | false | false |
| guides_seen | false | false |
| consentements_utilisateur | false | false |

